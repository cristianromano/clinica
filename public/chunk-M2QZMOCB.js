import{a as xe,c as Se,e as Ee,f as ye}from"./chunk-Z3YCSNDP.js";import{a as ge,b as he,c as be}from"./chunk-LRDK4KU5.js";import{a as Ce,b as Re,c as we}from"./chunk-V4624JQ6.js";import{a as Ie}from"./chunk-7VGHOT3T.js";import{a as ee,b as d,c as te,d as ie,e as ne,f as h,g as re,h as oe,i as ae,j as le,k as se,l as me,m as de,n as pe,o as ce,p as ue,q as fe}from"./chunk-IDY3ZXSF.js";import{a as ve}from"./chunk-WJSC7PN5.js";import{a as _e}from"./chunk-RBADOQRF.js";import{C as K,E as Q,H as X,P as Y}from"./chunk-IXUCQNA3.js";import{c as $,d as W,e as H,j as J}from"./chunk-YW5BT2SR.js";import{$ as F,Ab as D,Bb as G,Da as N,Db as Z,Fb as k,Ha as l,Hb as C,Ia as E,Ib as L,Jb as O,Wa as c,Ya as p,cb as i,da as U,db as e,eb as u,ga as q,ib as P,lb as _,m as B,mb as y,na as A,oa as I,pb as T,vb as o,wb as g,xb as S,zb as j}from"./chunk-LTJRTMYM.js";import{e as Ae,g as w}from"./chunk-5G567QLT.js";var R=Ae(Ie());var Fe=(()=>{let r=class r{transform(t){return t?"table-success":"table-danger"}};r.\u0275fac=function(s){return new(s||r)},r.\u0275pipe=q({name:"colores",type:r,pure:!0,standalone:!0});let a=r;return a})();var Pe=a=>({itemsPerPage:3,currentPage:a,id:"tableOne"}),Te=a=>({itemsPerPage:2,currentPage:a,id:"tableTwo"});function ke(a,r){if(a&1&&(i(0,"tbody")(1,"tr")(2,"th",39),o(3),e(),i(4,"td"),u(5,"img",40),e(),i(6,"td"),o(7),e(),i(8,"td"),o(9),e(),i(10,"td"),o(11),e()()()),a&2){let n=r.$implicit,t=r.index;l(3),g(t+1),l(2),T("src",n.imagenes,N),l(2),g(n.nombre),l(2),g(n.apellido),l(2),g(n.obrasocial)}}function Oe(a,r){if(a&1){let n=P();i(0,"tbody",41),_("click",function(){let s=A(n).$implicit,m=y();return I(m.autorizarProfesional(s))}),i(1,"tr",42),C(2,"colores"),i(3,"th",39),o(4),e(),i(5,"td"),u(6,"img",40),e(),i(7,"td"),o(8),e(),i(9,"td"),o(10),e(),i(11,"td"),o(12),e(),i(13,"td"),o(14),e()()()}if(a&2){let n=r.$implicit,t=r.index;l(),p("ngClass",L(2,7,n.autorizado)),l(3),g(t+1),l(2),T("src",n.imagenes,N),l(2),g(n.nombre),l(2),g(n.apellido),l(2),g(n.especialidad),l(2),g(n.autorizado?"Autorizado":"No autorizado")}}function Ve(a,r){if(a&1){let n=P();i(0,"option",43),_("click",function(s){A(n);let m=y();return I(m.cambioRol(s))}),o(1),e()}if(a&2){let n=r.$implicit;p("value",n),l(),S(" ",n," ")}}function Me(a,r){a&1&&(i(0,"div",44),o(1," El nombre solo acepta letras. "),e())}function ze(a,r){a&1&&(i(0,"div",44),o(1," El apellido solo acepta letras. "),e())}function Be(a,r){a&1&&(i(0,"div",44),o(1," La edad debe estar en el rango de 18 a 99. "),e())}function Ue(a,r){a&1&&(i(0,"div",44),o(1," El DNI debe tener al menos 8 d\xEDgitos. "),e())}function qe(a,r){a&1&&(i(0,"div")(1,"label",45),o(2,"Obra Social"),e(),u(3,"input",46),e())}function je(a,r){if(a&1&&(i(0,"option",50),o(1),e()),a&2){let n=r.$implicit;p("value",n.valor),l(),S(" ",n.etiqueta," ")}}function De(a,r){if(a&1&&(i(0,"div",29)(1,"label",47),o(2,"Especialidad"),e(),i(3,"select",48),c(4,je,2,2,"option",49),e()()),a&2){let n=y();l(4),p("ngForOf",n.opciones)}}function Ge(a,r){a&1&&(i(0,"div",44),o(1," ingrese un email valido. "),e())}function Ze(a,r){if(a&1&&(i(0,"li",51),o(1),e()),a&2){let n=r.$implicit;l(),S(" ",n.name," ")}}var v=class v{constructor(r,n,t){this.firestoreS=r,this.formBuilder=n,this.authS=t,this.p=1,this.pageTwo=1,this.firestore=F(K),this.arrEspecialistas=[],this.arrPacientes=[],this.savedFileNames=[],this.storage=F(xe),this.opciones=[],this.roles=["Paciente","Administrador","Especialista"],this.selectedRole=this.roles[0],this.formRegistro=new ne({nombre:new h("",[d.required,d.pattern("[a-zA-Z ]*")]),apellido:new h("",[d.required,d.pattern("[a-zA-Z ]*")]),edad:new h("",[d.required,d.pattern("[0-9]*"),d.min(18),d.max(99)]),dni:new h("",[d.required,d.minLength(8),d.maxLength(8)]),email:new h("",[d.required,d.pattern("[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}")]),obrasocial:new h("",[d.required,d.pattern("[a-zA-Z ]*")]),especialidad:new h(""),password:new h("",[d.required]),imagenes:this.formBuilder.array([])})}ngOnInit(){this.firestoreS.obtenerFirestoreTodosProfesional().subscribe(r=>{this.arrEspecialistas=[],r.forEach(n=>{this.arrEspecialistas.push(n)})}),this.firestoreS.obtenerFirestoreTodosPacientes().subscribe(r=>{this.arrPacientes=[],r.forEach(n=>{this.arrPacientes.push(n)})}),Q(X(this.firestore,"especialidades")).subscribe(r=>{this.opciones=[],r.forEach(n=>{this.opciones.push({etiqueta:n.especialidad,valor:n.especialidad})})})}autorizarProfesional(r){this.firestoreS.autorizarProfesional(r)}cambioRol(r){this.selectedRole=r.target.value,this.formRegistro.reset(),this.selectedRole==="Paciente"?(this.formRegistro.get("especialidad")?.clearValidators(),this.formRegistro.get("especialidad")?.updateValueAndValidity(),this.formRegistro.get("obrasocial")?.addValidators(d.required),this.formRegistro.get("obrasocial")?.updateValueAndValidity()):this.selectedRole==="Especialista"&&(this.formRegistro.get("obrasocial")?.clearValidators(),this.formRegistro.get("obrasocial")?.updateValueAndValidity(),this.formRegistro.get("especialidad")?.addValidators(d.required),this.formRegistro.get("especialidad")?.updateValueAndValidity())}submit(){return w(this,null,function*(){this.blockUI.start("Registrando usuario...");let r=this.formRegistro.get("imagenes"),n=[],t=this.formRegistro.value.nombre,s=this.formRegistro.value.email,m=this.formRegistro.value.password;for(let f of r.controls)if(f.value!==""){let b=Ee(this.storage,`imagenes/${f.value.name}`);yield ye(b,f.value).then(x=>w(this,null,function*(){n.push(yield Se(x.ref)),this.selectedRole==="Paciente"?this.firestoreS.agregarFirestorePaciente(this.formRegistro,n[0]).then(M=>{t&&s&&m&&this.authS.crearUsuario(s,m,n[0],t).then(z=>{this.blockUI.stop(),this.formRegistro.reset(),this.savedFileNames=[],R.default.fire({title:"Registro exitoso",text:"Se ha registrado correctamente",icon:"success",confirmButtonText:"Aceptar"})})}):this.selectedRole==="Especialista"?this.firestoreS.agregarFirestoreProfesional(this.formRegistro,n).then(M=>{t&&s&&m&&this.authS.crearUsuario(s,m,n[0],t).then(z=>{this.blockUI.stop(),this.formRegistro.reset(),this.savedFileNames=[],R.default.fire({title:"Registro exitoso",text:"Se ha registrado correctamente",icon:"success",confirmButtonText:"Aceptar"})})}):this.firestoreS.agregarFirestoreAdministrador(this.formRegistro,n).then(M=>{t&&s&&m&&this.authS.crearUsuarioAdmin(s,m,n[0],t).then(z=>{this.blockUI.stop(),this.formRegistro.reset(),this.savedFileNames=[],R.default.fire({title:"Registro exitoso",text:"Se ha registrado correctamente",icon:"success",confirmButtonText:"Aceptar"})})})}))}})}onFileChange(r){let n=r.target.files;if(n&&n.length>0){let t=this.formRegistro.get("imagenes");t.clear();let s=n[0];this.savedFileNames=[{name:s.name}],t.push(this.formBuilder.control(s))}}};v.\u0275fac=function(n){return new(n||v)(E(Y),E(ce),E(_e))},v.\u0275cmp=U({type:v,selectors:[["app-administracion"]],standalone:!0,features:[Z],decls:89,vars:25,consts:[[1,"full-background"],[1,"d-flex","flex-row","justify-content-center","align-items-center"],[1,"d-flex","flex-column","justify-content-center","align-items-center","panelusuarios"],[2,"border","1px solid black","padding","0 120px","box-shadow","0 4px 8px 5px rgba(0, 0, 0, 0.281)"],[1,"table","mt-3","table-light"],["scope","col"],[4,"ngFor","ngForOf"],["id","tableOne",3,"pageChange"],[1,"table","mt-3","me-5",2,"height","150px","width","100px"],[3,"click",4,"ngFor","ngForOf"],["id","tableTwo",3,"pageChange"],[1,"card","p-4","shadow","mt-3",2,"width","30rem"],[1,"d-flex","justify-content-center","align-items-center"],["id","roles",1,"form-control",3,"ngModelChange","ngModel"],[3,"value","click",4,"ngFor","ngForOf"],[1,"text-center","mb-4","mt-1"],[3,"ngSubmit","formGroup"],["for","nombre",1,"form-label"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],["class","text-danger",4,"ngIf"],["type","text","id","apellido","formControlName","apellido",1,"form-control"],["for","edad",1,"form-label"],["type","number","id","edad","formControlName","edad",1,"form-control"],["for","dni",1,"form-label"],["type","text","id","dni","formControlName","dni",1,"form-control"],[4,"ngIf"],["class","mb-3",4,"ngIf"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control"],[1,"mb-3"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password",1,"form-control"],[1,"mb-3","mb-3","d-flex","flex-column","justify-content-center","align-items-center",2,"height","100px","width","400px","border","1px solid black","border-radius","10px","padding","10px","margin","10px","background-color","antiquewhite","padding","50px"],["for","imagenes",1,"form-label"],["src","/assets/guardar.png","alt","","srcset","","for","imagenes",1,"form-label",2,"height","50px","width","50px"],["type","file","id","imagenes","accept","image/*","multiple","","formControlName","imagenes",1,"form-control","custom-file-upload",3,"change"],[1,"saved-files"],["class","text-success",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary",3,"disabled"],["scope","row"],["alt","...",2,"height","50px","width","50px",3,"src"],[3,"click"],[3,"ngClass"],[3,"click","value"],[1,"text-danger"],["for","obrasocial",1,"form-label"],["type","text","id","obrasocial","formControlName","obrasocial",1,"form-control"],["for","especialidad",1,"form-label"],["id","especialidad","formControlName","especialidad",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"text-success"]],template:function(n,t){if(n&1&&(i(0,"block-ui")(1,"div",0),u(2,"app-navbar"),i(3,"div",1)(4,"div",2)(5,"h1",3),o(6," Panel Usuarios "),e(),i(7,"table",4)(8,"thead")(9,"tr")(10,"th",5),o(11,"#"),e(),i(12,"th",5),o(13,"Foto"),e(),i(14,"th",5),o(15,"Nombre"),e(),i(16,"th",5),o(17,"Apellido"),e(),i(18,"th",5),o(19,"Obra social"),e()()(),c(20,ke,12,5,"tbody",6),C(21,"paginate"),e(),i(22,"pagination-controls",7),_("pageChange",function(m){return t.p=m}),e(),i(23,"table",8)(24,"thead")(25,"tr")(26,"th",5),o(27,"#"),e(),i(28,"th",5),o(29,"Foto"),e(),i(30,"th",5),o(31,"Nombre"),e(),i(32,"th",5),o(33,"Apellido"),e(),i(34,"th",5),o(35,"Especialidad"),e(),i(36,"th",5),o(37,"Aprobado"),e()()(),c(38,Oe,15,9,"tbody",9),C(39,"paginate"),e(),i(40,"pagination-controls",10),_("pageChange",function(m){return t.pageTwo=m}),e()(),i(41,"div",11)(42,"div",12)(43,"select",13),G("ngModelChange",function(m){return D(t.selectedRole,m)||(t.selectedRole=m),m}),c(44,Ve,2,2,"option",14),e()(),i(45,"h2",15),o(46),e(),i(47,"form",16),_("ngSubmit",function(){return t.submit()}),i(48,"div")(49,"label",17),o(50,"Nombre:"),e(),u(51,"input",18),c(52,Me,2,0,"div",19),e(),i(53,"div")(54,"label",17),o(55,"Apellido:"),e(),u(56,"input",20),c(57,ze,2,0,"div",19),e(),i(58,"div")(59,"label",21),o(60,"Edad:"),e(),u(61,"input",22),c(62,Be,2,0,"div",19),e(),i(63,"div")(64,"label",23),o(65,"DNI:"),e(),u(66,"input",24),c(67,Ue,2,0,"div",19),e(),c(68,qe,4,0,"div",25)(69,De,5,1,"div",26),i(70,"div")(71,"label",27),o(72,"Email"),e(),u(73,"input",28),e(),c(74,Ge,2,0,"div",19),i(75,"div",29)(76,"label",30),o(77,"Contrase\xF1a"),e(),u(78,"input",31),e(),i(79,"div",32)(80,"label",33),u(81,"img",34),e(),i(82,"input",35),_("change",function(m){return t.onFileChange(m)}),e(),i(83,"div",36)(84,"ul"),c(85,Ze,2,1,"li",37),e()()(),i(86,"div",12)(87,"button",38),o(88," Guardar datos "),e()()()()()()()),n&2){let s,m,f,b,x;l(20),p("ngForOf",O(21,15,t.arrPacientes,k(21,Pe,t.p))),l(18),p("ngForOf",O(39,18,t.arrEspecialistas,k(23,Te,t.pageTwo))),l(5),j("ngModel",t.selectedRole),l(),p("ngForOf",t.roles),l(2),S("Formulario de ",t.selectedRole,""),l(),p("formGroup",t.formRegistro),l(5),p("ngIf",t.formRegistro==null||(s=t.formRegistro.get("nombre"))==null||s.errors==null?null:s.errors.pattern),l(5),p("ngIf",t.formRegistro==null||(m=t.formRegistro.get("apellido"))==null||m.errors==null?null:m.errors.pattern),l(5),p("ngIf",(t.formRegistro==null||(f=t.formRegistro.get("edad"))==null||f.errors==null?null:f.errors.min)||(t.formRegistro==null||(f=t.formRegistro.get("edad"))==null||f.errors==null?null:f.errors.max)),l(5),p("ngIf",((b=t.formRegistro.get("dni"))==null||b.errors==null?null:b.errors.minlength)||((b=t.formRegistro.get("dni"))==null||b.errors==null?null:b.errors.maxlength)),l(),p("ngIf",t.selectedRole==="Paciente"),l(),p("ngIf",t.selectedRole=="Especialista"),l(5),p("ngIf",t.formRegistro==null||(x=t.formRegistro.get("email"))==null||x.errors==null?null:x.errors.pattern),l(11),p("ngForOf",t.savedFileNames),l(2),p("disabled",!(t.formRegistro!=null&&t.formRegistro.valid)||!t.savedFileNames.length)}},dependencies:[ve,J,$,W,H,fe,oe,de,pe,ee,ae,me,te,ie,le,se,Fe,we,Ce,Re,ue,re,he,ge],styles:[".full-background[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;width:100%}[_nghost-%COMP%]{display:block;background-image:url(/assets/pattern.jpg)}.panelusuarios[_ngcontent-%COMP%]{background-color:#8ecae6;padding:10px;border-radius:10px;margin:10px;width:850px;box-shadow:4px 8px 5px #0003;height:750px}input[type=file][_ngcontent-%COMP%]{display:none}.custom-file-upload[_ngcontent-%COMP%]{border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer}"]});var V=v;B([be()],V.prototype,"blockUI",void 0);export{V as AdministracionComponent};
