import{$ as se,$a as Kp,A as ee,Aa as $p,Ab as no,B as ku,Ba as ut,Bb as Hu,C as Je,Ca as zu,Cb as bi,D as kp,Db as Jp,E as Ou,Ea as jp,Eb as Xp,Fa as cr,Fb as Si,G as Dt,H as ir,Ha as Be,I as wn,Ia as qu,J as Mu,K as sr,L as Op,La as zp,M as or,Ma as Ti,N as Ht,Na as we,O as Fu,Oa as Ai,P as Mp,Q as xu,Qa as Gu,R as Lu,Ra as qp,S as Xe,Sa as Gp,T as Fp,Ta as eo,U as _e,V as fe,Va as Wp,W as xp,Y as H,Z as rt,_ as Lp,a as V,aa as Vu,b as Te,ba as Q,bb as Hp,ca as L,da as Ue,e as Gt,ea as wi,f as m,fa as ar,g as Sp,ga as Vp,h as bu,ha as it,i as _n,ia as En,j as Su,k as Cu,ka as Ei,l as Wt,m as Ye,ma as Up,na as ur,o as Cp,oa as bt,p as Rp,pa as Zs,q as Kt,qb as Qp,r as Ru,sa as Uu,t as Pu,ta as Bu,u as Nu,ua as St,v as Ve,va as $u,vb as Di,w as z,wa as Ii,wb as Yp,x as _i,xa as In,xb as to,y as Pp,ya as Bp,yb as Wu,z as Np,za as ju,zb as Ku}from"./chunk-WIFXGSG2.js";var sg=null;function lr(){return sg}function og(n){sg??=n}var ro=class{};var $e=new se(""),ag=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:()=>L(cw),providedIn:"platform"});let n=e;return n})();var cw=(()=>{let e=class e extends ag{constructor(){super(),this._doc=L($e),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return lr().getBaseHref(this._doc)}onPopState(r){let i=lr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=lr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function ug(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function Zp(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Tn(n){return n&&n[0]!=="?"?"?"+n:n}var dr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:()=>L(cg),providedIn:"root"});let n=e;return n})(),lw=new se(""),cg=(()=>{let e=class e extends dr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??L($e).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return ug(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Tn(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let u=this.prepareExternalUrl(s+Tn(o));this._platformLocation.pushState(r,i,u)}replaceState(r,i,s,o){let u=this.prepareExternalUrl(s+Tn(o));this._platformLocation.replaceState(r,i,u)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(Q(ag),Q(lw,8))},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Ci=(()=>{let e=class e{constructor(r){this._subject=new In,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=fw(Zp(eg(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Tn(i))}normalize(r){return e.stripTrailingSlash(dw(this._basePath,eg(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Tn(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Tn(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Tn,e.joinWithSlash=ug,e.stripTrailingSlash=Zp,e.\u0275fac=function(i){return new(i||e)(Q(dr))},e.\u0275prov=H({token:e,factory:()=>hw(),providedIn:"root"});let n=e;return n})();function hw(){return new Ci(Q(dr))}function dw(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function eg(n){return n.replace(/\/index.html$/,"")}function fw(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function io(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Qu=/\s+/,tg=[],CC=(()=>{let e=class e{constructor(r,i){this._ngEl=r,this._renderer=i,this.initialClasses=tg,this.stateMap=new Map}set klass(r){this.initialClasses=r!=null?r.trim().split(Qu):tg}set ngClass(r){this.rawClass=typeof r=="string"?r.trim().split(Qu):r}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let r=this.rawClass;if(Array.isArray(r)||r instanceof Set)for(let i of r)this._updateState(i,!0);else if(r!=null)for(let i of Object.keys(r))this._updateState(i,!!r[i]);this._applyStateDiff()}_updateState(r,i){let s=this.stateMap.get(r);s!==void 0?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(r,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let r of this.stateMap){let i=r[0],s=r[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(r,i){r=r.trim(),r.length>0&&r.split(Qu).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}};e.\u0275fac=function(i){return new(i||e)(Be(Ii),Be(Ti))},e.\u0275dir=En({type:e,selectors:[["","ngClass",""]],inputs:{klass:[ar.None,"class","klass"],ngClass:"ngClass"},standalone:!0});let n=e;return n})();var Yu=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},RC=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,u)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new Yu(s.item,this._ngForOf,-1,-1),u===null?void 0:u);else if(u==null)i.remove(o===null?void 0:o);else if(o!==null){let l=i.get(o);i.move(l,u),ng(l,s)}});for(let s=0,o=i.length;s<o;s++){let l=i.get(s).context;l.index=s,l.count=o,l.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);ng(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(Be(Ai),Be(qu),Be(Jp))},e.\u0275dir=En({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function ng(n,e){n.context.$implicit=e.item}var PC=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new Ju,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){rg("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){rg("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(Be(Ai),Be(qu))},e.\u0275dir=En({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),Ju=class{constructor(){this.$implicit=null,this.ngIf=null}};function rg(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${xp(e)}'.`)}var pw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=it({type:e}),e.\u0275inj=rt({});let n=e;return n})(),lg="browser",gw="server";function so(n){return n===gw}var hr=class{};var Pi=class{},ao=class{},An=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(u=>s.indexOf(u)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var Zu=class{encodeKey(e){return dg(e)}encodeValue(e){return dg(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function vw(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,u]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=t.get(o)||[];l.push(u),t.set(o,l)}),t}var _w=/%(\d[a-f0-9])/gi,ww={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function dg(n){return encodeURIComponent(n).replace(_w,(e,t)=>ww[t]??e)}function oo(n){return`${n}`}var Qt=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Zu,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=vw(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(oo):[oo(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(oo(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(oo(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var ec=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function Ew(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function fg(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function pg(n){return typeof Blob<"u"&&n instanceof Blob}function gg(n){return typeof FormData<"u"&&n instanceof FormData}function Iw(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Ri=class n{constructor(e,t,r,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(Ew(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new An,this.context??=new ec,!this.params)this.params=new Qt,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let u=t.indexOf("?"),l=u===-1?"?":u<t.length-1?"&":"";this.urlWithParams=t+l+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||fg(this.body)||pg(this.body)||gg(this.body)||Iw(this.body)?this.body:this.body instanceof Qt?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||gg(this.body)?null:pg(this.body)?this.body.type||null:fg(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Qt?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,u=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,h=e.headers||this.headers,f=e.params||this.params,y=e.context??this.context;return e.setHeaders!==void 0&&(h=Object.keys(e.setHeaders).reduce((w,S)=>w.set(S,e.setHeaders[S]),h)),e.setParams&&(f=Object.keys(e.setParams).reduce((w,S)=>w.set(S,e.setParams[S]),f)),new n(t,r,o,{params:f,headers:h,context:y,reportProgress:l,responseType:i,withCredentials:u,transferCache:s})}},fr=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(fr||{}),Ni=class{constructor(e,t=lo.Ok,r="OK"){this.headers=e.headers||new An,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},tc=class n extends Ni{constructor(e={}){super(e),this.type=fr.ResponseHeader}clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},uo=class n extends Ni{constructor(e={}){super(e),this.type=fr.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},co=class extends Ni{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},lo=function(n){return n[n.Continue=100]="Continue",n[n.SwitchingProtocols=101]="SwitchingProtocols",n[n.Processing=102]="Processing",n[n.EarlyHints=103]="EarlyHints",n[n.Ok=200]="Ok",n[n.Created=201]="Created",n[n.Accepted=202]="Accepted",n[n.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",n[n.NoContent=204]="NoContent",n[n.ResetContent=205]="ResetContent",n[n.PartialContent=206]="PartialContent",n[n.MultiStatus=207]="MultiStatus",n[n.AlreadyReported=208]="AlreadyReported",n[n.ImUsed=226]="ImUsed",n[n.MultipleChoices=300]="MultipleChoices",n[n.MovedPermanently=301]="MovedPermanently",n[n.Found=302]="Found",n[n.SeeOther=303]="SeeOther",n[n.NotModified=304]="NotModified",n[n.UseProxy=305]="UseProxy",n[n.Unused=306]="Unused",n[n.TemporaryRedirect=307]="TemporaryRedirect",n[n.PermanentRedirect=308]="PermanentRedirect",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.PaymentRequired=402]="PaymentRequired",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.MethodNotAllowed=405]="MethodNotAllowed",n[n.NotAcceptable=406]="NotAcceptable",n[n.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",n[n.RequestTimeout=408]="RequestTimeout",n[n.Conflict=409]="Conflict",n[n.Gone=410]="Gone",n[n.LengthRequired=411]="LengthRequired",n[n.PreconditionFailed=412]="PreconditionFailed",n[n.PayloadTooLarge=413]="PayloadTooLarge",n[n.UriTooLong=414]="UriTooLong",n[n.UnsupportedMediaType=415]="UnsupportedMediaType",n[n.RangeNotSatisfiable=416]="RangeNotSatisfiable",n[n.ExpectationFailed=417]="ExpectationFailed",n[n.ImATeapot=418]="ImATeapot",n[n.MisdirectedRequest=421]="MisdirectedRequest",n[n.UnprocessableEntity=422]="UnprocessableEntity",n[n.Locked=423]="Locked",n[n.FailedDependency=424]="FailedDependency",n[n.TooEarly=425]="TooEarly",n[n.UpgradeRequired=426]="UpgradeRequired",n[n.PreconditionRequired=428]="PreconditionRequired",n[n.TooManyRequests=429]="TooManyRequests",n[n.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",n[n.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",n[n.InternalServerError=500]="InternalServerError",n[n.NotImplemented=501]="NotImplemented",n[n.BadGateway=502]="BadGateway",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout",n[n.HttpVersionNotSupported=505]="HttpVersionNotSupported",n[n.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",n[n.InsufficientStorage=507]="InsufficientStorage",n[n.LoopDetected=508]="LoopDetected",n[n.NotExtended=510]="NotExtended",n[n.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",n}(lo||{});function Xu(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var Tw=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,s={}){let o;if(r instanceof Ri)o=r;else{let h;s.headers instanceof An?h=s.headers:h=new An(s.headers);let f;s.params&&(s.params instanceof Qt?f=s.params:f=new Qt({fromObject:s.params})),o=new Ri(r,i,s.body!==void 0?s.body:null,{headers:h,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let u=z(o).pipe(wn(h=>this.handler.handle(h)));if(r instanceof Ri||s.observe==="events")return u;let l=u.pipe(Dt(h=>h instanceof uo));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return l.pipe(ee(h=>{if(h.body!==null&&!(h.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return h.body}));case"blob":return l.pipe(ee(h=>{if(h.body!==null&&!(h.body instanceof Blob))throw new Error("Response is not a Blob.");return h.body}));case"text":return l.pipe(ee(h=>{if(h.body!==null&&typeof h.body!="string")throw new Error("Response is not a string.");return h.body}));case"json":default:return l.pipe(ee(h=>h.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new Qt().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,s={}){return this.request("PATCH",r,Xu(s,i))}post(r,i,s={}){return this.request("POST",r,Xu(s,i))}put(r,i,s={}){return this.request("PUT",r,Xu(s,i))}};e.\u0275fac=function(i){return new(i||e)(Q(Pi))},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})();function Aw(n,e){return e(n)}function Dw(n,e,t){return(r,i)=>bt(t,()=>e(r,s=>n(s,i)))}var vg=new se(""),bw=new se(""),Sw=new se("");var mg=(()=>{let e=class e extends Pi{constructor(r,i){super(),this.backend=r,this.injector=i,this.chain=null,this.pendingTasks=L(eo);let s=L(Sw,{optional:!0});this.backend=s??r}handle(r){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(vg),...this.injector.get(bw,[])]));this.chain=s.reduceRight((o,u)=>Dw(o,u,this.injector),Aw)}let i=this.pendingTasks.add();return this.chain(r,s=>this.backend.handle(s)).pipe(or(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(Q(ao),Q(ur))},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})();var Cw=/^\)\]\}',?\n/;function Rw(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var yg=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new fe(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?Ve(i.\u0275loadImpl()):z(null)).pipe(Xe(()=>new _n(o=>{let u=i.build();if(u.open(r.method,r.urlWithParams),r.withCredentials&&(u.withCredentials=!0),r.headers.forEach((C,M)=>u.setRequestHeader(C,M.join(","))),r.headers.has("Accept")||u.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let C=r.detectContentTypeHeader();C!==null&&u.setRequestHeader("Content-Type",C)}if(r.responseType){let C=r.responseType.toLowerCase();u.responseType=C!=="json"?C:"text"}let l=r.serializeBody(),h=null,f=()=>{if(h!==null)return h;let C=u.statusText||"OK",M=new An(u.getAllResponseHeaders()),j=Rw(u)||r.url;return h=new tc({headers:M,status:u.status,statusText:C,url:j}),h},y=()=>{let{headers:C,status:M,statusText:j,url:Y}=f(),K=null;M!==lo.NoContent&&(K=typeof u.response>"u"?u.responseText:u.response),M===0&&(M=K?lo.Ok:0);let ve=M>=200&&M<300;if(r.responseType==="json"&&typeof K=="string"){let ne=K;K=K.replace(Cw,"");try{K=K!==""?JSON.parse(K):null}catch(I){K=ne,ve&&(ve=!1,K={error:I,text:K})}}ve?(o.next(new uo({body:K,headers:C,status:M,statusText:j,url:Y||void 0})),o.complete()):o.error(new co({error:K,headers:C,status:M,statusText:j,url:Y||void 0}))},w=C=>{let{url:M}=f(),j=new co({error:C,status:u.status||0,statusText:u.statusText||"Unknown Error",url:M||void 0});o.error(j)},S=!1,N=C=>{S||(o.next(f()),S=!0);let M={type:fr.DownloadProgress,loaded:C.loaded};C.lengthComputable&&(M.total=C.total),r.responseType==="text"&&u.responseText&&(M.partialText=u.responseText),o.next(M)},O=C=>{let M={type:fr.UploadProgress,loaded:C.loaded};C.lengthComputable&&(M.total=C.total),o.next(M)};return u.addEventListener("load",y),u.addEventListener("error",w),u.addEventListener("timeout",w),u.addEventListener("abort",w),r.reportProgress&&(u.addEventListener("progress",N),l!==null&&u.upload&&u.upload.addEventListener("progress",O)),u.send(l),o.next({type:fr.Sent}),()=>{u.removeEventListener("error",w),u.removeEventListener("abort",w),u.removeEventListener("load",y),u.removeEventListener("timeout",w),r.reportProgress&&(u.removeEventListener("progress",N),l!==null&&u.upload&&u.upload.removeEventListener("progress",O)),u.readyState!==u.DONE&&u.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(Q(hr))},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})(),_g=new se(""),Pw="XSRF-TOKEN",Nw=new se("",{providedIn:"root",factory:()=>Pw}),kw="X-XSRF-TOKEN",Ow=new se("",{providedIn:"root",factory:()=>kw}),ho=class{},Mw=(()=>{let e=class e{constructor(r,i,s){this.doc=r,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=io(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(Q($e),Q(ut),Q(Nw))},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})();function Fw(n,e){let t=n.url.toLowerCase();if(!L(_g)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=L(ho).getToken(),i=L(Ow);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}function zC(...n){let e=[Tw,yg,mg,{provide:Pi,useExisting:mg},{provide:ao,useExisting:yg},{provide:vg,useValue:Fw,multi:!0},{provide:_g,useValue:!0},{provide:ho,useClass:Mw}];for(let t of n)e.push(...t.\u0275providers);return Ei(e)}var ic=class extends ro{constructor(){super(...arguments),this.supportsDOMEvents=!0}},sc=class n extends ic{static makeCurrent(){og(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Lw();return t==null?null:Vw(t)}resetBaseElement(){ki=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return io(document.cookie,e)}},ki=null;function Lw(){return ki=ki||document.querySelector("base"),ki?ki.getAttribute("href"):null}function Vw(n){return new URL(n,document.baseURI).pathname}var Uw=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})(),oc=new se(""),Tg=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new fe(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(Q(oc),Q(we))},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})(),fo=class{constructor(e){this._doc=e}},nc="ng-app-id",Ag=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=so(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${nc}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(nc),o;{let u=this.doc.createElement("style");return this.nonce&&u.setAttribute("nonce",this.nonce),u.textContent=i,this.platformIsServer&&u.setAttribute(nc,this.appId),r.appendChild(u),u}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,u=o.get(i)?.elements;u?u.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(Q($e),Q(ju),Q(zu,8),Q(ut))},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})(),rc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},uc=/%COMP%/g,Dg="%COMP%",Bw=`_nghost-${Dg}`,$w=`_ngcontent-${Dg}`,jw=!0,zw=new se("",{providedIn:"root",factory:()=>jw});function qw(n){return $w.replace(uc,n)}function Gw(n){return Bw.replace(uc,n)}function bg(n,e){return e.map(t=>t.replace(uc,n))}var wg=(()=>{let e=class e{constructor(r,i,s,o,u,l,h,f=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=u,this.platformId=l,this.ngZone=h,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=so(l),this.defaultRenderer=new Oi(r,u,h,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===wi.ShadowDom&&(i=Te(V({},i),{encapsulation:wi.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof po?s.applyToHost(r):s instanceof Mi&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let u=this.doc,l=this.ngZone,h=this.eventManager,f=this.sharedStylesHost,y=this.removeStylesOnCompDestroy,w=this.platformIsServer;switch(i.encapsulation){case wi.Emulated:o=new po(h,f,i,this.appId,y,u,l,w);break;case wi.ShadowDom:return new ac(h,f,r,i,u,l,this.nonce,w);default:o=new Mi(h,f,i,y,u,l,w);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(Q(Tg),Q(Ag),Q(ju),Q(zw),Q($e),Q(ut),Q(we),Q(zu))},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})(),Oi=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(rc[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Eg(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Eg(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new fe(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=rc[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=rc[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(cr.DashCase|cr.Important)?e.style.setProperty(t,r,i&cr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&cr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=lr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Eg(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var ac=class extends Oi{constructor(e,t,r,i,s,o,u,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=bg(i.id,i.styles);for(let f of h){let y=document.createElement("style");u&&y.setAttribute("nonce",u),y.textContent=f,this.shadowRoot.appendChild(y)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Mi=class extends Oi{constructor(e,t,r,i,s,o,u,l){super(e,s,o,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=l?bg(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},po=class extends Mi{constructor(e,t,r,i,s,o,u,l){let h=i+"-"+r.id;super(e,t,r,s,o,u,l,h),this.contentAttr=qw(h),this.hostAttr=Gw(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Ww=(()=>{let e=class e extends fo{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(Q($e))},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})(),Ig=["alt","control","meta","shift"],Kw={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Hw={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Qw=(()=>{let e=class e extends fo{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),u=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>lr().onAndCancel(r,o.domEventName,u))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),u="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),u="code."),Ig.forEach(f=>{let y=i.indexOf(f);y>-1&&(i.splice(y,1),u+=f+".")}),u+=o,i.length!=0||o.length===0)return null;let h={};return h.domEventName=s,h.fullKey=u,h}static matchEventFullKeyCode(r,i){let s=Kw[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Ig.forEach(u=>{if(u!==s){let l=Hw[u];l(r)&&(o+=u+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(Q($e))},e.\u0275prov=H({token:e,factory:e.\u0275fac});let n=e;return n})();function vR(n,e){return Xp(V({rootComponent:n},Yw(e)))}function Yw(n){return{appProviders:[...tE,...n?.providers??[]],platformProviders:eE}}function Jw(){sc.makeCurrent()}function Xw(){return new $u}function Zw(){return Bp(document),document}var eE=[{provide:ut,useValue:lg},{provide:$p,useValue:Jw,multi:!0},{provide:$e,useFactory:Zw,deps:[]}];var tE=[{provide:Up,useValue:"root"},{provide:$u,useFactory:Xw,deps:[]},{provide:oc,useClass:Ww,multi:!0,deps:[$e,we,ut]},{provide:oc,useClass:Qw,multi:!0,deps:[$e]},wg,Ag,Tg,{provide:zp,useExisting:wg},{provide:hr,useClass:Uw,deps:[]},[]];var Sg=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(Q($e))},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var W="primary",Qi=Symbol("RouteTitle"),fc=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function vr(n){return new fc(n)}function rE(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],u=n[s];if(o.startsWith(":"))i[o.substring(1)]=u;else if(o!==u.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function iE(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ct(n[t],e[t]))return!1;return!0}function ct(n,e){let t=n?pc(n):void 0,r=e?pc(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Og(n[i],e[i]))return!1;return!0}function pc(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Og(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Mg(n){return n.length>0?n[n.length-1]:null}function Zt(n){return Pp(n)?n:Wu(n)?Ve(Promise.resolve(n)):z(n)}var sE={exact:xg,subset:Lg},Fg={exact:oE,subset:aE,ignored:()=>!0};function Cg(n,e,t){return sE[t.paths](n.root,e.root,t.matrixParams)&&Fg[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function oE(n,e){return ct(n,e)}function xg(n,e,t){if(!bn(n.segments,e.segments)||!yo(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!xg(n.children[r],e.children[r],t))return!1;return!0}function aE(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Og(n[t],e[t]))}function Lg(n,e,t){return Vg(n,e,e.segments,t)}function Vg(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!bn(i,t)||e.hasChildren()||!yo(i,t,r))}else if(n.segments.length===t.length){if(!bn(n.segments,t)||!yo(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!Lg(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!bn(n.segments,i)||!yo(n.segments,i,r)||!n.children[W]?!1:Vg(n.children[W],e,s,r)}}function yo(n,e,t){return e.every((r,i)=>Fg[t](n[i].parameters,r.parameters))}var Yt=class{constructor(e=new ie([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=vr(this.queryParams),this._queryParamMap}toString(){return lE.serialize(this)}},ie=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return vo(this)}},Dn=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=vr(this.parameters),this._parameterMap}toString(){return Bg(this)}};function uE(n,e){return bn(n,e)&&n.every((t,r)=>ct(t.parameters,e[r].parameters))}function bn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function cE(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===W&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==W&&(t=t.concat(e(i,r)))}),t}var Bc=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:()=>new wo,providedIn:"root"});let n=e;return n})(),wo=class{parse(e){let t=new mc(e);return new Yt(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Fi(e.root,!0)}`,r=fE(e.queryParams),i=typeof e.fragment=="string"?`#${hE(e.fragment)}`:"";return`${t}${r}${i}`}},lE=new wo;function vo(n){return n.segments.map(e=>Bg(e)).join("/")}function Fi(n,e){if(!n.hasChildren())return vo(n);if(e){let t=n.children[W]?Fi(n.children[W],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==W&&r.push(`${i}:${Fi(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=cE(n,(r,i)=>i===W?[Fi(n.children[W],!1)]:[`${i}:${Fi(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[W]!=null?`${vo(n)}/${t[0]}`:`${vo(n)}/(${t.join("//")})`}}function Ug(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function go(n){return Ug(n).replace(/%3B/gi,";")}function hE(n){return encodeURI(n)}function gc(n){return Ug(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function _o(n){return decodeURIComponent(n)}function Rg(n){return _o(n.replace(/\+/g,"%20"))}function Bg(n){return`${gc(n.path)}${dE(n.parameters)}`}function dE(n){return Object.entries(n).map(([e,t])=>`;${gc(e)}=${gc(t)}`).join("")}function fE(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${go(t)}=${go(i)}`).join("&"):`${go(t)}=${go(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var pE=/^[^\/()?;#]+/;function cc(n){let e=n.match(pE);return e?e[0]:""}var gE=/^[^\/()?;=#]+/;function mE(n){let e=n.match(gE);return e?e[0]:""}var yE=/^[^=?&#]+/;function vE(n){let e=n.match(yE);return e?e[0]:""}var _E=/^[^&#]+/;function wE(n){let e=n.match(_E);return e?e[0]:""}var mc=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ie([],{}):new ie([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[W]=new ie(e,t)),r}parseSegment(){let e=cc(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new fe(4009,!1);return this.capture(e),new Dn(_o(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=mE(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=cc(this.remaining);i&&(r=i,this.capture(r))}e[_o(t)]=_o(r)}parseQueryParam(e){let t=vE(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=wE(this.remaining);o&&(r=o,this.capture(r))}let i=Rg(t),s=Rg(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=cc(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new fe(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=W);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[W]:new ie([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new fe(4011,!1)}};function $g(n){return n.segments.length>0?new ie([],{[W]:n}):n}function jg(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=jg(i);if(r===W&&s.segments.length===0&&s.hasChildren())for(let[o,u]of Object.entries(s.children))e[o]=u;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new ie(n.segments,e);return EE(t)}function EE(n){if(n.numberOfChildren===1&&n.children[W]){let e=n.children[W];return new ie(n.segments.concat(e.segments),e.children)}return n}function _r(n){return n instanceof Yt}function IE(n,e,t=null,r=null){let i=zg(n);return qg(i,e,t,r)}function zg(n){let e;function t(s){let o={};for(let l of s.children){let h=t(l);o[l.outlet]=h}let u=new ie(s.url,o);return s===n&&(e=u),u}let r=t(n.root),i=$g(r);return e??i}function qg(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return lc(i,i,i,t,r);let s=TE(e);if(s.toRoot())return lc(i,i,new ie([],{}),t,r);let o=AE(s,i,n),u=o.processChildren?Vi(o.segmentGroup,o.index,s.commands):Wg(o.segmentGroup,o.index,s.commands);return lc(i,o.segmentGroup,u,t,r)}function Eo(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function $i(n){return typeof n=="object"&&n!=null&&n.outlets}function lc(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([l,h])=>{s[l]=Array.isArray(h)?h.map(f=>`${f}`):`${h}`});let o;n===e?o=t:o=Gg(n,e,t);let u=$g(jg(o));return new Yt(u,s,i)}function Gg(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Gg(s,e,t)}),new ie(n.segments,r)}var Io=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Eo(r[0]))throw new fe(4003,!1);let i=r.find($i);if(i&&i!==Mg(r))throw new fe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function TE(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Io(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let u={};return Object.entries(s.outlets).forEach(([l,h])=>{u[l]=typeof h=="string"?h.split("/"):h}),[...i,{outlets:u}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((u,l)=>{l==0&&u==="."||(l==0&&u===""?t=!0:u===".."?e++:u!=""&&i.push(u))}),i):[...i,s]},[]);return new Io(t,e,r)}var mr=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function AE(n,e,t){if(n.isAbsolute)return new mr(e,!0,0);if(!t)return new mr(e,!1,NaN);if(t.parent===null)return new mr(t,!0,0);let r=Eo(n.commands[0])?0:1,i=t.segments.length-1+r;return DE(t,i,n.numberOfDoubleDots)}function DE(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new fe(4005,!1);i=r.segments.length}return new mr(r,!1,i-s)}function bE(n){return $i(n[0])?n[0].outlets:{[W]:n}}function Wg(n,e,t){if(n??=new ie([],{}),n.segments.length===0&&n.hasChildren())return Vi(n,e,t);let r=SE(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new ie(n.segments.slice(0,r.pathIndex),{});return s.children[W]=new ie(n.segments.slice(r.pathIndex),n.children),Vi(s,0,i)}else return r.match&&i.length===0?new ie(n.segments,{}):r.match&&!n.hasChildren()?yc(n,e,t):r.match?Vi(n,0,i):yc(n,e,t)}function Vi(n,e,t){if(t.length===0)return new ie(n.segments,{});{let r=bE(t),i={};if(Object.keys(r).some(s=>s!==W)&&n.children[W]&&n.numberOfChildren===1&&n.children[W].segments.length===0){let s=Vi(n.children[W],e,t);return new ie(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Wg(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new ie(n.segments,i)}}function SE(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],u=t[r];if($i(u))break;let l=`${u}`,h=r<t.length-1?t[r+1]:null;if(i>0&&l===void 0)break;if(l&&h&&typeof h=="object"&&h.outlets===void 0){if(!Ng(l,h,o))return s;r+=2}else{if(!Ng(l,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function yc(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if($i(s)){let l=CE(s.outlets);return new ie(r,l)}if(i===0&&Eo(t[0])){let l=n.segments[e];r.push(new Dn(l.path,Pg(t[0]))),i++;continue}let o=$i(s)?s.outlets[W]:`${s}`,u=i<t.length-1?t[i+1]:null;o&&u&&Eo(u)?(r.push(new Dn(o,Pg(u))),i+=2):(r.push(new Dn(o,{})),i++)}return new ie(r,{})}function CE(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=yc(new ie([],{}),0,r))}),e}function Pg(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Ng(n,e,t){return n==t.path&&ct(e,t.parameters)}var Ui="imperative",Se=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Se||{}),Ze=class{constructor(e,t){this.id=e,this.url=t}},ji=class extends Ze{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Se.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Jt=class extends Ze{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Se.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},We=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(We||{}),vc=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(vc||{}),Xt=class extends Ze{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Se.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Sn=class extends Ze{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Se.NavigationSkipped}},zi=class extends Ze{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Se.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},To=class extends Ze{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Se.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_c=class extends Ze{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Se.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},wc=class extends Ze{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Se.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ec=class extends Ze{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Se.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ic=class extends Ze{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Se.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tc=class{constructor(e){this.route=e,this.type=Se.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ac=class{constructor(e){this.route=e,this.type=Se.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Dc=class{constructor(e){this.snapshot=e,this.type=Se.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},bc=class{constructor(e){this.snapshot=e,this.type=Se.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Sc=class{constructor(e){this.snapshot=e,this.type=Se.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Cc=class{constructor(e){this.snapshot=e,this.type=Se.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var qi=class{},Gi=class{constructor(e){this.url=e}};var Rc=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ro,this.attachRef=null}},Ro=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Rc,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ao=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Pc(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Pc(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Nc(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Nc(e,this._root).map(t=>t.value)}};function Pc(n,e){if(n===e.value)return e;for(let t of e.children){let r=Pc(n,t);if(r)return r}return null}function Nc(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Nc(n,t);if(r.length)return r.unshift(e),r}return[]}var Ge=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function gr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Do=class extends Ao{constructor(e,t){super(e),this.snapshot=t,jc(this,e)}toString(){return this.snapshot.toString()}};function Kg(n){let e=RE(n),t=new Ye([new Dn("",{})]),r=new Ye({}),i=new Ye({}),s=new Ye({}),o=new Ye(""),u=new Cn(t,r,s,o,i,W,n,e.root);return u.snapshot=e.root,new Do(new Ge(u,[]),e)}function RE(n){let e={},t={},r={},i="",s=new Wi([],e,r,i,t,W,n,null,{});return new bo("",new Ge(s,[]))}var Cn=class{constructor(e,t,r,i,s,o,u,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=u,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(ee(h=>h[Qi]))??z(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ee(e=>vr(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ee(e=>vr(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function $c(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:V(V({},e.params),n.params),data:V(V({},e.data),n.data),resolve:V(V(V(V({},n.data),e.data),i?.data),n._resolvedData)}:r={params:V({},n.params),data:V({},n.data),resolve:V(V({},n.data),n._resolvedData??{})},i&&Qg(i)&&(r.resolve[Qi]=i.title),r}var Wi=class{get title(){return this.data?.[Qi]}constructor(e,t,r,i,s,o,u,l,h){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=u,this.routeConfig=l,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=vr(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=vr(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},bo=class extends Ao{constructor(e,t){super(t),this.url=e,jc(this,t)}toString(){return Hg(this._root)}};function jc(n,e){e.value._routerState=n,e.children.forEach(t=>jc(n,t))}function Hg(n){let e=n.children.length>0?` { ${n.children.map(Hg).join(", ")} } `:"";return`${n.value}${e}`}function hc(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ct(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ct(e.params,t.params)||n.paramsSubject.next(t.params),iE(e.url,t.url)||n.urlSubject.next(t.url),ct(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function kc(n,e){let t=ct(n.params,e.params)&&uE(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||kc(n.parent,e.parent))}function Qg(n){return typeof n.title=="string"||n.title===null}var PE=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=W,this.activateEvents=new In,this.deactivateEvents=new In,this.attachEvents=new In,this.detachEvents=new In,this.parentContexts=L(Ro),this.location=L(Ai),this.changeDetector=L(bi),this.environmentInjector=L(ur),this.inputBinder=L(zc,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new fe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new fe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new fe(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new fe(4013,!1);this._activatedRoute=r;let s=this.location,u=r.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,h=new Oc(r,l,s.injector);this.activated=s.createComponent(u,{index:s.length,injector:h,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=En({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Zs]});let n=e;return n})(),Oc=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Cn?this.route:e===Ro?this.childContexts:this.parent.get(e,t)}},zc=new se("");function NE(n,e,t){let r=Ki(n,e._root,t?t._root:void 0);return new Do(r,e)}function Ki(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=kE(n,e,t);return new Ge(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(u=>Ki(n,u)),o}}let r=OE(e.value),i=e.children.map(s=>Ki(n,s));return new Ge(r,i)}}function kE(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Ki(n,r,i);return Ki(n,r)})}function OE(n){return new Cn(new Ye(n.url),new Ye(n.params),new Ye(n.queryParams),new Ye(n.fragment),new Ye(n.data),n.outlet,n.component,n)}var Yg="ngNavigationCancelingError";function Jg(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=_r(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Xg(!1,We.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function Xg(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Yg]=!0,t.cancellationCode=e,t}function ME(n){return Zg(n)&&_r(n.url)}function Zg(n){return!!n&&n[Yg]}var FE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Vp({type:e,selectors:[["ng-component"]],standalone:!0,features:[Qp],decls:1,vars:0,template:function(i,s){i&1&&Kp(0,"router-outlet")},dependencies:[PE],encapsulation:2});let n=e;return n})();function xE(n,e){return n.providers&&!n._injector&&(n._injector=Gp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function qc(n){let e=n.children&&n.children.map(qc),t=e?Te(V({},n),{children:e}):V({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==W&&(t.component=FE),t}function lt(n){return n.outlet||W}function LE(n,e){let t=n.filter(r=>lt(r)===e);return t.push(...n.filter(r=>lt(r)!==e)),t}function Yi(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var VE=(n,e,t,r)=>ee(i=>(new Mc(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Mc=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),hc(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=gr(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=gr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),u=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=gr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=gr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Cc(s.value.snapshot))}),e.children.length&&this.forwardEvent(new bc(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(hc(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(u.contexts),o.attachRef=u.componentRef,o.route=u.route.value,o.outlet&&o.outlet.attach(u.componentRef,u.route.value),hc(u.route.value),this.activateChildRoutes(e,null,o.children)}else{let u=Yi(i.snapshot);o.attachRef=null,o.route=i,o.injector=u,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},So=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},yr=class{constructor(e,t){this.component=e,this.route=t}};function UE(n,e,t){let r=n._root,i=e?e._root:null;return xi(r,i,t,[r.value])}function BE(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Er(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!Lp(n)?n:e.get(n):r}function xi(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=gr(e);return n.children.forEach(o=>{$E(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,u])=>Bi(u,t.getContext(o),i)),i}function $E(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=jE(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new So(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?xi(n,e,u?u.children:null,r,i):xi(n,e,t,r,i),l&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new yr(u.outlet.component,o))}else o&&Bi(e,u,i),i.canActivateChecks.push(new So(r)),s.component?xi(n,null,u?u.children:null,r,i):xi(n,null,t,r,i);return i}function jE(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!bn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!bn(n.url,e.url)||!ct(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!kc(n,e)||!ct(n.queryParams,e.queryParams);case"paramsChange":default:return!kc(n,e)}}function Bi(n,e,t){let r=gr(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Bi(o,e.children.getContext(s),t):Bi(o,null,t):Bi(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new yr(e.outlet.component,i)):t.canDeactivateChecks.push(new yr(null,i)):t.canDeactivateChecks.push(new yr(null,i))}function Ji(n){return typeof n=="function"}function zE(n){return typeof n=="boolean"}function qE(n){return n&&Ji(n.canLoad)}function GE(n){return n&&Ji(n.canActivate)}function WE(n){return n&&Ji(n.canActivateChild)}function KE(n){return n&&Ji(n.canDeactivate)}function HE(n){return n&&Ji(n.canMatch)}function em(n){return n instanceof Np||n?.name==="EmptyError"}var mo=Symbol("INITIAL_VALUE");function wr(){return Xe(n=>ku(n.map(e=>e.pipe(sr(1),Lu(mo)))).pipe(ee(e=>{for(let t of e)if(t!==!0){if(t===mo)return mo;if(t===!1||t instanceof Yt)return t}return!0}),Dt(e=>e!==mo),sr(1)))}function QE(n,e){return Je(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?z(Te(V({},t),{guardsResult:!0})):YE(o,r,i,n).pipe(Je(u=>u&&zE(u)?JE(r,s,n,e):z(u)),ee(u=>Te(V({},t),{guardsResult:u})))})}function YE(n,e,t,r){return Ve(n).pipe(Je(i=>nI(i.component,i.route,t,e,r)),Ht(i=>i!==!0,!0))}function JE(n,e,t,r){return Ve(e).pipe(wn(i=>kp(ZE(i.route.parent,r),XE(i.route,r),tI(n,i.path,t),eI(n,i.route,t))),Ht(i=>i!==!0,!0))}function XE(n,e){return n!==null&&e&&e(new Sc(n)),z(!0)}function ZE(n,e){return n!==null&&e&&e(new Dc(n)),z(!0)}function eI(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return z(!0);let i=r.map(s=>Ou(()=>{let o=Yi(e)??t,u=Er(s,o),l=GE(u)?u.canActivate(e,n):bt(o,()=>u(e,n));return Zt(l).pipe(Ht())}));return z(i).pipe(wr())}function tI(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>BE(o)).filter(o=>o!==null).map(o=>Ou(()=>{let u=o.guards.map(l=>{let h=Yi(o.node)??t,f=Er(l,h),y=WE(f)?f.canActivateChild(r,n):bt(h,()=>f(r,n));return Zt(y).pipe(Ht())});return z(u).pipe(wr())}));return z(s).pipe(wr())}function nI(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return z(!0);let o=s.map(u=>{let l=Yi(e)??i,h=Er(u,l),f=KE(h)?h.canDeactivate(n,e,t,r):bt(l,()=>h(n,e,t,r));return Zt(f).pipe(Ht())});return z(o).pipe(wr())}function rI(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return z(!0);let s=i.map(o=>{let u=Er(o,n),l=qE(u)?u.canLoad(e,t):bt(n,()=>u(e,t));return Zt(l)});return z(s).pipe(wr(),tm(r))}function tm(n){return bu(_e(e=>{if(_r(e))throw Jg(n,e)}),ee(e=>e===!0))}function iI(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return z(!0);let s=i.map(o=>{let u=Er(o,n),l=HE(u)?u.canMatch(e,t):bt(n,()=>u(e,t));return Zt(l)});return z(s).pipe(wr(),tm(r))}var Hi=class{constructor(e){this.segmentGroup=e||null}},Co=class extends Error{constructor(e){super(),this.urlTree=e}};function pr(n){return _i(new Hi(n))}function sI(n){return _i(new fe(4e3,!1))}function oI(n){return _i(Xg(!1,We.GuardRejected))}var Fc=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return z(r);if(i.numberOfChildren>1||!i.children[W])return sI(e.redirectTo);i=i.children[W]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Co(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Yt(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let u=s.substring(1);r[i]=t[u]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([u,l])=>{o[u]=this.createSegmentGroup(e,l,r,i)}),new ie(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new fe(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},xc={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function aI(n,e,t,r,i){let s=Gc(n,e,t);return s.matched?(r=xE(e,r),iI(r,e,t,i).pipe(ee(o=>o===!0?s:V({},xc)))):z(s)}function Gc(n,e,t){if(e.path==="**")return uI(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?V({},xc):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||rE)(t,n,e);if(!i)return V({},xc);let s={};Object.entries(i.posParams??{}).forEach(([u,l])=>{s[u]=l.path});let o=i.consumed.length>0?V(V({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function uI(n){return{matched:!0,parameters:n.length>0?Mg(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function kg(n,e,t,r){return t.length>0&&hI(n,t,r)?{segmentGroup:new ie(e,lI(r,new ie(t,n.children))),slicedSegments:[]}:t.length===0&&dI(n,t,r)?{segmentGroup:new ie(n.segments,cI(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ie(n.segments,n.children),slicedSegments:t}}function cI(n,e,t,r){let i={};for(let s of t)if(Po(n,e,s)&&!r[lt(s)]){let o=new ie([],{});i[lt(s)]=o}return V(V({},r),i)}function lI(n,e){let t={};t[W]=e;for(let r of n)if(r.path===""&&lt(r)!==W){let i=new ie([],{});t[lt(r)]=i}return t}function hI(n,e,t){return t.some(r=>Po(n,e,r)&&lt(r)!==W)}function dI(n,e,t){return t.some(r=>Po(n,e,r))}function Po(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function fI(n,e,t,r){return lt(n)!==r&&(r===W||!Po(e,t,n))?!1:Gc(e,n,t).matched}function pI(n,e,t){return e.length===0&&!n.children[t]}var Lc=class{};function gI(n,e,t,r,i,s,o="emptyOnly"){return new Vc(n,e,t,r,i,o,s).recognize()}var mI=31,Vc=class{constructor(e,t,r,i,s,o,u){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=u,this.applyRedirects=new Fc(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new fe(4002,`'${e.segmentGroup}'`)}recognize(){let e=kg(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ee(t=>{let r=new Wi([],Object.freeze({}),Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,{},W,this.rootComponentType,null,{}),i=new Ge(r,t),s=new bo("",i),o=IE(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,W).pipe(ir(r=>{if(r instanceof Co)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Hi?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=$c(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(ee(s=>s instanceof Ge?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return Ve(i).pipe(wn(s=>{let o=r.children[s],u=LE(t,s);return this.processSegmentGroup(e,u,o,s)}),xu((s,o)=>(s.push(...o),s)),Mu(null),Mp(),Je(s=>{if(s===null)return pr(r);let o=nm(s);return yI(o),z(o)}))}processSegment(e,t,r,i,s,o){return Ve(t).pipe(wn(u=>this.processSegmentAgainstRoute(u._injector??e,t,u,r,i,s,o).pipe(ir(l=>{if(l instanceof Hi)return z(null);throw l}))),Ht(u=>!!u),ir(u=>{if(em(u))return pI(r,i,s)?z(new Lc):pr(r);throw u}))}processSegmentAgainstRoute(e,t,r,i,s,o,u){return fI(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):pr(i):pr(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:u,consumedSegments:l,positionalParamSegments:h,remainingSegments:f}=Gc(t,i,s);if(!u)return pr(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>mI&&(this.allowRedirects=!1));let y=this.applyRedirects.applyRedirectCommands(l,i.redirectTo,h);return this.applyRedirects.lineralizeSegments(i,y).pipe(Je(w=>this.processSegment(e,r,t,w.concat(f),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=aI(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(Xe(u=>u.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Xe(({routes:l})=>{let h=r._loadedInjector??e,{consumedSegments:f,remainingSegments:y,parameters:w}=u,S=new Wi(f,w,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,_I(r),lt(r),r.component??r._loadedComponent??null,r,wI(r)),{segmentGroup:N,slicedSegments:O}=kg(t,f,y,l);if(O.length===0&&N.hasChildren())return this.processChildren(h,l,N).pipe(ee(M=>M===null?null:new Ge(S,M)));if(l.length===0&&O.length===0)return z(new Ge(S,[]));let C=lt(r)===s;return this.processSegment(h,l,N,O,C?W:s,!0).pipe(ee(M=>new Ge(S,M instanceof Ge?[M]:[])))}))):pr(t)))}getChildConfig(e,t,r){return t.children?z({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?z({routes:t._loadedRoutes,injector:t._loadedInjector}):rI(e,t,r,this.urlSerializer).pipe(Je(i=>i?this.configLoader.loadChildren(e,t).pipe(_e(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):oI(t))):z({routes:[],injector:e})}};function yI(n){n.sort((e,t)=>e.value.outlet===W?-1:t.value.outlet===W?1:e.value.outlet.localeCompare(t.value.outlet))}function vI(n){let e=n.value.routeConfig;return e&&e.path===""}function nm(n){let e=[],t=new Set;for(let r of n){if(!vI(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=nm(r.children);e.push(new Ge(r.value,i))}return e.filter(r=>!t.has(r))}function _I(n){return n.data||{}}function wI(n){return n.resolve||{}}function EI(n,e,t,r,i,s){return Je(o=>gI(n,e,t,r,o.extractedUrl,i,s).pipe(ee(({state:u,tree:l})=>Te(V({},o),{targetSnapshot:u,urlAfterRedirects:l}))))}function II(n,e){return Je(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return z(t);let s=new Set(i.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let h of rm(l))o.add(h);let u=0;return Ve(o).pipe(wn(l=>s.has(l)?TI(l,r,n,e):(l.data=$c(l,l.parent,n).resolve,z(void 0))),_e(()=>u++),Fu(1),Je(l=>u===o.size?z(t):Kt))})}function rm(n){let e=n.children.map(t=>rm(t)).flat();return[n,...e]}function TI(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Qg(i)&&(s[Qi]=i.title),AI(s,n,e,r).pipe(ee(o=>(n._resolvedData=o,n.data=$c(n,n.parent,t).resolve,null)))}function AI(n,e,t,r){let i=pc(n);if(i.length===0)return z({});let s={};return Ve(i).pipe(Je(o=>DI(n[o],e,t,r).pipe(Ht(),_e(u=>{s[o]=u}))),Fu(1),Op(s),ir(o=>em(o)?Kt:_i(o)))}function DI(n,e,t,r){let i=Yi(e)??r,s=Er(n,i),o=s.resolve?s.resolve(e,t):bt(i,()=>s(e,t));return Zt(o)}function dc(n){return Xe(e=>{let t=n(e);return t?Ve(t).pipe(ee(()=>e)):z(e)})}var im=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===W);return i}getResolvedTitleForRoute(r){return r.data[Qi]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:()=>L(bI),providedIn:"root"});let n=e;return n})(),bI=(()=>{let e=class e extends im{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(Q(Sg))},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Wc=new se("",{providedIn:"root",factory:()=>({})}),Kc=new se(""),SI=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=L(Hu)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return z(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Zt(r.loadComponent()).pipe(ee(sm),_e(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),or(()=>{this.componentLoaders.delete(r)})),s=new Cu(i,()=>new Wt).pipe(Su());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return z({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=CI(i,this.compiler,r,this.onLoadEndListener).pipe(or(()=>{this.childrenLoaders.delete(i)})),u=new Cu(o,()=>new Wt).pipe(Su());return this.childrenLoaders.set(i,u),u}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function CI(n,e,t,r){return Zt(n.loadChildren()).pipe(ee(sm),Je(i=>i instanceof qp||Array.isArray(i)?z(i):Ve(e.compileModuleAsync(i))),ee(i=>{r&&r(n);let s,o,u=!1;return Array.isArray(i)?(o=i,u=!0):(s=i.create(t).injector,o=s.get(Kc,[],{optional:!0,self:!0}).flat()),{routes:o.map(qc),injector:s}}))}function RI(n){return n&&typeof n=="object"&&"default"in n}function sm(n){return RI(n)?n.default:n}var Hc=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:()=>L(PI),providedIn:"root"});let n=e;return n})(),PI=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),NI=new se("");var kI=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Wt,this.transitionAbortSubject=new Wt,this.configLoader=L(SI),this.environmentInjector=L(ur),this.urlSerializer=L(Bc),this.rootContexts=L(Ro),this.location=L(Ci),this.inputBindingEnabled=L(zc,{optional:!0})!==null,this.titleStrategy=L(im),this.options=L(Wc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=L(Hc),this.createViewTransition=L(NI,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>z(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Tc(s)),i=s=>this.events.next(new Ac(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Te(V(V({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Ye({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ui,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Dt(o=>o.id!==0),ee(o=>Te(V({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Xe(o=>{let u=!1,l=!1;return z(o).pipe(Xe(h=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",We.SupersededByNewNavigation),Kt;this.currentTransition=o,this.currentNavigation={id:h.id,initialUrl:h.rawUrl,extractedUrl:h.extractedUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?Te(V({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let f=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),y=h.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!f&&y!=="reload"){let w="";return this.events.next(new Sn(h.id,this.urlSerializer.serialize(h.rawUrl),w,vc.IgnoredSameUrlNavigation)),h.resolve(null),Kt}if(this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return z(h).pipe(Xe(w=>{let S=this.transitions?.getValue();return this.events.next(new ji(w.id,this.urlSerializer.serialize(w.extractedUrl),w.source,w.restoredState)),S!==this.transitions?.getValue()?Kt:Promise.resolve(w)}),EI(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),_e(w=>{o.targetSnapshot=w.targetSnapshot,o.urlAfterRedirects=w.urlAfterRedirects,this.currentNavigation=Te(V({},this.currentNavigation),{finalUrl:w.urlAfterRedirects});let S=new To(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot);this.events.next(S)}));if(f&&this.urlHandlingStrategy.shouldProcessUrl(h.currentRawUrl)){let{id:w,extractedUrl:S,source:N,restoredState:O,extras:C}=h,M=new ji(w,this.urlSerializer.serialize(S),N,O);this.events.next(M);let j=Kg(this.rootComponentType).snapshot;return this.currentTransition=o=Te(V({},h),{targetSnapshot:j,urlAfterRedirects:S,extras:Te(V({},C),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=S,z(o)}else{let w="";return this.events.next(new Sn(h.id,this.urlSerializer.serialize(h.extractedUrl),w,vc.IgnoredByUrlHandlingStrategy)),h.resolve(null),Kt}}),_e(h=>{let f=new _c(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}),ee(h=>(this.currentTransition=o=Te(V({},h),{guards:UE(h.targetSnapshot,h.currentSnapshot,this.rootContexts)}),o)),QE(this.environmentInjector,h=>this.events.next(h)),_e(h=>{if(o.guardsResult=h.guardsResult,_r(h.guardsResult))throw Jg(this.urlSerializer,h.guardsResult);let f=new wc(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.events.next(f)}),Dt(h=>h.guardsResult?!0:(this.cancelNavigationTransition(h,"",We.GuardRejected),!1)),dc(h=>{if(h.guards.canActivateChecks.length)return z(h).pipe(_e(f=>{let y=new Ec(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(y)}),Xe(f=>{let y=!1;return z(f).pipe(II(this.paramsInheritanceStrategy,this.environmentInjector),_e({next:()=>y=!0,complete:()=>{y||this.cancelNavigationTransition(f,"",We.NoDataFromResolver)}}))}),_e(f=>{let y=new Ic(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(y)}))}),dc(h=>{let f=y=>{let w=[];y.routeConfig?.loadComponent&&!y.routeConfig._loadedComponent&&w.push(this.configLoader.loadComponent(y.routeConfig).pipe(_e(S=>{y.component=S}),ee(()=>{})));for(let S of y.children)w.push(...f(S));return w};return ku(f(h.targetSnapshot.root)).pipe(Mu(null),sr(1))}),dc(()=>this.afterPreactivation()),Xe(()=>{let{currentSnapshot:h,targetSnapshot:f}=o,y=this.createViewTransition?.(this.environmentInjector,h.root,f.root);return y?Ve(y).pipe(ee(()=>o)):z(o)}),ee(h=>{let f=NE(r.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return this.currentTransition=o=Te(V({},h),{targetRouterState:f}),this.currentNavigation.targetRouterState=f,o}),_e(()=>{this.events.next(new qi)}),VE(this.rootContexts,r.routeReuseStrategy,h=>this.events.next(h),this.inputBindingEnabled),sr(1),_e({next:h=>{u=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Jt(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects))),this.titleStrategy?.updateTitle(h.targetRouterState.snapshot),h.resolve(!0)},complete:()=>{u=!0}}),Fp(this.transitionAbortSubject.pipe(_e(h=>{throw h}))),or(()=>{!u&&!l&&this.cancelNavigationTransition(o,"",We.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ir(h=>{if(l=!0,Zg(h))this.events.next(new Xt(o.id,this.urlSerializer.serialize(o.extractedUrl),h.message,h.cancellationCode)),ME(h)?this.events.next(new Gi(h.url)):o.resolve(!1);else{this.events.next(new zi(o.id,this.urlSerializer.serialize(o.extractedUrl),h,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(h))}catch(f){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(f)}}return Kt}))}))}cancelNavigationTransition(r,i,s){let o=new Xt(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function OI(n){return n!==Ui}var MI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:()=>L(FI),providedIn:"root"});let n=e;return n})(),Uc=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},FI=(()=>{let e=class e extends Uc{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Uu(e)))(s||e)}})(),e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),om=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:()=>L(xI),providedIn:"root"});let n=e;return n})(),xI=(()=>{let e=class e extends om{constructor(){super(...arguments),this.location=L(Ci),this.urlSerializer=L(Bc),this.options=L(Wc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=L(Hc),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Yt,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Kg(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof ji)this.stateMemento=this.createStateMemento();else if(r instanceof Sn)this.rawUrlTree=i.initialUrl;else if(r instanceof To){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof qi?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Xt&&(r.code===We.GuardRejected||r.code===We.NoDataFromResolver)?this.restoreHistory(i):r instanceof zi?this.restoreHistory(i,!0):r instanceof Jt&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,u=V(V({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",u)}else{let o=V(V({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Uu(e)))(s||e)}})(),e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Li=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Li||{});function LI(n,e){n.events.pipe(Dt(t=>t instanceof Jt||t instanceof Xt||t instanceof zi||t instanceof Sn),ee(t=>t instanceof Jt||t instanceof Sn?Li.COMPLETE:(t instanceof Xt?t.code===We.Redirect||t.code===We.SupersededByNewNavigation:!1)?Li.REDIRECTING:Li.FAILED),Dt(t=>t!==Li.REDIRECTING),sr(1)).subscribe(()=>{e()})}function VI(n){throw n}var UI={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},BI={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Qc=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=L(to),this.stateManager=L(om),this.options=L(Wc,{optional:!0})||{},this.pendingTasks=L(eo),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=L(kI),this.urlSerializer=L(Bc),this.location=L(Ci),this.urlHandlingStrategy=L(Hc),this._events=new Wt,this.errorHandler=this.options.errorHandler||VI,this.navigated=!1,this.routeReuseStrategy=L(MI),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=L(Kc,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!L(zc,{optional:!0}),this.eventsSubscription=new Sp,this.isNgZoneEnabled=L(we)instanceof we&&we.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Xt&&i.code!==We.Redirect&&i.code!==We.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Jt)this.navigated=!0;else if(i instanceof Gi){let u=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),l={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||OI(s.source)};this.scheduleNavigation(u,Ui,null,l,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}jI(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Ui,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},u=s?.navigationId?s:null;if(s){let h=V({},s);delete h.navigationId,delete h.\u0275routerPageId,Object.keys(h).length!==0&&(o.state=h)}let l=this.parseUrl(r);this.scheduleNavigation(l,i,u,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(qc),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:u,queryParamsHandling:l,preserveFragment:h}=i,f=h?this.currentUrlTree.fragment:u,y=null;switch(l){case"merge":y=V(V({},this.currentUrlTree.queryParams),o);break;case"preserve":y=this.currentUrlTree.queryParams;break;default:y=o||null}y!==null&&(y=this.removeEmptyProps(y));let w;try{let S=s?s.snapshot:this.routerState.snapshot.root;w=zg(S)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),w=this.currentUrlTree.root}return qg(w,r,y,f??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=_r(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Ui,null,i)}navigate(r,i={skipLocationChange:!1}){return $I(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=V({},UI):i===!1?s=V({},BI):s=i,_r(r))return Cg(this.currentUrlTree,r,s);let o=this.parseUrl(r);return Cg(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,u){if(this.disposed)return Promise.resolve(!1);let l,h,f;u?(l=u.resolve,h=u.reject,f=u.promise):f=new Promise((w,S)=>{l=w,h=S});let y=this.pendingTasks.add();return LI(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(y))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:l,reject:h,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(w=>Promise.reject(w))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function $I(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new fe(4008,!1)}function jI(n){return!(n instanceof qi)&&!(n instanceof Gi)}var QR=(()=>{let e=class e{constructor(r,i,s,o,u,l){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=u,this.locationStrategy=l,this.href=null,this.commands=null,this.onChanges=new Wt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let h=u.nativeElement.tagName?.toLowerCase();this.isAnchorElement=h==="a"||h==="area",this.isAnchorElement?this.subscription=r.events.subscribe(f=>{f instanceof Jt&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,u){let l=this.urlTree;if(l===null||this.isAnchorElement&&(r!==0||i||s||o||u||typeof this.target=="string"&&this.target!="_self"))return!0;let h={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(l,h),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:jp(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(Be(Qc),Be(Cn),Bu("tabindex"),Be(Ti),Be(Ii),Be(dr))},e.\u0275dir=En({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Hp("click",function(u){return s.onClick(u.button,u.ctrlKey,u.shiftKey,u.altKey,u.metaKey)}),i&2&&Wp("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[ar.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Si],skipLocationChange:[ar.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Si],replaceUrl:[ar.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Si],routerLink:"routerLink"},standalone:!0,features:[Gu,Zs]});let n=e;return n})();var zI=new se("");function YR(n,...e){return Ei([{provide:Kc,multi:!0,useValue:n},[],{provide:Cn,useFactory:qI,deps:[Qc]},{provide:Ku,multi:!0,useFactory:GI},e.map(t=>t.\u0275providers)])}function qI(n){return n.routerState.root}function GI(){let n=L(St);return e=>{let t=n.get(no);if(e!==t.components[0])return;let r=n.get(Qc),i=n.get(WI);n.get(KI)===1&&r.initialNavigation(),n.get(HI,null,Vu.Optional)?.setUpPreloading(),n.get(zI,null,Vu.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var WI=new se("",{factory:()=>new Wt}),KI=new se("",{providedIn:"root",factory:()=>1});var HI=new se("");var um=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},QI=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],u=n[t++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},cm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,u=o?n[i+1]:0,l=i+2<n.length,h=l?n[i+2]:0,f=s>>2,y=(s&3)<<4|u>>4,w=(u&15)<<2|h>>6,S=h&63;l||(S=64,o||(w=64)),r.push(t[f],t[y],t[w],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(um(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):QI(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let y=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||h==null||y==null)throw new Jc;let w=s<<2|u>>4;if(r.push(w),h!==64){let S=u<<4&240|h>>2;if(r.push(S),y!==64){let N=h<<6&192|y;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Jc=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},YI=function(n){let e=um(n);return cm.encodeByteArray(e,!0)},Xi=function(n){return YI(n).replace(/\./g,"")},Zc=function(n){try{return cm.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function JI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var XI=()=>JI().__FIREBASE_DEFAULTS__,ZI=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},eT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Zc(n[1]);return e&&JSON.parse(e)},ko=()=>{try{return XI()||ZI()||eT()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},el=n=>{var e,t;return(t=(e=ko())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},lm=n=>{let e=el(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},tl=()=>{var n;return(n=ko())===null||n===void 0?void 0:n.config},nl=n=>{var e;return(e=ko())===null||e===void 0?void 0:e[`_${n}`]};var No=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function hm(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Xi(JSON.stringify(t)),Xi(JSON.stringify(o)),""].join(".")}function Ee(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function dm(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ee())}function tT(){var n;let e=(n=ko())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fm(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function pm(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gm(){let n=Ee();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function mm(){return!tT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rl(){try{return typeof indexedDB=="object"}catch{return!1}}function ym(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var nT="FirebaseError",Ke=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=nT,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Rt.prototype.create)}},Rt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?rT(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new Ke(i,u,r)}};function rT(n,e){return n.replace(iT,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var iT=/\{\$([^}]+)}/g;function vm(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Rn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(am(s)&&am(o)){if(!Rn(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function am(n){return n!==null&&typeof n=="object"}function Zi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ir(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Tr(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function _m(n,e){let t=new Xc(n,e);return t.subscribe.bind(t)}var Xc=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");sT(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Yc),i.error===void 0&&(i.error=Yc),i.complete===void 0&&(i.complete=Yc);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function sT(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Yc(){}var ZR=4*60*60*1e3;function pe(n){return n&&n._delegate?n._delegate:n}var et=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Pn="[DEFAULT]";var il=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new No;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(aT(e))try{this.getOrInitializeService({instanceIdentifier:Pn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Pn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return m(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Pn){return this.instances.has(e)}getOptions(e=Pn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:oT(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Pn){return this.component?this.component.multipleInstances?e:Pn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function oT(n){return n===Pn?void 0:n}function aT(n){return n.instantiationMode==="EAGER"}var Oo=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new il(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var uT=[],J=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(J||{}),cT={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},lT=J.INFO,hT={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},dT=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=hT[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},en=class{constructor(e){this.name=e,this._logLevel=lT,this._logHandler=dT,this._userLogHandler=null,uT.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in J))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...e),this._logHandler(this,J.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...e),this._logHandler(this,J.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,J.INFO,...e),this._logHandler(this,J.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,J.WARN,...e),this._logHandler(this,J.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...e),this._logHandler(this,J.ERROR,...e)}};var fT=(n,e)=>e.some(t=>n instanceof t),wm,Em;function pT(){return wm||(wm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gT(){return Em||(Em=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Im=new WeakMap,ol=new WeakMap,Tm=new WeakMap,sl=new WeakMap,ul=new WeakMap;function mT(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ht(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Im.set(t,n)}).catch(()=>{}),ul.set(e,n),e}function yT(n){if(ol.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});ol.set(n,e)}var al={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ol.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Tm.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ht(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Am(n){al=n(al)}function vT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Mo(this),e,...t);return Tm.set(r,e.sort?e.sort():[e]),ht(r)}:gT().includes(n)?function(...e){return n.apply(Mo(this),e),ht(Im.get(this))}:function(...e){return ht(n.apply(Mo(this),e))}}function _T(n){return typeof n=="function"?vT(n):(n instanceof IDBTransaction&&yT(n),fT(n,pT())?new Proxy(n,al):n)}function ht(n){if(n instanceof IDBRequest)return mT(n);if(sl.has(n))return sl.get(n);let e=_T(n);return e!==n&&(sl.set(n,e),ul.set(e,n)),e}var Mo=n=>ul.get(n);function bm(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),u=ht(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ht(o.result),l.oldVersion,l.newVersion,ht(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),u}var wT=["get","getKey","getAll","getAllKeys","count"],ET=["put","add","delete","clear"],cl=new Map;function Dm(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(cl.get(e))return cl.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=ET.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||wT.includes(t)))return;let s=function(o,...u){return m(this,null,function*(){let l=this.transaction(o,i?"readwrite":"readonly"),h=l.store;return r&&(h=h.index(u.shift())),(yield Promise.all([h[t](...u),i&&l.done]))[0]})};return cl.set(e,s),s}Am(n=>Te(V({},n),{get:(e,t,r)=>Dm(e,t)||n.get(e,t,r),has:(e,t)=>!!Dm(e,t)||n.has(e,t)}));var hl=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(IT(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function IT(n){let e=n.getComponent();return e?.type==="VERSION"}var dl="@firebase/app",Sm="0.10.5";var Nn=new en("@firebase/app"),TT="@firebase/app-compat",AT="@firebase/analytics-compat",DT="@firebase/analytics",bT="@firebase/app-check-compat",ST="@firebase/app-check",CT="@firebase/auth",RT="@firebase/auth-compat",PT="@firebase/database",NT="@firebase/database-compat",kT="@firebase/functions",OT="@firebase/functions-compat",MT="@firebase/installations",FT="@firebase/installations-compat",xT="@firebase/messaging",LT="@firebase/messaging-compat",VT="@firebase/performance",UT="@firebase/performance-compat",BT="@firebase/remote-config",$T="@firebase/remote-config-compat",jT="@firebase/storage",zT="@firebase/storage-compat",qT="@firebase/firestore",GT="@firebase/vertexai-preview",WT="@firebase/firestore-compat",KT="firebase",HT="10.12.2";var fl="[DEFAULT]",QT={[dl]:"fire-core",[TT]:"fire-core-compat",[DT]:"fire-analytics",[AT]:"fire-analytics-compat",[ST]:"fire-app-check",[bT]:"fire-app-check-compat",[CT]:"fire-auth",[RT]:"fire-auth-compat",[PT]:"fire-rtdb",[NT]:"fire-rtdb-compat",[kT]:"fire-fn",[OT]:"fire-fn-compat",[MT]:"fire-iid",[FT]:"fire-iid-compat",[xT]:"fire-fcm",[LT]:"fire-fcm-compat",[VT]:"fire-perf",[UT]:"fire-perf-compat",[BT]:"fire-rc",[$T]:"fire-rc-compat",[jT]:"fire-gcs",[zT]:"fire-gcs-compat",[qT]:"fire-fst",[WT]:"fire-fst-compat",[GT]:"fire-vertex","fire-js":"fire-js",[KT]:"fire-js-all"};var es=new Map,YT=new Map,pl=new Map;function Cm(n,e){try{n.container.addComponent(e)}catch(t){Nn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function nn(n){let e=n.name;if(pl.has(e))return Nn.debug(`There were multiple attempts to register component ${e}.`),!1;pl.set(e,n);for(let t of es.values())Cm(t,n);for(let t of YT.values())Cm(t,n);return!0}function ns(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function st(n){return n.settings!==void 0}var JT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},tn=new Rt("app","Firebase",JT);var gl=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new et("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tn.create("app-deleted",{appName:this._name})}};var rn=HT;function vl(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:fl,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw tn.create("bad-app-name",{appName:String(i)});if(t||(t=tl()),!t)throw tn.create("no-options");let s=es.get(i);if(s){if(Rn(t,s.options)&&Rn(r,s.config))return s;throw tn.create("duplicate-app",{appName:i})}let o=new Oo(i);for(let l of pl.values())o.addComponent(l);let u=new gl(t,r,o);return es.set(i,u),u}function Ar(n=fl){let e=es.get(n);if(!e&&n===fl&&tl())return vl();if(!e)throw tn.create("no-app",{appName:n});return e}function Fo(){return Array.from(es.values())}function Ie(n,e,t){var r;let i=(r=QT[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Nn.warn(u.join(" "));return}nn(new et(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var XT="firebase-heartbeat-database",ZT=1,ts="firebase-heartbeat-store",ll=null;function km(){return ll||(ll=bm(XT,ZT,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ts)}catch(t){console.warn(t)}}}}).catch(n=>{throw tn.create("idb-open",{originalErrorMessage:n.message})})),ll}function e0(n){return m(this,null,function*(){try{let t=(yield km()).transaction(ts),r=yield t.objectStore(ts).get(Om(n));return yield t.done,r}catch(e){if(e instanceof Ke)Nn.warn(e.message);else{let t=tn.create("idb-get",{originalErrorMessage:e?.message});Nn.warn(t.message)}}})}function Rm(n,e){return m(this,null,function*(){try{let r=(yield km()).transaction(ts,"readwrite");yield r.objectStore(ts).put(e,Om(n)),yield r.done}catch(t){if(t instanceof Ke)Nn.warn(t.message);else{let r=tn.create("idb-set",{originalErrorMessage:t?.message});Nn.warn(r.message)}}})}function Om(n){return`${n.name}!${n.options.appId}`}var t0=1024,n0=30*24*60*60*1e3,ml=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new yl(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return m(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Pm();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let u=new Date(o.date).valueOf();return Date.now()-u<=n0}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return m(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Pm(),{heartbeatsToSend:r,unsentEntries:i}=r0(this._heartbeatsCache.heartbeats),s=Xi(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function Pm(){return new Date().toISOString().substring(0,10)}function r0(n,e=t0){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Nm(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Nm(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var yl=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return m(this,null,function*(){return rl()?ym().then(()=>!0).catch(()=>!1):!1})}read(){return m(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield e0(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return m(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Rm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return m(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Rm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Nm(n){return Xi(JSON.stringify({version:2,heartbeats:n})).length}function i0(n){nn(new et("platform-logger",e=>new hl(e),"PRIVATE")),nn(new et("heartbeat",e=>new ml(e),"PRIVATE")),Ie(dl,Sm,n),Ie(dl,Sm,"esm2017"),Ie("fire-js","")}i0("");var s0="firebase",o0="10.12.2";Ie(s0,o0,"app");var On=new Di("ANGULARFIRE2_VERSION");function Lo(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var rs=(n,e)=>{let t=e?[e]:Fo(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},br=class{constructor(){return rs(a0)}},a0="app-check";function Dr(){}var xo=class{zone;delegate;constructor(e,t=Rp){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},_l=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Dr,{},Dr,Dr)),t.pipe(_e({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Sr=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new xo(Zone.current)),this.insideAngular=t.run(()=>new xo(Zone.current,Cp)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Q(we))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Vo(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function u0(n){return Vo().ngZone.runOutsideAngular(()=>n())}function kn(n){return Vo().ngZone.run(()=>n())}function c0(n){return l0(Vo())(n)}function l0(n){return function(t){return t=t.lift(new _l(n.ngZone)),t.pipe(Nu(n.outsideAngular),Pu(n.insideAngular))}}var h0=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),kn(()=>n.apply(void 0,r))},Ae=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=kn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Dr,{},Dr,Dr))),r[s]=h0(r[s],t));let i=u0(()=>n.apply(this,r));if(!e)if(i instanceof _n){let s=Vo();return i.pipe(Nu(s.outsideAngular),Pu(s.insideAngular))}else return kn(()=>i);return i instanceof _n?i.pipe(c0):i instanceof Promise?kn(()=>new Promise((s,o)=>i.then(u=>kn(()=>s(u)),u=>kn(()=>o(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:kn(()=>i)};var Pt=class{constructor(e){return e}},Mn=class{constructor(){return Fo()}};function d0(n){return n&&n.length===1?n[0]:new Pt(Ar())}var wl=new se("angularfire2._apps"),f0={provide:Pt,useFactory:d0,deps:[[new Ue,wl]]},p0={provide:Mn,deps:[[new Ue,wl]]};function g0(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Pt(r)}}var m0=(()=>{class n{constructor(t){Ie("angularfire",On.full,"core"),Ie("angularfire",On.full,"app"),Ie("angular",Yp.full,t.toString())}static \u0275fac=function(r){return new(r||n)(Q(ut))};static \u0275mod=it({type:n});static \u0275inj=rt({providers:[f0,p0]})}return n})();function LP(n,...e){return{ngModule:m0,providers:[{provide:wl,useFactory:g0(n),multi:!0,deps:[we,St,Sr,...e]}]}}var VP=Ae(vl,!0);function Ym(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Jm=Ym,Xm=new Rt("auth","Firebase",Ym());var qo=new en("@firebase/auth");function y0(n,...e){qo.logLevel<=J.WARN&&qo.warn(`Auth (${rn}): ${n}`,...e)}function Bo(n,...e){qo.logLevel<=J.ERROR&&qo.error(`Auth (${rn}): ${n}`,...e)}function ft(n,...e){throw zl(n,...e)}function Fn(n,...e){return zl(n,...e)}function Zm(n,e,t){let r=Object.assign(Object.assign({},Jm()),{[e]:t});return new Rt("auth","Firebase",r).create(e,{appName:n.name})}function Ot(n){return Zm(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zl(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Xm.create(n,...e)}function B(n,e,...t){if(!n)throw zl(e,...t)}function Nt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Bo(e),new Error(e)}function on(n,e){n||Nt(e)}function Al(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function v0(){return Mm()==="http:"||Mm()==="https:"}function Mm(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function _0(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(v0()||fm()||"connection"in navigator)?navigator.onLine:!0}function w0(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var xn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,on(t>e,"Short delay should be less than long delay!"),this.isMobile=dm()||pm()}get(){return _0()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function ql(n,e){on(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Go=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Nt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Nt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Nt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var E0={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var I0=new xn(3e4,6e4);function Mt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function pt(s,o,u,l){return m(this,arguments,function*(n,e,t,r,i={}){return ey(n,i,()=>m(this,null,function*(){let h={},f={};r&&(e==="GET"?f=r:h={body:JSON.stringify(r)});let y=Zi(Object.assign({key:n.config.apiKey},f)).slice(1),w=yield n._getAdditionalHeaders();return w["Content-Type"]="application/json",n.languageCode&&(w["X-Firebase-Locale"]=n.languageCode),Go.fetch()(ty(n,n.config.apiHost,t,y),Object.assign({method:e,headers:w,referrerPolicy:"no-referrer"},h))}))})}function ey(n,e,t){return m(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},E0),e);try{let i=new Dl(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Uo(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let u=s.ok?o.errorMessage:o.error.message,[l,h]=u.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Uo(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Uo(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Uo(n,"user-disabled",o);let f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Zm(n,f,h);ft(n,f)}}catch(i){if(i instanceof Ke)throw i;ft(n,"network-request-failed",{message:String(i)})}})}function ls(s,o,u,l){return m(this,arguments,function*(n,e,t,r,i={}){let h=yield pt(n,e,t,r,i);return"mfaPendingCredential"in h&&ft(n,"multi-factor-auth-required",{_serverResponse:h}),h})}function ty(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?ql(n.config,i):`${n.config.apiScheme}://${i}`}function T0(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Dl=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Fn(this.auth,"network-request-failed")),I0.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Uo(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Fn(n,e,r);return i.customData._tokenResponse=t,i}function Fm(n){return n!==void 0&&n.enterprise!==void 0}var bl=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return T0(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function A0(n,e){return m(this,null,function*(){return pt(n,"GET","/v2/recaptchaConfig",Mt(n,e))})}function D0(n,e){return m(this,null,function*(){return pt(n,"POST","/v1/accounts:delete",e)})}function ny(n,e){return m(this,null,function*(){return pt(n,"POST","/v1/accounts:lookup",e)})}function is(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Gl(n,e=!1){return m(this,null,function*(){let t=pe(n),r=yield t.getIdToken(e),i=Wl(r);B(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:is(El(i.auth_time)),issuedAtTime:is(El(i.iat)),expirationTime:is(El(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function El(n){return Number(n)*1e3}function Wl(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Bo("JWT malformed, contained fewer than 3 sections"),null;try{let i=Zc(t);return i?JSON.parse(i):(Bo("Failed to decode base64 JWT payload"),null)}catch(i){return Bo("Caught error parsing JWT payload as JSON",i?.toString()),null}}function xm(n){let e=Wl(n);return B(e,"internal-error"),B(typeof e.exp<"u","internal-error"),B(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Cr(n,e,t=!1){return m(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Ke&&b0(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function b0({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Sl=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>m(this,null,function*(){yield this.iteration()}),t)}iteration(){return m(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var os=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=is(this.lastLoginAt),this.creationTime=is(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Wo(n){return m(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Cr(n,ny(t,{idToken:r}));B(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?ry(s.providerUserInfo):[],u=S0(n.providerData,o),l=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!u?.length,f=l?h:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new os(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,y)})}function Kl(n){return m(this,null,function*(){let e=pe(n);yield Wo(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function S0(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function ry(n){return n.map(e=>{var{providerId:t}=e,r=Ru(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function C0(n,e){return m(this,null,function*(){let t=yield ey(n,{},()=>m(this,null,function*(){let r=Zi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=ty(n,i,"/v1/token",`key=${s}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Go.fetch()(o,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function R0(n,e){return m(this,null,function*(){return pt(n,"POST","/v2/accounts:revokeToken",Mt(n,e))})}var ss=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){B(e.idToken,"internal-error"),B(typeof e.idToken<"u","internal-error"),B(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xm(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){B(e.length!==0,"internal-error");let t=xm(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return m(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(B(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return m(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield C0(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(B(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(B(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(B(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Nt("not implemented")}};function sn(n,e){B(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Rr=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Ru(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Sl(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new os(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return m(this,null,function*(){let t=yield Cr(this,this.stsTokenManager.getToken(this.auth,e));return B(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Gl(this,e)}reload(){return Kl(this)}_assign(e){this!==e&&(B(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return m(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Wo(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return m(this,null,function*(){if(st(this.auth.app))return Promise.reject(Ot(this.auth));let e=yield this.getIdToken();return yield Cr(this,D0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,u,l,h,f;let y=(r=t.displayName)!==null&&r!==void 0?r:void 0,w=(i=t.email)!==null&&i!==void 0?i:void 0,S=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,N=(o=t.photoURL)!==null&&o!==void 0?o:void 0,O=(u=t.tenantId)!==null&&u!==void 0?u:void 0,C=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,M=(h=t.createdAt)!==null&&h!==void 0?h:void 0,j=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:Y,emailVerified:K,isAnonymous:ve,providerData:ne,stsTokenManager:I}=t;B(Y&&I,e,"internal-error");let g=ss.fromJSON(this.name,I);B(typeof Y=="string",e,"internal-error"),sn(y,e.name),sn(w,e.name),B(typeof K=="boolean",e,"internal-error"),B(typeof ve=="boolean",e,"internal-error"),sn(S,e.name),sn(N,e.name),sn(O,e.name),sn(C,e.name),sn(M,e.name),sn(j,e.name);let _=new n({uid:Y,auth:e,email:w,emailVerified:K,displayName:y,isAnonymous:ve,photoURL:N,phoneNumber:S,tenantId:O,stsTokenManager:g,createdAt:M,lastLoginAt:j});return ne&&Array.isArray(ne)&&(_.providerData=ne.map(E=>Object.assign({},E))),C&&(_._redirectEventId=C),_}static _fromIdTokenResponse(e,t,r=!1){return m(this,null,function*(){let i=new ss;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Wo(s),s})}static _fromGetAccountInfoResponse(e,t,r){return m(this,null,function*(){let i=t.users[0];B(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?ry(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,u=new ss;u.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new os(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,h),l})}};var Lm=new Map;function kt(n){on(n instanceof Function,"Expected a class definition");let e=Lm.get(n);return e?(on(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Lm.set(n,e),e)}var P0=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return m(this,null,function*(){return!0})}_set(t,r){return m(this,null,function*(){this.storage[t]=r})}_get(t){return m(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return m(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Cl=P0;function $o(n,e,t){return`firebase:${n}:${e}:${t}`}var Ko=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=$o(this.userKey,i.apiKey,s),this.fullPersistenceKey=$o("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return m(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Rr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return m(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return m(this,null,function*(){if(!t.length)return new n(kt(Cl),e,r);let i=(yield Promise.all(t.map(h=>m(this,null,function*(){if(yield h._isAvailable())return h})))).filter(h=>h),s=i[0]||kt(Cl),o=$o(r,e.config.apiKey,e.name),u=null;for(let h of t)try{let f=yield h._get(o);if(f){let y=Rr._fromJSON(e,f);h!==s&&(u=y),s=h;break}}catch{}let l=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],u&&(yield s._set(o,u.toJSON())),yield Promise.all(t.map(h=>m(this,null,function*(){if(h!==s)try{yield h._remove(o)}catch{}}))),new n(s,e,r))})}};function Vm(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(oy(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(iy(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uy(e))return"Blackberry";if(cy(e))return"Webos";if(Hl(e))return"Safari";if((e.includes("chrome/")||sy(e))&&!e.includes("edge/"))return"Chrome";if(ay(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function iy(n=Ee()){return/firefox\//i.test(n)}function Hl(n=Ee()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function sy(n=Ee()){return/crios\//i.test(n)}function oy(n=Ee()){return/iemobile/i.test(n)}function ay(n=Ee()){return/android/i.test(n)}function uy(n=Ee()){return/blackberry/i.test(n)}function cy(n=Ee()){return/webos/i.test(n)}function ta(n=Ee()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function N0(n=Ee()){var e;return ta(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function k0(){return gm()&&document.documentMode===10}function ly(n=Ee()){return ta(n)||ay(n)||cy(n)||uy(n)||/windows phone/i.test(n)||oy(n)}function O0(){try{return!!(window&&window!==window.top)}catch{return!1}}function hy(n,e=[]){let t;switch(n){case"Browser":t=Vm(Ee());break;case"Worker":t=`${Vm(Ee())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${rn}/${r}`}var Rl=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,u)=>{try{let l=e(s);o(l)}catch(l){u(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return m(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function M0(t){return m(this,arguments,function*(n,e={}){return pt(n,"GET","/v2/passwordPolicy",Mt(n,e))})}var F0=6,Pl=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:F0,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,u;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(u=l.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Nl=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ho(this),this.idTokenSubscription=new Ho(this),this.beforeStateQueue=new Rl(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=kt(t)),this._initializationPromise=this.queue(()=>m(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Ko.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return m(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return m(this,null,function*(){try{let t=yield ny(this,{idToken:e}),r=yield Rr._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return m(this,null,function*(){var t;if(st(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!o||o===u)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return B(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return m(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return m(this,null,function*(){try{yield Wo(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=w0()}_delete(){return m(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return m(this,null,function*(){if(st(this.app))return Promise.reject(Ot(this));let t=e?pe(e):null;return t&&B(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return m(this,null,function*(){if(!this._deleted)return e&&B(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>m(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return m(this,null,function*(){return st(this.app)?Promise.reject(Ot(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return st(this.app)?Promise.reject(Ot(this)):this.queue(()=>m(this,null,function*(){yield this.assertedPersistence.setPersistence(kt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return m(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return m(this,null,function*(){let e=yield M0(this),t=new Pl(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Rt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return m(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield R0(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return m(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return m(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&kt(e)||this._popupRedirectResolver;B(t,this,"argument-error"),this.redirectPersistenceManager=yield Ko.create(this,[kt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return m(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>m(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return m(this,null,function*(){if(e===this.currentUser)return this.queue(()=>m(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(B(u,this,"internal-error"),u.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{o=!0,l()}}else{let l=e.addObserver(t);return()=>{o=!0,l()}}}directlySetCurrentUser(e){return m(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hy(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return m(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return m(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&y0(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Vn(n){return pe(n)}var Ho=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=_m(t=>this.observer=t)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var na={loadJS(){return m(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function x0(n){na=n}function dy(n){return na.loadJS(n)}function L0(){return na.recaptchaEnterpriseScript}function V0(){return na.gapiScript}function fy(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var U0="recaptcha-enterprise",B0="NO_RECAPTCHA",kl=class{constructor(e){this.type=U0,this.auth=Vn(e)}verify(e="verify",t=!1){return m(this,null,function*(){function r(s){return m(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,u)=>m(this,null,function*(){A0(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let h=new bl(l);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(l=>{u(l)})}))})}function i(s,o,u){let l=window.grecaptcha;Fm(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(B0)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(u=>{if(!t&&Fm(window.grecaptcha))i(u,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=L0();l.length!==0&&(l+=u),dy(l).then(()=>{i(u,s,o)}).catch(h=>{o(h)})}}).catch(u=>{o(u)})})})}};function Um(n,e,t,r=!1){return m(this,null,function*(){let i=new kl(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Ol(n,e,t,r){return m(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield Um(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>m(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield Um(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function Ql(n,e){let t=ns(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(Rn(s,e??{}))return i;ft(i,"already-initialized")}return t.initialize({options:e})}function $0(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(kt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Yl(n,e,t){let r=Vn(n);B(r._canInitEmulator,r,"emulator-config-failed"),B(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=py(e),{host:o,port:u}=j0(e),l=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||z0()}function py(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function j0(n){let e=py(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Bm(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:Bm(o)}}}function Bm(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function z0(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var as=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Nt("not implemented")}_getIdTokenResponse(e){return Nt("not implemented")}_linkToIdToken(e,t){return Nt("not implemented")}_getReauthenticationResolver(e){return Nt("not implemented")}};function q0(n,e){return m(this,null,function*(){return pt(n,"POST","/v1/accounts:signUp",e)})}function G0(n,e){return m(this,null,function*(){return ls(n,"POST","/v1/accounts:signInWithPassword",Mt(n,e))})}function W0(n,e){return m(this,null,function*(){return pt(n,"POST","/v1/accounts:sendOobCode",Mt(n,e))})}function K0(n,e){return m(this,null,function*(){return W0(n,e)})}function H0(n,e){return m(this,null,function*(){return ls(n,"POST","/v1/accounts:signInWithEmailLink",Mt(n,e))})}function Q0(n,e){return m(this,null,function*(){return ls(n,"POST","/v1/accounts:signInWithEmailLink",Mt(n,e))})}var us=class n extends as{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return m(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ol(e,t,"signInWithPassword",G0);case"emailLink":return H0(e,{email:this._email,oobCode:this._password});default:ft(e,"internal-error")}})}_linkToIdToken(e,t){return m(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ol(e,r,"signUpPassword",q0);case"emailLink":return Q0(e,{idToken:t,email:this._email,oobCode:this._password});default:ft(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Il(n,e){return m(this,null,function*(){return ls(n,"POST","/v1/accounts:signInWithIdp",Mt(n,e))})}function Y0(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function J0(n){let e=Ir(Tr(n)).link,t=e?Ir(Tr(e)).deep_link_id:null,r=Ir(Tr(n)).deep_link_id;return(r?Ir(Tr(r)).link:null)||r||t||e||n}var Qo=class n{constructor(e){var t,r,i,s,o,u;let l=Ir(Tr(e)),h=(t=l.apiKey)!==null&&t!==void 0?t:null,f=(r=l.oobCode)!==null&&r!==void 0?r:null,y=Y0((i=l.mode)!==null&&i!==void 0?i:null);B(h&&f&&y,"argument-error"),this.apiKey=h,this.operation=y,this.code=f,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(u=l.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=J0(e);try{return new n(t)}catch{return null}}};var gy=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return us._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Qo.parseLink(r);return B(i,"argument-error"),us._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Yo=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Ml=class extends Yo{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function X0(n,e){return m(this,null,function*(){return ls(n,"POST","/v1/accounts:signUp",Mt(n,e))})}var Pr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return m(this,null,function*(){let s=yield Rr._fromIdTokenResponse(e,r,i),o=$m(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return m(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=$m(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function $m(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Fl=class n extends Ke{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function my(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Fl._fromErrorAndOperation(n,s,e,r):s})}function Z0(n,e,t=!1){return m(this,null,function*(){let r=yield Cr(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Pr._forOperation(n,"link",r)})}function eA(n,e,t=!1){return m(this,null,function*(){let{auth:r}=n;if(st(r.app))return Promise.reject(Ot(r));let i="reauthenticate";try{let s=yield Cr(n,my(r,i,e,n),t);B(s.idToken,r,"internal-error");let o=Wl(s.idToken);B(o,r,"internal-error");let{sub:u}=o;return B(n.uid===u,r,"user-mismatch"),Pr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&ft(r,"user-mismatch"),s}})}function yy(n,e,t=!1){return m(this,null,function*(){if(st(n.app))return Promise.reject(Ot(n));let r="signIn",i=yield my(n,r,e),s=yield Pr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Jl(n,e){return m(this,null,function*(){return yy(Vn(n),e)})}function tA(n,e,t){var r;B(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),B(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(B(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(B(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function vy(n){return m(this,null,function*(){let e=Vn(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function Xl(n,e,t){return m(this,null,function*(){if(st(n.app))return Promise.reject(Ot(n));let r=Vn(n),o=yield Ol(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",X0).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&vy(n),l}),u=yield Pr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(u.user),u})}function Zl(n,e,t){return st(n.app)?Promise.reject(Ot(n)):Jl(pe(n),gy.credential(e,t)).catch(r=>m(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&vy(n),r}))}function eh(n,e){return m(this,null,function*(){let t=pe(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&tA(t.auth,i,e);let{email:s}=yield K0(t.auth,i);s!==n.email&&(yield n.reload())})}function nA(n,e){return m(this,null,function*(){return pt(n,"POST","/v1/accounts:update",e)})}function th(r,i){return m(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=pe(n),u={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=yield Cr(s,nA(s.auth,u));s.displayName=l.displayName||null,s.photoURL=l.photoUrl||null;let h=s.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=s.displayName,h.photoURL=s.photoURL),yield s._updateTokensIfNecessary(l)})}function nh(n,e,t,r){return pe(n).onIdTokenChanged(e,t,r)}function rh(n,e,t){return pe(n).beforeAuthStateChanged(e,t)}var Jo="__sak";var Xo=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jo,"1"),this.storage.removeItem(Jo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function rA(){let n=Ee();return Hl(n)||ta(n)}var iA=1e3,sA=10,oA=(()=>{class n extends Xo{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=rA()&&O0(),this.fallbackToPolling=ly(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,l,h)=>{this.notifyListeners(u,h)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let u=this.storage.getItem(i);if(t.newValue!==u)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},o=this.storage.getItem(i);k0()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,sA):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},iA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return m(this,null,function*(){yield Gt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return m(this,null,function*(){let r=yield Gt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return m(this,null,function*(){yield Gt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),_y=oA;var aA=(()=>{class n extends Xo{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),ih=aA;function uA(n){return Promise.all(n.map(e=>m(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var cA=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return m(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,u=this.handlersMap[s];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(u).map(f=>m(this,null,function*(){return f(r.origin,o)})),h=yield uA(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:h})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function wy(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var xl=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return m(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((u,l)=>{let h=wy("",20);i.port1.start();let f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(y){let w=y;if(w.data.eventId===h)switch(w.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(w.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function dt(){return window}function lA(n){dt().location.href=n}function Ey(){return typeof dt().WorkerGlobalScope<"u"&&typeof dt().importScripts=="function"}function hA(){return m(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function dA(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function fA(){return Ey()?self:null}var Iy="firebaseLocalStorageDb",pA=1,Zo="firebaseLocalStorage",Ty="fbase_key",Ln=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function ra(n,e){return n.transaction([Zo],e?"readwrite":"readonly").objectStore(Zo)}function gA(){let n=indexedDB.deleteDatabase(Iy);return new Ln(n).toPromise()}function Ll(){let n=indexedDB.open(Iy,pA);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Zo,{keyPath:Ty})}catch(i){t(i)}}),n.addEventListener("success",()=>m(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Zo)?e(r):(r.close(),yield gA(),e(yield Ll()))}))})}function jm(n,e,t){return m(this,null,function*(){let r=ra(n,!0).put({[Ty]:e,value:t});return new Ln(r).toPromise()})}function mA(n,e){return m(this,null,function*(){let t=ra(n,!1).get(e),r=yield new Ln(t).toPromise();return r===void 0?null:r.value})}function zm(n,e){let t=ra(n,!0).delete(e);return new Ln(t).toPromise()}var yA=800,vA=3,_A=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return m(this,null,function*(){return this.db?this.db:(this.db=yield Ll(),this.db)})}_withRetries(t){return m(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>vA)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return m(this,null,function*(){return Ey()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return m(this,null,function*(){this.receiver=cA._getInstance(fA()),this.receiver._subscribe("keyChanged",(t,r)=>m(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>m(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return m(this,null,function*(){var t,r;if(this.activeServiceWorker=yield hA(),!this.activeServiceWorker)return;this.sender=new xl(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return m(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||dA()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return m(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Ll();return yield jm(t,Jo,"1"),yield zm(t,Jo),!0}catch{}return!1})}_withPendingWrite(t){return m(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return m(this,null,function*(){return this._withPendingWrite(()=>m(this,null,function*(){return yield this._withRetries(i=>jm(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return m(this,null,function*(){let r=yield this._withRetries(i=>mA(i,t));return this.localCache[t]=r,r})}_remove(t){return m(this,null,function*(){return this._withPendingWrite(()=>m(this,null,function*(){return yield this._withRetries(r=>zm(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return m(this,null,function*(){let t=yield this._withRetries(s=>{let o=ra(s,!1).getAll();return new Ln(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>m(this,null,function*(){return this._poll()}),yA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Ay=_A;var WP=fy("rcb"),KP=new xn(3e4,6e4);function wA(n,e){return e?kt(e):(B(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var cs=class extends as{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Il(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Il(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Il(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function EA(n){return yy(n.auth,new cs(n),n.bypassAuthState)}function IA(n){let{auth:e,user:t}=n;return B(t,e,"internal-error"),eA(t,new cs(n),n.bypassAuthState)}function TA(n){return m(this,null,function*(){let{auth:e,user:t}=n;return B(t,e,"internal-error"),Z0(t,new cs(n),n.bypassAuthState)})}var Vl=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>m(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return m(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:u}=e;if(o){this.reject(o);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(l))}catch(h){this.reject(h)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return EA;case"linkViaPopup":case"linkViaRedirect":return TA;case"reauthViaPopup":case"reauthViaRedirect":return IA;default:ft(this.auth,"internal-error")}}resolve(e){on(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){on(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var HP=new xn(2e3,1e4);var AA="pendingRedirect",jo=new Map,Ul=class n extends Vl{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return m(this,null,function*(){let e=jo.get(this.auth._key());if(!e){try{let r=(yield DA(this.resolver,this.auth))?yield Gt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}jo.set(this.auth._key(),e)}return this.bypassAuthState||jo.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return m(this,null,function*(){if(e.type==="signInViaRedirect")return Gt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Gt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return m(this,null,function*(){})}cleanUp(){}};function DA(n,e){return m(this,null,function*(){let t=CA(e),r=SA(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function bA(n,e){jo.set(n._key(),e)}function SA(n){return kt(n._redirectPersistence)}function CA(n){return $o(AA,n.config.apiKey,n.name)}function RA(n,e,t=!1){return m(this,null,function*(){if(st(n.app))return Promise.reject(Ot(n));let r=Vn(n),i=wA(r,e),o=yield new Ul(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var PA=10*60*1e3,Bl=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!NA(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Dy(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Fn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=PA&&this.cachedEventUids.clear(),this.cachedEventUids.has(qm(e))}saveEventToCache(e){this.cachedEventUids.add(qm(e)),this.lastProcessedEventTime=Date.now()}};function qm(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Dy({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function NA(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Dy(n);default:return!1}}function kA(t){return m(this,arguments,function*(n,e={}){return pt(n,"GET","/v1/projects",e)})}var OA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MA=/^https?/;function FA(n){return m(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield kA(n);for(let t of e)try{if(xA(t))return}catch{}ft(n,"unauthorized-domain")})}function xA(n){let e=Al(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!MA.test(t))return!1;if(OA.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var LA=new xn(3e4,6e4);function Gm(){let n=dt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function VA(n){return new Promise((e,t)=>{var r,i,s;function o(){Gm(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Gm(),t(Fn(n,"network-request-failed"))},timeout:LA.get()})}if(!((i=(r=dt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=dt().gapi)===null||s===void 0)&&s.load)o();else{let u=fy("iframefcb");return dt()[u]=()=>{gapi.load?o():t(Fn(n,"network-request-failed"))},dy(`${V0()}?onload=${u}`).catch(l=>t(l))}}).catch(e=>{throw zo=null,e})}var zo=null;function UA(n){return zo=zo||VA(n),zo}var BA=new xn(5e3,15e3),$A="__/auth/iframe",jA="emulator/auth/iframe",zA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function GA(n){let e=n.config;B(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?ql(e,jA):`https://${n.config.authDomain}/${$A}`,r={apiKey:e.apiKey,appName:n.name,v:rn},i=qA.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Zi(r).slice(1)}`}function WA(n){return m(this,null,function*(){let e=yield UA(n),t=dt().gapi;return B(t,n,"internal-error"),e.open({where:document.body,url:GA(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zA,dontclear:!0},r=>new Promise((i,s)=>m(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=Fn(n,"network-request-failed"),u=dt().setTimeout(()=>{s(o)},BA.get());function l(){dt().clearTimeout(u),i(r)}r.ping(l).then(l,()=>{s(o)})})))})}var KA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},HA=500,QA=600,YA="_blank",JA="http://localhost",ea=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function XA(n,e,t,r=HA,i=QA){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",l=Object.assign(Object.assign({},KA),{width:r.toString(),height:i.toString(),top:s,left:o}),h=Ee().toLowerCase();t&&(u=sy(h)?YA:t),iy(h)&&(e=e||JA,l.scrollbars="yes");let f=Object.entries(l).reduce((w,[S,N])=>`${w}${S}=${N},`,"");if(N0(h)&&u!=="_self")return ZA(e||"",u),new ea(null);let y=window.open(e||"",u,f);B(y,n,"popup-blocked");try{y.focus()}catch{}return new ea(y)}function ZA(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var eD="__/auth/handler",tD="emulator/auth/handler",nD=encodeURIComponent("fac");function Wm(n,e,t,r,i,s){return m(this,null,function*(){B(n.config.authDomain,n,"auth-domain-config-required"),B(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:rn,eventId:i};if(e instanceof Yo){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",vm(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,y]of Object.entries(s||{}))o[f]=y}if(e instanceof Ml){let f=e.getScopes().filter(y=>y!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);let u=o;for(let f of Object.keys(u))u[f]===void 0&&delete u[f];let l=yield n._getAppCheckToken(),h=l?`#${nD}=${encodeURIComponent(l)}`:"";return`${rD(n)}?${Zi(u).slice(1)}${h}`})}function rD({config:n}){return n.emulator?ql(n,tD):`https://${n.authDomain}/${eD}`}var Tl="webStorageSupport",$l=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ih,this._completeRedirectFn=RA,this._overrideRedirectResult=bA}_openPopup(e,t,r,i){return m(this,null,function*(){var s;on((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield Wm(e,t,r,Al(),i);return XA(e,o,wy())})}_openRedirect(e,t,r,i){return m(this,null,function*(){yield this._originValidation(e);let s=yield Wm(e,t,r,Al(),i);return lA(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(on(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return m(this,null,function*(){let t=yield WA(e),r=new Bl(e);return t.register("authEvent",i=>(B(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Tl,{type:Tl},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[Tl];o!==void 0&&t(!!o),ft(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=FA(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ly()||Hl()||ta()}},by=$l;var Km="@firebase/auth",Hm="1.7.4";var jl=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return m(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function iD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function sD(n){nn(new et("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=r.options;B(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:o,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hy(n)},h=new Nl(r,i,s,l);return $0(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),nn(new et("auth-internal",e=>{let t=Vn(e.getProvider("auth").getImmediate());return(r=>new jl(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ie(Km,Hm,iD(n)),Ie(Km,Hm,"esm2017")}var oD=5*60,aD=nl("authIdTokenMaxAge")||oD,Qm=null,uD=n=>e=>m(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>aD)return;let i=t?.token;Qm!==i&&(Qm=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function sh(n=Ar()){let e=ns(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Ql(n,{popupRedirectResolver:by,persistence:[Ay,_y,ih]}),r=nl("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=uD(s.toString());rh(t,o,()=>o(t.currentUser)),nh(t,u=>o(u))}}let i=el("auth");return i&&Yl(t,`http://${i}`),t}function cD(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}x0({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Fn("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",cD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});sD("Browser");var Sy="auth",Un=class{constructor(e){return e}},hs=class{constructor(){return rs(Sy)}};var oh=new se("angularfire2.auth-instances");function XD(n,e){let t=Lo(Sy,n,e);return t&&new Un(t)}function ZD(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Un(r)}}var eb={provide:hs,deps:[[new Ue,oh]]},tb={provide:Un,useFactory:XD,deps:[[new Ue,oh],Pt]},nb=(()=>{class n{constructor(){Ie("angularfire",On.full,"auth")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=it({type:n});static \u0275inj=rt({providers:[tb,eb]})}return n})();function NN(n,...e){return{ngModule:nb,providers:[{provide:oh,useFactory:ZD(n),multi:!0,deps:[we,St,Sr,Mn,[new Ue,br],...e]}]}}var ah=Ae(Xl,!0);var kN=Ae(sh,!0);var Cy=Ae(eh,!0);var ia=Ae(Zl,!0);var uh=Ae(th,!0);var Ry=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Py={};var an,ch;(function(){var n;function e(I,g){function _(){}_.prototype=g.prototype,I.D=g.prototype,I.prototype=new _,I.prototype.constructor=I,I.C=function(E,T,D){for(var v=Array(arguments.length-2),It=2;It<arguments.length;It++)v[It-2]=arguments[It];return g.prototype[T].apply(E,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,g,_){_||(_=0);var E=Array(16);if(typeof g=="string")for(var T=0;16>T;++T)E[T]=g.charCodeAt(_++)|g.charCodeAt(_++)<<8|g.charCodeAt(_++)<<16|g.charCodeAt(_++)<<24;else for(T=0;16>T;++T)E[T]=g[_++]|g[_++]<<8|g[_++]<<16|g[_++]<<24;g=I.g[0],_=I.g[1],T=I.g[2];var D=I.g[3],v=g+(D^_&(T^D))+E[0]+3614090360&4294967295;g=_+(v<<7&4294967295|v>>>25),v=D+(T^g&(_^T))+E[1]+3905402710&4294967295,D=g+(v<<12&4294967295|v>>>20),v=T+(_^D&(g^_))+E[2]+606105819&4294967295,T=D+(v<<17&4294967295|v>>>15),v=_+(g^T&(D^g))+E[3]+3250441966&4294967295,_=T+(v<<22&4294967295|v>>>10),v=g+(D^_&(T^D))+E[4]+4118548399&4294967295,g=_+(v<<7&4294967295|v>>>25),v=D+(T^g&(_^T))+E[5]+1200080426&4294967295,D=g+(v<<12&4294967295|v>>>20),v=T+(_^D&(g^_))+E[6]+2821735955&4294967295,T=D+(v<<17&4294967295|v>>>15),v=_+(g^T&(D^g))+E[7]+4249261313&4294967295,_=T+(v<<22&4294967295|v>>>10),v=g+(D^_&(T^D))+E[8]+1770035416&4294967295,g=_+(v<<7&4294967295|v>>>25),v=D+(T^g&(_^T))+E[9]+2336552879&4294967295,D=g+(v<<12&4294967295|v>>>20),v=T+(_^D&(g^_))+E[10]+4294925233&4294967295,T=D+(v<<17&4294967295|v>>>15),v=_+(g^T&(D^g))+E[11]+2304563134&4294967295,_=T+(v<<22&4294967295|v>>>10),v=g+(D^_&(T^D))+E[12]+1804603682&4294967295,g=_+(v<<7&4294967295|v>>>25),v=D+(T^g&(_^T))+E[13]+4254626195&4294967295,D=g+(v<<12&4294967295|v>>>20),v=T+(_^D&(g^_))+E[14]+2792965006&4294967295,T=D+(v<<17&4294967295|v>>>15),v=_+(g^T&(D^g))+E[15]+1236535329&4294967295,_=T+(v<<22&4294967295|v>>>10),v=g+(T^D&(_^T))+E[1]+4129170786&4294967295,g=_+(v<<5&4294967295|v>>>27),v=D+(_^T&(g^_))+E[6]+3225465664&4294967295,D=g+(v<<9&4294967295|v>>>23),v=T+(g^_&(D^g))+E[11]+643717713&4294967295,T=D+(v<<14&4294967295|v>>>18),v=_+(D^g&(T^D))+E[0]+3921069994&4294967295,_=T+(v<<20&4294967295|v>>>12),v=g+(T^D&(_^T))+E[5]+3593408605&4294967295,g=_+(v<<5&4294967295|v>>>27),v=D+(_^T&(g^_))+E[10]+38016083&4294967295,D=g+(v<<9&4294967295|v>>>23),v=T+(g^_&(D^g))+E[15]+3634488961&4294967295,T=D+(v<<14&4294967295|v>>>18),v=_+(D^g&(T^D))+E[4]+3889429448&4294967295,_=T+(v<<20&4294967295|v>>>12),v=g+(T^D&(_^T))+E[9]+568446438&4294967295,g=_+(v<<5&4294967295|v>>>27),v=D+(_^T&(g^_))+E[14]+3275163606&4294967295,D=g+(v<<9&4294967295|v>>>23),v=T+(g^_&(D^g))+E[3]+4107603335&4294967295,T=D+(v<<14&4294967295|v>>>18),v=_+(D^g&(T^D))+E[8]+1163531501&4294967295,_=T+(v<<20&4294967295|v>>>12),v=g+(T^D&(_^T))+E[13]+2850285829&4294967295,g=_+(v<<5&4294967295|v>>>27),v=D+(_^T&(g^_))+E[2]+4243563512&4294967295,D=g+(v<<9&4294967295|v>>>23),v=T+(g^_&(D^g))+E[7]+1735328473&4294967295,T=D+(v<<14&4294967295|v>>>18),v=_+(D^g&(T^D))+E[12]+2368359562&4294967295,_=T+(v<<20&4294967295|v>>>12),v=g+(_^T^D)+E[5]+4294588738&4294967295,g=_+(v<<4&4294967295|v>>>28),v=D+(g^_^T)+E[8]+2272392833&4294967295,D=g+(v<<11&4294967295|v>>>21),v=T+(D^g^_)+E[11]+1839030562&4294967295,T=D+(v<<16&4294967295|v>>>16),v=_+(T^D^g)+E[14]+4259657740&4294967295,_=T+(v<<23&4294967295|v>>>9),v=g+(_^T^D)+E[1]+2763975236&4294967295,g=_+(v<<4&4294967295|v>>>28),v=D+(g^_^T)+E[4]+1272893353&4294967295,D=g+(v<<11&4294967295|v>>>21),v=T+(D^g^_)+E[7]+4139469664&4294967295,T=D+(v<<16&4294967295|v>>>16),v=_+(T^D^g)+E[10]+3200236656&4294967295,_=T+(v<<23&4294967295|v>>>9),v=g+(_^T^D)+E[13]+681279174&4294967295,g=_+(v<<4&4294967295|v>>>28),v=D+(g^_^T)+E[0]+3936430074&4294967295,D=g+(v<<11&4294967295|v>>>21),v=T+(D^g^_)+E[3]+3572445317&4294967295,T=D+(v<<16&4294967295|v>>>16),v=_+(T^D^g)+E[6]+76029189&4294967295,_=T+(v<<23&4294967295|v>>>9),v=g+(_^T^D)+E[9]+3654602809&4294967295,g=_+(v<<4&4294967295|v>>>28),v=D+(g^_^T)+E[12]+3873151461&4294967295,D=g+(v<<11&4294967295|v>>>21),v=T+(D^g^_)+E[15]+530742520&4294967295,T=D+(v<<16&4294967295|v>>>16),v=_+(T^D^g)+E[2]+3299628645&4294967295,_=T+(v<<23&4294967295|v>>>9),v=g+(T^(_|~D))+E[0]+4096336452&4294967295,g=_+(v<<6&4294967295|v>>>26),v=D+(_^(g|~T))+E[7]+1126891415&4294967295,D=g+(v<<10&4294967295|v>>>22),v=T+(g^(D|~_))+E[14]+2878612391&4294967295,T=D+(v<<15&4294967295|v>>>17),v=_+(D^(T|~g))+E[5]+4237533241&4294967295,_=T+(v<<21&4294967295|v>>>11),v=g+(T^(_|~D))+E[12]+1700485571&4294967295,g=_+(v<<6&4294967295|v>>>26),v=D+(_^(g|~T))+E[3]+2399980690&4294967295,D=g+(v<<10&4294967295|v>>>22),v=T+(g^(D|~_))+E[10]+4293915773&4294967295,T=D+(v<<15&4294967295|v>>>17),v=_+(D^(T|~g))+E[1]+2240044497&4294967295,_=T+(v<<21&4294967295|v>>>11),v=g+(T^(_|~D))+E[8]+1873313359&4294967295,g=_+(v<<6&4294967295|v>>>26),v=D+(_^(g|~T))+E[15]+4264355552&4294967295,D=g+(v<<10&4294967295|v>>>22),v=T+(g^(D|~_))+E[6]+2734768916&4294967295,T=D+(v<<15&4294967295|v>>>17),v=_+(D^(T|~g))+E[13]+1309151649&4294967295,_=T+(v<<21&4294967295|v>>>11),v=g+(T^(_|~D))+E[4]+4149444226&4294967295,g=_+(v<<6&4294967295|v>>>26),v=D+(_^(g|~T))+E[11]+3174756917&4294967295,D=g+(v<<10&4294967295|v>>>22),v=T+(g^(D|~_))+E[2]+718787259&4294967295,T=D+(v<<15&4294967295|v>>>17),v=_+(D^(T|~g))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+g&4294967295,I.g[1]=I.g[1]+(T+(v<<21&4294967295|v>>>11))&4294967295,I.g[2]=I.g[2]+T&4294967295,I.g[3]=I.g[3]+D&4294967295}r.prototype.u=function(I,g){g===void 0&&(g=I.length);for(var _=g-this.blockSize,E=this.B,T=this.h,D=0;D<g;){if(T==0)for(;D<=_;)i(this,I,D),D+=this.blockSize;if(typeof I=="string"){for(;D<g;)if(E[T++]=I.charCodeAt(D++),T==this.blockSize){i(this,E),T=0;break}}else for(;D<g;)if(E[T++]=I[D++],T==this.blockSize){i(this,E),T=0;break}}this.h=T,this.o+=g},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var g=1;g<I.length-8;++g)I[g]=0;var _=8*this.o;for(g=I.length-8;g<I.length;++g)I[g]=_&255,_/=256;for(this.u(I),I=Array(16),g=_=0;4>g;++g)for(var E=0;32>E;E+=8)I[_++]=this.g[g]>>>E&255;return I};function s(I,g){var _=u;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=g(I)}function o(I,g){this.h=g;for(var _=[],E=!0,T=I.length-1;0<=T;T--){var D=I[T]|0;E&&D==g||(_[T]=D,E=!1)}this.g=_}var u={};function l(I){return-128<=I&&128>I?s(I,function(g){return new o([g|0],0>g?-1:0)}):new o([I|0],0>I?-1:0)}function h(I){if(isNaN(I)||!isFinite(I))return y;if(0>I)return C(h(-I));for(var g=[],_=1,E=0;I>=_;E++)g[E]=I/_|0,_*=4294967296;return new o(g,0)}function f(I,g){if(I.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(I.charAt(0)=="-")return C(f(I.substring(1),g));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=h(Math.pow(g,8)),E=y,T=0;T<I.length;T+=8){var D=Math.min(8,I.length-T),v=parseInt(I.substring(T,T+D),g);8>D?(D=h(Math.pow(g,D)),E=E.j(D).add(h(v))):(E=E.j(_),E=E.add(h(v)))}return E}var y=l(0),w=l(1),S=l(16777216);n=o.prototype,n.m=function(){if(O(this))return-C(this).m();for(var I=0,g=1,_=0;_<this.g.length;_++){var E=this.i(_);I+=(0<=E?E:4294967296+E)*g,g*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(N(this))return"0";if(O(this))return"-"+C(this).toString(I);for(var g=h(Math.pow(I,6)),_=this,E="";;){var T=K(_,g).g;_=M(_,T.j(g));var D=((0<_.g.length?_.g[0]:_.h)>>>0).toString(I);if(_=T,N(_))return D+E;for(;6>D.length;)D="0"+D;E=D+E}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function N(I){if(I.h!=0)return!1;for(var g=0;g<I.g.length;g++)if(I.g[g]!=0)return!1;return!0}function O(I){return I.h==-1}n.l=function(I){return I=M(this,I),O(I)?-1:N(I)?0:1};function C(I){for(var g=I.g.length,_=[],E=0;E<g;E++)_[E]=~I.g[E];return new o(_,~I.h).add(w)}n.abs=function(){return O(this)?C(this):this},n.add=function(I){for(var g=Math.max(this.g.length,I.g.length),_=[],E=0,T=0;T<=g;T++){var D=E+(this.i(T)&65535)+(I.i(T)&65535),v=(D>>>16)+(this.i(T)>>>16)+(I.i(T)>>>16);E=v>>>16,D&=65535,v&=65535,_[T]=v<<16|D}return new o(_,_[_.length-1]&-2147483648?-1:0)};function M(I,g){return I.add(C(g))}n.j=function(I){if(N(this)||N(I))return y;if(O(this))return O(I)?C(this).j(C(I)):C(C(this).j(I));if(O(I))return C(this.j(C(I)));if(0>this.l(S)&&0>I.l(S))return h(this.m()*I.m());for(var g=this.g.length+I.g.length,_=[],E=0;E<2*g;E++)_[E]=0;for(E=0;E<this.g.length;E++)for(var T=0;T<I.g.length;T++){var D=this.i(E)>>>16,v=this.i(E)&65535,It=I.i(T)>>>16,ei=I.i(T)&65535;_[2*E+2*T]+=v*ei,j(_,2*E+2*T),_[2*E+2*T+1]+=D*ei,j(_,2*E+2*T+1),_[2*E+2*T+1]+=v*It,j(_,2*E+2*T+1),_[2*E+2*T+2]+=D*It,j(_,2*E+2*T+2)}for(E=0;E<g;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=g;E<2*g;E++)_[E]=0;return new o(_,0)};function j(I,g){for(;(I[g]&65535)!=I[g];)I[g+1]+=I[g]>>>16,I[g]&=65535,g++}function Y(I,g){this.g=I,this.h=g}function K(I,g){if(N(g))throw Error("division by zero");if(N(I))return new Y(y,y);if(O(I))return g=K(C(I),g),new Y(C(g.g),C(g.h));if(O(g))return g=K(I,C(g)),new Y(C(g.g),g.h);if(30<I.g.length){if(O(I)||O(g))throw Error("slowDivide_ only works with positive integers.");for(var _=w,E=g;0>=E.l(I);)_=ve(_),E=ve(E);var T=ne(_,1),D=ne(E,1);for(E=ne(E,2),_=ne(_,2);!N(E);){var v=D.add(E);0>=v.l(I)&&(T=T.add(_),D=v),E=ne(E,1),_=ne(_,1)}return g=M(I,T.j(g)),new Y(T,g)}for(T=y;0<=I.l(g);){for(_=Math.max(1,Math.floor(I.m()/g.m())),E=Math.ceil(Math.log(_)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),D=h(_),v=D.j(g);O(v)||0<v.l(I);)_-=E,D=h(_),v=D.j(g);N(D)&&(D=w),T=T.add(D),I=M(I,v)}return new Y(T,I)}n.A=function(I){return K(this,I).h},n.and=function(I){for(var g=Math.max(this.g.length,I.g.length),_=[],E=0;E<g;E++)_[E]=this.i(E)&I.i(E);return new o(_,this.h&I.h)},n.or=function(I){for(var g=Math.max(this.g.length,I.g.length),_=[],E=0;E<g;E++)_[E]=this.i(E)|I.i(E);return new o(_,this.h|I.h)},n.xor=function(I){for(var g=Math.max(this.g.length,I.g.length),_=[],E=0;E<g;E++)_[E]=this.i(E)^I.i(E);return new o(_,this.h^I.h)};function ve(I){for(var g=I.g.length+1,_=[],E=0;E<g;E++)_[E]=I.i(E)<<1|I.i(E-1)>>>31;return new o(_,I.h)}function ne(I,g){var _=g>>5;g%=32;for(var E=I.g.length-_,T=[],D=0;D<E;D++)T[D]=0<g?I.i(D+_)>>>g|I.i(D+_+1)<<32-g:I.i(D+_);return new o(T,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,ch=Py.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,an=Py.Integer=o}).apply(typeof Ry<"u"?Ry:typeof self<"u"?self:typeof window<"u"?window:{});var sa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ft={};var lh,hh,Nr,dh,ds,oa,fh,ph,gh;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,c,d){return a==Array.prototype||a==Object.prototype||(a[c]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof sa=="object"&&sa];for(var c=0;c<a.length;++c){var d=a[c];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(a,c){if(c)e:{var d=r;a=a.split(".");for(var p=0;p<a.length-1;p++){var A=a[p];if(!(A in d))break e;d=d[A]}a=a[a.length-1],p=d[a],c=c(p),c!=p&&c!=null&&e(d,a,{configurable:!0,writable:!0,value:c})}}function s(a,c){a instanceof String&&(a+="");var d=0,p=!1,A={next:function(){if(!p&&d<a.length){var b=d++;return{value:c(b,a[b]),done:!1}}return p=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(a){return a||function(){return s(this,function(c,d){return d})}});var o=o||{},u=this||self;function l(a){var c=typeof a;return c=c!="object"?c:a?Array.isArray(a)?"array":c:"null",c=="array"||c=="object"&&typeof a.length=="number"}function h(a){var c=typeof a;return c=="object"&&a!=null||c=="function"}function f(a,c,d){return a.call.apply(a.bind,arguments)}function y(a,c,d){if(!a)throw Error();if(2<arguments.length){var p=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,p),a.apply(c,A)}}return function(){return a.apply(c,arguments)}}function w(a,c,d){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:y,w.apply(null,arguments)}function S(a,c){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),a.apply(this,p)}}function N(a,c){function d(){}d.prototype=c.prototype,a.aa=c.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(p,A,b){for(var k=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)k[oe-2]=arguments[oe];return c.prototype[A].apply(p,k)}}function O(a){let c=a.length;if(0<c){let d=Array(c);for(let p=0;p<c;p++)d[p]=a[p];return d}return[]}function C(a,c){for(let d=1;d<arguments.length;d++){let p=arguments[d];if(l(p)){let A=a.length||0,b=p.length||0;a.length=A+b;for(let k=0;k<b;k++)a[A+k]=p[k]}else a.push(p)}}class M{constructor(c,d){this.i=c,this.j=d,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function j(a){return/^[\s\xa0]*$/.test(a)}function Y(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function K(a){return K[" "](a),a}K[" "]=function(){};var ve=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function ne(a,c,d){for(let p in a)c.call(d,a[p],p,a)}function I(a,c){for(let d in a)c.call(void 0,a[d],d,a)}function g(a){let c={};for(let d in a)c[d]=a[d];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(a,c){let d,p;for(let A=1;A<arguments.length;A++){p=arguments[A];for(d in p)a[d]=p[d];for(let b=0;b<_.length;b++)d=_[b],Object.prototype.hasOwnProperty.call(p,d)&&(a[d]=p[d])}}function T(a){var c=1;a=a.split(":");let d=[];for(;0<c&&a.length;)d.push(a.shift()),c--;return a.length&&d.push(a.join(":")),d}function D(a){u.setTimeout(()=>{throw a},0)}function v(){var a=tu;let c=null;return a.g&&(c=a.g,a.g=a.g.next,a.g||(a.h=null),c.next=null),c}class It{constructor(){this.h=this.g=null}add(c,d){let p=ei.get();p.set(c,d),this.h?this.h.next=p:this.g=p,this.h=p}}var ei=new M(()=>new S_,a=>a.reset());class S_{constructor(){this.next=this.g=this.h=null}set(c,d){this.h=c,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let ti,ni=!1,tu=new It,bf=()=>{let a=u.Promise.resolve(void 0);ti=()=>{a.then(C_)}};var C_=()=>{for(var a;a=v();){try{a.h.call(a.g)}catch(d){D(d)}var c=ei;c.j(a),100>c.h&&(c.h++,a.next=c.g,c.g=a)}ni=!1};function $t(){this.s=this.s,this.C=this.C}$t.prototype.s=!1,$t.prototype.ma=function(){this.s||(this.s=!0,this.N())},$t.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Re(a,c){this.type=a,this.g=this.target=c,this.defaultPrevented=!1}Re.prototype.h=function(){this.defaultPrevented=!0};var R_=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,c=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};u.addEventListener("test",d,c),u.removeEventListener("test",d,c)}catch{}return a}();function ri(a,c){if(Re.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,p=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=c,c=a.relatedTarget){if(ve){e:{try{K(c.nodeName);var A=!0;break e}catch{}A=!1}A||(c=null)}}else d=="mouseover"?c=a.fromElement:d=="mouseout"&&(c=a.toElement);this.relatedTarget=c,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:P_[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ri.aa.h.call(this)}}N(ri,Re);var P_={2:"touch",3:"pen",4:"mouse"};ri.prototype.h=function(){ri.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var ii="closure_listenable_"+(1e6*Math.random()|0),N_=0;function k_(a,c,d,p,A){this.listener=a,this.proxy=null,this.src=c,this.type=d,this.capture=!!p,this.ha=A,this.key=++N_,this.da=this.fa=!1}function xs(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Ls(a){this.src=a,this.g={},this.h=0}Ls.prototype.add=function(a,c,d,p,A){var b=a.toString();a=this.g[b],a||(a=this.g[b]=[],this.h++);var k=ru(a,c,p,A);return-1<k?(c=a[k],d||(c.fa=!1)):(c=new k_(c,this.src,b,!!p,A),c.fa=d,a.push(c)),c};function nu(a,c){var d=c.type;if(d in a.g){var p=a.g[d],A=Array.prototype.indexOf.call(p,c,void 0),b;(b=0<=A)&&Array.prototype.splice.call(p,A,1),b&&(xs(c),a.g[d].length==0&&(delete a.g[d],a.h--))}}function ru(a,c,d,p){for(var A=0;A<a.length;++A){var b=a[A];if(!b.da&&b.listener==c&&b.capture==!!d&&b.ha==p)return A}return-1}var iu="closure_lm_"+(1e6*Math.random()|0),su={};function Sf(a,c,d,p,A){if(p&&p.once)return Rf(a,c,d,p,A);if(Array.isArray(c)){for(var b=0;b<c.length;b++)Sf(a,c[b],d,p,A);return null}return d=cu(d),a&&a[ii]?a.K(c,d,h(p)?!!p.capture:!!p,A):Cf(a,c,d,!1,p,A)}function Cf(a,c,d,p,A,b){if(!c)throw Error("Invalid event type");var k=h(A)?!!A.capture:!!A,oe=au(a);if(oe||(a[iu]=oe=new Ls(a)),d=oe.add(c,d,p,k,b),d.proxy)return d;if(p=O_(),d.proxy=p,p.src=a,p.listener=d,a.addEventListener)R_||(A=k),A===void 0&&(A=!1),a.addEventListener(c.toString(),p,A);else if(a.attachEvent)a.attachEvent(Nf(c.toString()),p);else if(a.addListener&&a.removeListener)a.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function O_(){function a(d){return c.call(a.src,a.listener,d)}let c=M_;return a}function Rf(a,c,d,p,A){if(Array.isArray(c)){for(var b=0;b<c.length;b++)Rf(a,c[b],d,p,A);return null}return d=cu(d),a&&a[ii]?a.L(c,d,h(p)?!!p.capture:!!p,A):Cf(a,c,d,!0,p,A)}function Pf(a,c,d,p,A){if(Array.isArray(c))for(var b=0;b<c.length;b++)Pf(a,c[b],d,p,A);else p=h(p)?!!p.capture:!!p,d=cu(d),a&&a[ii]?(a=a.i,c=String(c).toString(),c in a.g&&(b=a.g[c],d=ru(b,d,p,A),-1<d&&(xs(b[d]),Array.prototype.splice.call(b,d,1),b.length==0&&(delete a.g[c],a.h--)))):a&&(a=au(a))&&(c=a.g[c.toString()],a=-1,c&&(a=ru(c,d,p,A)),(d=-1<a?c[a]:null)&&ou(d))}function ou(a){if(typeof a!="number"&&a&&!a.da){var c=a.src;if(c&&c[ii])nu(c.i,a);else{var d=a.type,p=a.proxy;c.removeEventListener?c.removeEventListener(d,p,a.capture):c.detachEvent?c.detachEvent(Nf(d),p):c.addListener&&c.removeListener&&c.removeListener(p),(d=au(c))?(nu(d,a),d.h==0&&(d.src=null,c[iu]=null)):xs(a)}}}function Nf(a){return a in su?su[a]:su[a]="on"+a}function M_(a,c){if(a.da)a=!0;else{c=new ri(c,this);var d=a.listener,p=a.ha||a.src;a.fa&&ou(a),a=d.call(p,c)}return a}function au(a){return a=a[iu],a instanceof Ls?a:null}var uu="__closure_events_fn_"+(1e9*Math.random()>>>0);function cu(a){return typeof a=="function"?a:(a[uu]||(a[uu]=function(c){return a.handleEvent(c)}),a[uu])}function Pe(){$t.call(this),this.i=new Ls(this),this.M=this,this.F=null}N(Pe,$t),Pe.prototype[ii]=!0,Pe.prototype.removeEventListener=function(a,c,d,p){Pf(this,a,c,d,p)};function Fe(a,c){var d,p=a.F;if(p)for(d=[];p;p=p.F)d.push(p);if(a=a.M,p=c.type||c,typeof c=="string")c=new Re(c,a);else if(c instanceof Re)c.target=c.target||a;else{var A=c;c=new Re(p,a),E(c,A)}if(A=!0,d)for(var b=d.length-1;0<=b;b--){var k=c.g=d[b];A=Vs(k,p,!0,c)&&A}if(k=c.g=a,A=Vs(k,p,!0,c)&&A,A=Vs(k,p,!1,c)&&A,d)for(b=0;b<d.length;b++)k=c.g=d[b],A=Vs(k,p,!1,c)&&A}Pe.prototype.N=function(){if(Pe.aa.N.call(this),this.i){var a=this.i,c;for(c in a.g){for(var d=a.g[c],p=0;p<d.length;p++)xs(d[p]);delete a.g[c],a.h--}}this.F=null},Pe.prototype.K=function(a,c,d,p){return this.i.add(String(a),c,!1,d,p)},Pe.prototype.L=function(a,c,d,p){return this.i.add(String(a),c,!0,d,p)};function Vs(a,c,d,p){if(c=a.i.g[String(c)],!c)return!0;c=c.concat();for(var A=!0,b=0;b<c.length;++b){var k=c[b];if(k&&!k.da&&k.capture==d){var oe=k.listener,be=k.ha||k.src;k.fa&&nu(a.i,k),A=oe.call(be,p)!==!1&&A}}return A&&!p.defaultPrevented}function kf(a,c,d){if(typeof a=="function")d&&(a=w(a,d));else if(a&&typeof a.handleEvent=="function")a=w(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(a,c||0)}function Of(a){a.g=kf(()=>{a.g=null,a.i&&(a.i=!1,Of(a))},a.l);let c=a.h;a.h=null,a.m.apply(null,c)}class F_ extends $t{constructor(c,d){super(),this.m=c,this.l=d,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Of(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function si(a){$t.call(this),this.h=a,this.g={}}N(si,$t);var Mf=[];function Ff(a){ne(a.g,function(c,d){this.g.hasOwnProperty(d)&&ou(c)},a),a.g={}}si.prototype.N=function(){si.aa.N.call(this),Ff(this)},si.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var lu=u.JSON.stringify,x_=u.JSON.parse,L_=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function hu(){}hu.prototype.h=null;function xf(a){return a.h||(a.h=a.i())}function Lf(){}var oi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function du(){Re.call(this,"d")}N(du,Re);function fu(){Re.call(this,"c")}N(fu,Re);var gn={},Vf=null;function Us(){return Vf=Vf||new Pe}gn.La="serverreachability";function Uf(a){Re.call(this,gn.La,a)}N(Uf,Re);function ai(a){let c=Us();Fe(c,new Uf(c))}gn.STAT_EVENT="statevent";function Bf(a,c){Re.call(this,gn.STAT_EVENT,a),this.stat=c}N(Bf,Re);function xe(a){let c=Us();Fe(c,new Bf(c,a))}gn.Ma="timingevent";function $f(a,c){Re.call(this,gn.Ma,a),this.size=c}N($f,Re);function ui(a,c){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},c)}function ci(){this.g=!0}ci.prototype.xa=function(){this.g=!1};function V_(a,c,d,p,A,b){a.info(function(){if(a.g)if(b)for(var k="",oe=b.split("&"),be=0;be<oe.length;be++){var te=oe[be].split("=");if(1<te.length){var Ne=te[0];te=te[1];var ke=Ne.split("_");k=2<=ke.length&&ke[1]=="type"?k+(Ne+"="+te+"&"):k+(Ne+"=redacted&")}}else k=null;else k=b;return"XMLHTTP REQ ("+p+") [attempt "+A+"]: "+c+`
`+d+`
`+k})}function U_(a,c,d,p,A,b,k){a.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+A+"]: "+c+`
`+d+`
`+b+" "+k})}function er(a,c,d,p){a.info(function(){return"XMLHTTP TEXT ("+c+"): "+$_(a,d)+(p?" "+p:"")})}function B_(a,c){a.info(function(){return"TIMEOUT: "+c})}ci.prototype.info=function(){};function $_(a,c){if(!a.g)return c;if(!c)return null;try{var d=JSON.parse(c);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var p=d[a];if(!(2>p.length)){var A=p[1];if(Array.isArray(A)&&!(1>A.length)){var b=A[0];if(b!="noop"&&b!="stop"&&b!="close")for(var k=1;k<A.length;k++)A[k]=""}}}}return lu(d)}catch{return c}}var Bs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},jf={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},pu;function $s(){}N($s,hu),$s.prototype.g=function(){return new XMLHttpRequest},$s.prototype.i=function(){return{}},pu=new $s;function jt(a,c,d,p){this.j=a,this.i=c,this.l=d,this.R=p||1,this.U=new si(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new zf}function zf(){this.i=null,this.g="",this.h=!1}var qf={},gu={};function mu(a,c,d){a.L=1,a.v=Gs(Tt(c)),a.m=d,a.P=!0,Gf(a,null)}function Gf(a,c){a.F=Date.now(),js(a),a.A=Tt(a.v);var d=a.A,p=a.R;Array.isArray(p)||(p=[String(p)]),sp(d.i,"t",p),a.C=0,d=a.j.J,a.h=new zf,a.g=Tp(a.j,d?c:null,!a.m),0<a.O&&(a.M=new F_(w(a.Y,a,a.g),a.O)),c=a.U,d=a.g,p=a.ca;var A="readystatechange";Array.isArray(A)||(A&&(Mf[0]=A.toString()),A=Mf);for(var b=0;b<A.length;b++){var k=Sf(d,A[b],p||c.handleEvent,!1,c.h||c);if(!k)break;c.g[k.key]=k}c=a.H?g(a.H):{},a.m?(a.u||(a.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,c)):(a.u="GET",a.g.ea(a.A,a.u,null,c)),ai(),V_(a.i,a.u,a.A,a.l,a.R,a.m)}jt.prototype.ca=function(a){a=a.target;let c=this.M;c&&At(a)==3?c.j():this.Y(a)},jt.prototype.Y=function(a){try{if(a==this.g)e:{let ke=At(this.g);var c=this.g.Ba();let rr=this.g.Z();if(!(3>ke)&&(ke!=3||this.g&&(this.h.h||this.g.oa()||dp(this.g)))){this.J||ke!=4||c==7||(c==8||0>=rr?ai(3):ai(2)),yu(this);var d=this.g.Z();this.X=d;t:if(Wf(this)){var p=dp(this.g);a="";var A=p.length,b=At(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mn(this),li(this);var k="";break t}this.h.i=new u.TextDecoder}for(c=0;c<A;c++)this.h.h=!0,a+=this.h.i.decode(p[c],{stream:!(b&&c==A-1)});p.length=0,this.h.g+=a,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=d==200,U_(this.i,this.u,this.A,this.l,this.R,ke,d),this.o){if(this.T&&!this.K){t:{if(this.g){var oe,be=this.g;if((oe=be.g?be.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(oe)){var te=oe;break t}}te=null}if(d=te)er(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,vu(this,d);else{this.o=!1,this.s=3,xe(12),mn(this),li(this);break e}}if(this.P){d=!0;let nt;for(;!this.J&&this.C<k.length;)if(nt=j_(this,k),nt==gu){ke==4&&(this.s=4,xe(14),d=!1),er(this.i,this.l,null,"[Incomplete Response]");break}else if(nt==qf){this.s=4,xe(15),er(this.i,this.l,k,"[Invalid Chunk]"),d=!1;break}else er(this.i,this.l,nt,null),vu(this,nt);if(Wf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ke!=4||k.length!=0||this.h.h||(this.s=1,xe(16),d=!1),this.o=this.o&&d,!d)er(this.i,this.l,k,"[Invalid Chunked Response]"),mn(this),li(this);else if(0<k.length&&!this.W){this.W=!0;var Ne=this.j;Ne.g==this&&Ne.ba&&!Ne.M&&(Ne.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),Au(Ne),Ne.M=!0,xe(11))}}else er(this.i,this.l,k,null),vu(this,k);ke==4&&mn(this),this.o&&!this.J&&(ke==4?_p(this.j,this):(this.o=!1,js(this)))}else sw(this.g),d==400&&0<k.indexOf("Unknown SID")?(this.s=3,xe(12)):(this.s=0,xe(13)),mn(this),li(this)}}}catch{}finally{}};function Wf(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function j_(a,c){var d=a.C,p=c.indexOf(`
`,d);return p==-1?gu:(d=Number(c.substring(d,p)),isNaN(d)?qf:(p+=1,p+d>c.length?gu:(c=c.slice(p,p+d),a.C=p+d,c)))}jt.prototype.cancel=function(){this.J=!0,mn(this)};function js(a){a.S=Date.now()+a.I,Kf(a,a.I)}function Kf(a,c){if(a.B!=null)throw Error("WatchDog timer not null");a.B=ui(w(a.ba,a),c)}function yu(a){a.B&&(u.clearTimeout(a.B),a.B=null)}jt.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(B_(this.i,this.A),this.L!=2&&(ai(),xe(17)),mn(this),this.s=2,li(this)):Kf(this,this.S-a)};function li(a){a.j.G==0||a.J||_p(a.j,a)}function mn(a){yu(a);var c=a.M;c&&typeof c.ma=="function"&&c.ma(),a.M=null,Ff(a.U),a.g&&(c=a.g,a.g=null,c.abort(),c.ma())}function vu(a,c){try{var d=a.j;if(d.G!=0&&(d.g==a||_u(d.h,a))){if(!a.K&&_u(d.h,a)&&d.G==3){try{var p=d.Da.g.parse(c)}catch{p=null}if(Array.isArray(p)&&p.length==3){var A=p;if(A[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)Ys(d),Hs(d);else break e;Tu(d),xe(18)}}else d.za=A[1],0<d.za-d.T&&37500>A[2]&&d.F&&d.v==0&&!d.C&&(d.C=ui(w(d.Za,d),6e3));if(1>=Yf(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else vn(d,11)}else if((a.K||d.g==a)&&Ys(d),!j(c))for(A=d.Da.g.parse(c),c=0;c<A.length;c++){let te=A[c];if(d.T=te[0],te=te[1],d.G==2)if(te[0]=="c"){d.K=te[1],d.ia=te[2];let Ne=te[3];Ne!=null&&(d.la=Ne,d.j.info("VER="+d.la));let ke=te[4];ke!=null&&(d.Aa=ke,d.j.info("SVER="+d.Aa));let rr=te[5];rr!=null&&typeof rr=="number"&&0<rr&&(p=1.5*rr,d.L=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;let nt=a.g;if(nt){let Xs=nt.g?nt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xs){var b=p.h;b.g||Xs.indexOf("spdy")==-1&&Xs.indexOf("quic")==-1&&Xs.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(wu(b,b.h),b.h=null))}if(p.D){let Du=nt.g?nt.g.getResponseHeader("X-HTTP-Session-Id"):null;Du&&(p.ya=Du,ue(p.I,p.D,Du))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),p=d;var k=a;if(p.qa=Ip(p,p.J?p.ia:null,p.W),k.K){Jf(p.h,k);var oe=k,be=p.L;be&&(oe.I=be),oe.B&&(yu(oe),js(oe)),p.g=k}else yp(p);0<d.i.length&&Qs(d)}else te[0]!="stop"&&te[0]!="close"||vn(d,7);else d.G==3&&(te[0]=="stop"||te[0]=="close"?te[0]=="stop"?vn(d,7):Iu(d):te[0]!="noop"&&d.l&&d.l.ta(te),d.v=0)}}ai(4)}catch{}}var z_=class{constructor(a,c){this.g=a,this.map=c}};function Hf(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qf(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Yf(a){return a.h?1:a.g?a.g.size:0}function _u(a,c){return a.h?a.h==c:a.g?a.g.has(c):!1}function wu(a,c){a.g?a.g.add(c):a.h=c}function Jf(a,c){a.h&&a.h==c?a.h=null:a.g&&a.g.has(c)&&a.g.delete(c)}Hf.prototype.cancel=function(){if(this.i=Xf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Xf(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let c=a.i;for(let d of a.g.values())c=c.concat(d.D);return c}return O(a.i)}function q_(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var c=[],d=a.length,p=0;p<d;p++)c.push(a[p]);return c}c=[],d=0;for(p in a)c[d++]=a[p];return c}function G_(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var c=[];a=a.length;for(var d=0;d<a;d++)c.push(d);return c}c=[],d=0;for(let p in a)c[d++]=p;return c}}}function Zf(a,c){if(a.forEach&&typeof a.forEach=="function")a.forEach(c,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,c,void 0);else for(var d=G_(a),p=q_(a),A=p.length,b=0;b<A;b++)c.call(void 0,p[b],d&&d[b],a)}var ep=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function W_(a,c){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var p=a[d].indexOf("="),A=null;if(0<=p){var b=a[d].substring(0,p);A=a[d].substring(p+1)}else b=a[d];c(b,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function yn(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof yn){this.h=a.h,zs(this,a.j),this.o=a.o,this.g=a.g,qs(this,a.s),this.l=a.l;var c=a.i,d=new fi;d.i=c.i,c.g&&(d.g=new Map(c.g),d.h=c.h),tp(this,d),this.m=a.m}else a&&(c=String(a).match(ep))?(this.h=!1,zs(this,c[1]||"",!0),this.o=hi(c[2]||""),this.g=hi(c[3]||"",!0),qs(this,c[4]),this.l=hi(c[5]||"",!0),tp(this,c[6]||"",!0),this.m=hi(c[7]||"")):(this.h=!1,this.i=new fi(null,this.h))}yn.prototype.toString=function(){var a=[],c=this.j;c&&a.push(di(c,np,!0),":");var d=this.g;return(d||c=="file")&&(a.push("//"),(c=this.o)&&a.push(di(c,np,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(di(d,d.charAt(0)=="/"?Q_:H_,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",di(d,J_)),a.join("")};function Tt(a){return new yn(a)}function zs(a,c,d){a.j=d?hi(c,!0):c,a.j&&(a.j=a.j.replace(/:$/,""))}function qs(a,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);a.s=c}else a.s=null}function tp(a,c,d){c instanceof fi?(a.i=c,X_(a.i,a.h)):(d||(c=di(c,Y_)),a.i=new fi(c,a.h))}function ue(a,c,d){a.i.set(c,d)}function Gs(a){return ue(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function hi(a,c){return a?c?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function di(a,c,d){return typeof a=="string"?(a=encodeURI(a).replace(c,K_),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function K_(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var np=/[#\/\?@]/g,H_=/[#\?:]/g,Q_=/[#\?]/g,Y_=/[#\?@]/g,J_=/#/g;function fi(a,c){this.h=this.g=null,this.i=a||null,this.j=!!c}function zt(a){a.g||(a.g=new Map,a.h=0,a.i&&W_(a.i,function(c,d){a.add(decodeURIComponent(c.replace(/\+/g," ")),d)}))}n=fi.prototype,n.add=function(a,c){zt(this),this.i=null,a=tr(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(c),this.h+=1,this};function rp(a,c){zt(a),c=tr(a,c),a.g.has(c)&&(a.i=null,a.h-=a.g.get(c).length,a.g.delete(c))}function ip(a,c){return zt(a),c=tr(a,c),a.g.has(c)}n.forEach=function(a,c){zt(this),this.g.forEach(function(d,p){d.forEach(function(A){a.call(c,A,p,this)},this)},this)},n.na=function(){zt(this);let a=Array.from(this.g.values()),c=Array.from(this.g.keys()),d=[];for(let p=0;p<c.length;p++){let A=a[p];for(let b=0;b<A.length;b++)d.push(c[p])}return d},n.V=function(a){zt(this);let c=[];if(typeof a=="string")ip(this,a)&&(c=c.concat(this.g.get(tr(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)c=c.concat(a[d])}return c},n.set=function(a,c){return zt(this),this.i=null,a=tr(this,a),ip(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[c]),this.h+=1,this},n.get=function(a,c){return a?(a=this.V(a),0<a.length?String(a[0]):c):c};function sp(a,c,d){rp(a,c),0<d.length&&(a.i=null,a.g.set(tr(a,c),O(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],c=Array.from(this.g.keys());for(var d=0;d<c.length;d++){var p=c[d];let b=encodeURIComponent(String(p)),k=this.V(p);for(p=0;p<k.length;p++){var A=b;k[p]!==""&&(A+="="+encodeURIComponent(String(k[p]))),a.push(A)}}return this.i=a.join("&")};function tr(a,c){return c=String(c),a.j&&(c=c.toLowerCase()),c}function X_(a,c){c&&!a.j&&(zt(a),a.i=null,a.g.forEach(function(d,p){var A=p.toLowerCase();p!=A&&(rp(this,p),sp(this,A,d))},a)),a.j=c}function Z_(a,c){let d=new ci;if(u.Image){let p=new Image;p.onload=S(qt,d,"TestLoadImage: loaded",!0,c,p),p.onerror=S(qt,d,"TestLoadImage: error",!1,c,p),p.onabort=S(qt,d,"TestLoadImage: abort",!1,c,p),p.ontimeout=S(qt,d,"TestLoadImage: timeout",!1,c,p),u.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=a}else c(!1)}function ew(a,c){let d=new ci,p=new AbortController,A=setTimeout(()=>{p.abort(),qt(d,"TestPingServer: timeout",!1,c)},1e4);fetch(a,{signal:p.signal}).then(b=>{clearTimeout(A),b.ok?qt(d,"TestPingServer: ok",!0,c):qt(d,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(A),qt(d,"TestPingServer: error",!1,c)})}function qt(a,c,d,p,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),p(d)}catch{}}function tw(){this.g=new L_}function nw(a,c,d){let p=d||"";try{Zf(a,function(A,b){let k=A;h(A)&&(k=lu(A)),c.push(p+b+"="+encodeURIComponent(k))})}catch(A){throw c.push(p+"type="+encodeURIComponent("_badmap")),A}}function pi(a){this.l=a.Ub||null,this.j=a.eb||!1}N(pi,hu),pi.prototype.g=function(){return new Ws(this.l,this.j)},pi.prototype.i=function(a){return function(){return a}}({});function Ws(a,c){Pe.call(this),this.D=a,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(Ws,Pe),n=Ws.prototype,n.open=function(a,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=c,this.readyState=1,mi(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(c.body=a),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gi(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,mi(this)),this.g&&(this.readyState=3,mi(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;op(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function op(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var c=a.value?a.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!a.done}))&&(this.response=this.responseText+=c)}a.done?gi(this):mi(this),this.readyState==3&&op(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,gi(this))},n.Qa=function(a){this.g&&(this.response=a,gi(this))},n.ga=function(){this.g&&gi(this)};function gi(a){a.readyState=4,a.l=null,a.j=null,a.v=null,mi(a)}n.setRequestHeader=function(a,c){this.u.append(a,c)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],c=this.h.entries();for(var d=c.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=c.next();return a.join(`\r
`)};function mi(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ws.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function ap(a){let c="";return ne(a,function(d,p){c+=p,c+=":",c+=d,c+=`\r
`}),c}function Eu(a,c,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=ap(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):ue(a,c,d))}function le(a){Pe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(le,Pe);var rw=/^https?$/i,iw=["POST","PUT"];n=le.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,c,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);c=c?c.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():pu.g(),this.v=this.o?xf(this.o):xf(pu),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(c,String(a),!0),this.B=!1}catch(b){up(this,b);return}if(a=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var A in p)d.set(A,p[A]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let b of p.keys())d.set(b,p.get(b));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(b=>b.toLowerCase()=="content-type"),A=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(iw,c,void 0))||p||A||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,k]of d)this.g.setRequestHeader(b,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{hp(this),this.u=!0,this.g.send(a),this.u=!1}catch(b){up(this,b)}};function up(a,c){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=c,a.m=5,cp(a),Ks(a)}function cp(a){a.A||(a.A=!0,Fe(a,"complete"),Fe(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Fe(this,"complete"),Fe(this,"abort"),Ks(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ks(this,!0)),le.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?lp(this):this.bb())},n.bb=function(){lp(this)};function lp(a){if(a.h&&typeof o<"u"&&(!a.v[1]||At(a)!=4||a.Z()!=2)){if(a.u&&At(a)==4)kf(a.Ea,0,a);else if(Fe(a,"readystatechange"),At(a)==4){a.h=!1;try{let k=a.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var d;if(!(d=c)){var p;if(p=k===0){var A=String(a.D).match(ep)[1]||null;!A&&u.self&&u.self.location&&(A=u.self.location.protocol.slice(0,-1)),p=!rw.test(A?A.toLowerCase():"")}d=p}if(d)Fe(a,"complete"),Fe(a,"success");else{a.m=6;try{var b=2<At(a)?a.g.statusText:""}catch{b=""}a.l=b+" ["+a.Z()+"]",cp(a)}}finally{Ks(a)}}}}function Ks(a,c){if(a.g){hp(a);let d=a.g,p=a.v[0]?()=>{}:null;a.g=null,a.v=null,c||Fe(a,"ready");try{d.onreadystatechange=p}catch{}}}function hp(a){a.I&&(u.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function At(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<At(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var c=this.g.responseText;return a&&c.indexOf(a)==0&&(c=c.substring(a.length)),x_(c)}};function dp(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function sw(a){let c={};a=(a.g&&2<=At(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<a.length;p++){if(j(a[p]))continue;var d=T(a[p]);let A=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let b=c[A]||[];c[A]=b,b.push(d)}I(c,function(p){return p.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function yi(a,c,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||c}function fp(a){this.Aa=0,this.i=[],this.j=new ci,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=yi("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=yi("baseRetryDelayMs",5e3,a),this.cb=yi("retryDelaySeedMs",1e4,a),this.Wa=yi("forwardChannelMaxRetries",2,a),this.wa=yi("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Hf(a&&a.concurrentRequestLimit),this.Da=new tw,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=fp.prototype,n.la=8,n.G=1,n.connect=function(a,c,d,p){xe(0),this.W=a,this.H=c||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.I=Ip(this,null,this.W),Qs(this)};function Iu(a){if(pp(a),a.G==3){var c=a.U++,d=Tt(a.I);if(ue(d,"SID",a.K),ue(d,"RID",c),ue(d,"TYPE","terminate"),vi(a,d),c=new jt(a,a.j,c),c.L=2,c.v=Gs(Tt(d)),d=!1,u.navigator&&u.navigator.sendBeacon)try{d=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!d&&u.Image&&(new Image().src=c.v,d=!0),d||(c.g=Tp(c.j,null),c.g.ea(c.v)),c.F=Date.now(),js(c)}Ep(a)}function Hs(a){a.g&&(Au(a),a.g.cancel(),a.g=null)}function pp(a){Hs(a),a.u&&(u.clearTimeout(a.u),a.u=null),Ys(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Qs(a){if(!Qf(a.h)&&!a.s){a.s=!0;var c=a.Ga;ti||bf(),ni||(ti(),ni=!0),tu.add(c,a),a.B=0}}function ow(a,c){return Yf(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=c.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=ui(w(a.Ga,a,c),wp(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let A=new jt(this,this.j,a),b=this.o;if(this.S&&(b?(b=g(b),E(b,this.S)):b=this.S),this.m!==null||this.O||(A.H=b,b=null),this.P)e:{for(var c=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(c+=p,4096<c){c=d;break e}if(c===4096||d===this.i.length-1){c=d+1;break e}}c=1e3}else c=1e3;c=mp(this,A,c),d=Tt(this.I),ue(d,"RID",a),ue(d,"CVER",22),this.D&&ue(d,"X-HTTP-Session-Id",this.D),vi(this,d),b&&(this.O?c="headers="+encodeURIComponent(String(ap(b)))+"&"+c:this.m&&Eu(d,this.m,b)),wu(this.h,A),this.Ua&&ue(d,"TYPE","init"),this.P?(ue(d,"$req",c),ue(d,"SID","null"),A.T=!0,mu(A,d,null)):mu(A,d,c),this.G=2}}else this.G==3&&(a?gp(this,a):this.i.length==0||Qf(this.h)||gp(this))};function gp(a,c){var d;c?d=c.l:d=a.U++;let p=Tt(a.I);ue(p,"SID",a.K),ue(p,"RID",d),ue(p,"AID",a.T),vi(a,p),a.m&&a.o&&Eu(p,a.m,a.o),d=new jt(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),c&&(a.i=c.D.concat(a.i)),c=mp(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),wu(a.h,d),mu(d,p,c)}function vi(a,c){a.H&&ne(a.H,function(d,p){ue(c,p,d)}),a.l&&Zf({},function(d,p){ue(c,p,d)})}function mp(a,c,d){d=Math.min(a.i.length,d);var p=a.l?w(a.l.Na,a.l,a):null;e:{var A=a.i;let b=-1;for(;;){let k=["count="+d];b==-1?0<d?(b=A[0].g,k.push("ofs="+b)):b=0:k.push("ofs="+b);let oe=!0;for(let be=0;be<d;be++){let te=A[be].g,Ne=A[be].map;if(te-=b,0>te)b=Math.max(0,A[be].g-100),oe=!1;else try{nw(Ne,k,"req"+te+"_")}catch{p&&p(Ne)}}if(oe){p=k.join("&");break e}}}return a=a.i.splice(0,d),c.D=a,p}function yp(a){if(!a.g&&!a.u){a.Y=1;var c=a.Fa;ti||bf(),ni||(ti(),ni=!0),tu.add(c,a),a.v=0}}function Tu(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=ui(w(a.Fa,a),wp(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,vp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=ui(w(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xe(10),Hs(this),vp(this))};function Au(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function vp(a){a.g=new jt(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var c=Tt(a.qa);ue(c,"RID","rpc"),ue(c,"SID",a.K),ue(c,"AID",a.T),ue(c,"CI",a.F?"0":"1"),!a.F&&a.ja&&ue(c,"TO",a.ja),ue(c,"TYPE","xmlhttp"),vi(a,c),a.m&&a.o&&Eu(c,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=Gs(Tt(c)),d.m=null,d.P=!0,Gf(d,a)}n.Za=function(){this.C!=null&&(this.C=null,Hs(this),Tu(this),xe(19))};function Ys(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function _p(a,c){var d=null;if(a.g==c){Ys(a),Au(a),a.g=null;var p=2}else if(_u(a.h,c))d=c.D,Jf(a.h,c),p=1;else return;if(a.G!=0){if(c.o)if(p==1){d=c.m?c.m.length:0,c=Date.now()-c.F;var A=a.B;p=Us(),Fe(p,new $f(p,d)),Qs(a)}else yp(a);else if(A=c.s,A==3||A==0&&0<c.X||!(p==1&&ow(a,c)||p==2&&Tu(a)))switch(d&&0<d.length&&(c=a.h,c.i=c.i.concat(d)),A){case 1:vn(a,5);break;case 4:vn(a,10);break;case 3:vn(a,6);break;default:vn(a,2)}}}function wp(a,c){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*c}function vn(a,c){if(a.j.info("Error code "+c),c==2){var d=w(a.fb,a),p=a.Xa;let A=!p;p=new yn(p||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||zs(p,"https"),Gs(p),A?Z_(p.toString(),d):ew(p.toString(),d)}else xe(2);a.G=0,a.l&&a.l.sa(c),Ep(a),pp(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),xe(2)):(this.j.info("Failed to ping google.com"),xe(1))};function Ep(a){if(a.G=0,a.ka=[],a.l){let c=Xf(a.h);(c.length!=0||a.i.length!=0)&&(C(a.ka,c),C(a.ka,a.i),a.h.i.length=0,O(a.i),a.i.length=0),a.l.ra()}}function Ip(a,c,d){var p=d instanceof yn?Tt(d):new yn(d);if(p.g!="")c&&(p.g=c+"."+p.g),qs(p,p.s);else{var A=u.location;p=A.protocol,c=c?c+"."+A.hostname:A.hostname,A=+A.port;var b=new yn(null);p&&zs(b,p),c&&(b.g=c),A&&qs(b,A),d&&(b.l=d),p=b}return d=a.D,c=a.ya,d&&c&&ue(p,d,c),ue(p,"VER",a.la),vi(a,p),p}function Tp(a,c,d){if(c&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=a.Ca&&!a.pa?new le(new pi({eb:d})):new le(a.pa),c.Ha(a.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ap(){}n=Ap.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Js(){}Js.prototype.g=function(a,c){return new qe(a,c)};function qe(a,c){Pe.call(this),this.g=new fp(c),this.l=a,this.h=c&&c.messageUrlParams||null,a=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(a?a["X-WebChannel-Content-Type"]=c.messageContentType:a={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(a?a["X-WebChannel-Client-Profile"]=c.va:a={"X-WebChannel-Client-Profile":c.va}),this.g.S=a,(a=c&&c.Sb)&&!j(a)&&(this.g.m=a),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!j(c)&&(this.g.D=c,a=this.h,a!==null&&c in a&&(a=this.h,c in a&&delete a[c])),this.j=new nr(this)}N(qe,Pe),qe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qe.prototype.close=function(){Iu(this.g)},qe.prototype.o=function(a){var c=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=lu(a),a=d);c.i.push(new z_(c.Ya++,a)),c.G==3&&Qs(c)},qe.prototype.N=function(){this.g.l=null,delete this.j,Iu(this.g),delete this.g,qe.aa.N.call(this)};function Dp(a){du.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var c=a.__sm__;if(c){e:{for(let d in c){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,c=c!==null&&a in c?c[a]:void 0),this.data=c}else this.data=a}N(Dp,du);function bp(){fu.call(this),this.status=1}N(bp,fu);function nr(a){this.g=a}N(nr,Ap),nr.prototype.ua=function(){Fe(this.g,"a")},nr.prototype.ta=function(a){Fe(this.g,new Dp(a))},nr.prototype.sa=function(a){Fe(this.g,new bp)},nr.prototype.ra=function(){Fe(this.g,"b")},Js.prototype.createWebChannel=Js.prototype.g,qe.prototype.send=qe.prototype.o,qe.prototype.open=qe.prototype.m,qe.prototype.close=qe.prototype.close,gh=Ft.createWebChannelTransport=function(){return new Js},ph=Ft.getStatEventTarget=function(){return Us()},fh=Ft.Event=gn,oa=Ft.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Bs.NO_ERROR=0,Bs.TIMEOUT=8,Bs.HTTP_ERROR=6,ds=Ft.ErrorCode=Bs,jf.COMPLETE="complete",dh=Ft.EventType=jf,Lf.EventType=oi,oi.OPEN="a",oi.CLOSE="b",oi.ERROR="c",oi.MESSAGE="d",Pe.prototype.listen=Pe.prototype.K,Nr=Ft.WebChannel=Lf,hh=Ft.FetchXmlHttpFactory=pi,le.prototype.listenOnce=le.prototype.L,le.prototype.getLastError=le.prototype.Ka,le.prototype.getLastErrorCode=le.prototype.Ba,le.prototype.getStatus=le.prototype.Z,le.prototype.getResponseJson=le.prototype.Oa,le.prototype.getResponseText=le.prototype.oa,le.prototype.send=le.prototype.ea,le.prototype.setWithCredentials=le.prototype.Ha,lh=Ft.XhrIo=le}).apply(typeof sa<"u"?sa:typeof self<"u"?self:typeof window<"u"?window:{});var Ny="@firebase/firestore";var De=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};De.UNAUTHENTICATED=new De(null),De.GOOGLE_CREDENTIALS=new De("google-credentials-uid"),De.FIRST_PARTY=new De("first-party-uid"),De.MOCK_USER=new De("mock-user");var Jr="10.12.1";var zn=new en("@firebase/firestore");function fs(){return zn.logLevel}function x(n,...e){if(zn.logLevel<=J.DEBUG){let t=e.map(Zd);zn.debug(`Firestore (${Jr}): ${n}`,...t)}}function Lt(n,...e){if(zn.logLevel<=J.ERROR){let t=e.map(Zd);zn.error(`Firestore (${Jr}): ${n}`,...t)}}function Vr(n,...e){if(zn.logLevel<=J.WARN){let t=e.map(Zd);zn.warn(`Firestore (${Jr}): ${n}`,...t)}}function Zd(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n="Unexpected state"){let e=`FIRESTORE (${Jr}) INTERNAL ASSERTION FAILED: `+n;throw Lt(e),new Error(e)}function ae(n,e){n||$()}function q(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},F=class extends Ke{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var mt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ha=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},wh=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(De.UNAUTHENTICATED))}shutdown(){}},Eh=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Ih=class{constructor(e){this.t=e,this.currentUser=De.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new mt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new mt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>m(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},u=l=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?u(l):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new mt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ae(typeof r.accessToken=="string"),new ha(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ae(e===null||typeof e=="string"),new De(e)}},Th=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=De.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Ah=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Th(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(De.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Dh=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},bh=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,x("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ae(typeof t.token=="string"),this.R=t.token,new Dh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function rb(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var da=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=rb(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function re(n,e){return n<e?-1:n>e?1:0}function Ur(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Ce=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new F(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?re(this.nanoseconds,e.nanoseconds):re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var G=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ce(0,0))}static max(){return new n(new Ce(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var fa=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(),r===void 0?r=e.length-t:r>e.length-t&&$(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ce=class n extends fa{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new F(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},ib=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Qe=class n extends fa{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return ib.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new F(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new F(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new F(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new F(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var U=class n{constructor(e){this.path=e}static fromPath(e){return new n(ce.fromString(e))}static fromName(e){return new n(ce.fromString(e).popFirst(5))}static empty(){return new n(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ce(e.slice()))}};var Sh=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Sh.UNKNOWN_ID=-1;function sb(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=G.fromTimestamp(r===1e9?new Ce(t+1,0):new Ce(t,r));return new qn(i,U.empty(),e)}function ob(n){return new qn(n.readTime,n.key,-1)}var qn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(G.min(),U.empty(),-1)}static max(){return new n(G.max(),U.empty(),-1)}};function ab(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=U.comparator(n.documentKey,e.documentKey),t!==0?t:re(n.largestBatchId,e.largestBatchId))}var ub="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ch=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ns(n){return m(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==ub)throw n;x("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),u=0;for(let l=0;l<s;l++){let h=l;t(e[h]).next(f=>{o[h]=f,++u,u===s&&r(o)},f=>i(f))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function cb(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ks(n){return n.name==="IndexedDbTransactionError"}var cv=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Ga(n){return n==null}function _s(n){return n===0&&1/n==-1/0}function lb(n){return typeof n=="number"&&Number.isInteger(n)&&!_s(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var hb=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],WN=[...hb,"documentOverlays"],db=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],fb=db,KN=[...fb,"indexConfiguration","indexState","indexEntries"];function ky(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Jn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function lv(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var de=class n{constructor(e,t){this.comparator=e,this.root=t||yt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,yt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fr(this.root,e,this.comparator,!0)}},Fr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},yt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();let e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}};yt.EMPTY=null,yt.RED=!0,yt.BLACK=!1;yt.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,t,r,i,s){return this}insert(e,t,r){return new yt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Me=class n{constructor(e){this.comparator=e,this.data=new de(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new pa(this.data.getIterator())}getIteratorFrom(e){return new pa(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},pa=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var tt=class n{constructor(e){this.fields=e,e.sort(Qe.comparator)}static empty(){return new n([])}unionWith(e){let t=new Me(Qe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ur(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var ga=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Le=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ga("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Le.EMPTY_BYTE_STRING=new Le("");var pb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vt(n){if(ae(!!n),typeof n=="string"){let e=0,t=pb.exec(n);if(ae(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:he(n.seconds),nanos:he(n.nanos)}}function he(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ln(n){return typeof n=="string"?Le.fromBase64String(n):Le.fromUint8Array(n)}function ef(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function tf(n){let e=n.mapValue.fields.__previous_value__;return ef(e)?tf(e):e}function ws(n){let e=Vt(n.mapValue.fields.__local_write_time__.timestampValue);return new Ce(e.seconds,e.nanos)}var Rh=class{constructor(e,t,r,i,s,o,u,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=h}},ma=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var aa={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Gn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ef(n)?4:hv(n)?9007199254740991:10:$()}function wt(n,e){if(n===e)return!0;let t=Gn(n);if(t!==Gn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ws(n).isEqual(ws(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Vt(i.timestampValue),u=Vt(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return ln(i.bytesValue).isEqual(ln(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return he(i.geoPointValue.latitude)===he(s.geoPointValue.latitude)&&he(i.geoPointValue.longitude)===he(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return he(i.integerValue)===he(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=he(i.doubleValue),u=he(s.doubleValue);return o===u?_s(o)===_s(u):isNaN(o)&&isNaN(u)}return!1}(n,e);case 9:return Ur(n.arrayValue.values||[],e.arrayValue.values||[],wt);case 10:return function(i,s){let o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(ky(o)!==ky(u))return!1;for(let l in o)if(o.hasOwnProperty(l)&&(u[l]===void 0||!wt(o[l],u[l])))return!1;return!0}(n,e);default:return $()}}function Es(n,e){return(n.values||[]).find(t=>wt(t,e))!==void 0}function Br(n,e){if(n===e)return 0;let t=Gn(n),r=Gn(e);if(t!==r)return re(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return re(n.booleanValue,e.booleanValue);case 2:return function(s,o){let u=he(s.integerValue||s.doubleValue),l=he(o.integerValue||o.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(n,e);case 3:return Oy(n.timestampValue,e.timestampValue);case 4:return Oy(ws(n),ws(e));case 5:return re(n.stringValue,e.stringValue);case 6:return function(s,o){let u=ln(s),l=ln(o);return u.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let u=s.split("/"),l=o.split("/");for(let h=0;h<u.length&&h<l.length;h++){let f=re(u[h],l[h]);if(f!==0)return f}return re(u.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let u=re(he(s.latitude),he(o.latitude));return u!==0?u:re(he(s.longitude),he(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let u=s.values||[],l=o.values||[];for(let h=0;h<u.length&&h<l.length;++h){let f=Br(u[h],l[h]);if(f)return f}return re(u.length,l.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===aa.mapValue&&o===aa.mapValue)return 0;if(s===aa.mapValue)return 1;if(o===aa.mapValue)return-1;let u=s.fields||{},l=Object.keys(u),h=o.fields||{},f=Object.keys(h);l.sort(),f.sort();for(let y=0;y<l.length&&y<f.length;++y){let w=re(l[y],f[y]);if(w!==0)return w;let S=Br(u[l[y]],h[f[y]]);if(S!==0)return S}return re(l.length,f.length)}(n.mapValue,e.mapValue);default:throw $()}}function Oy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return re(n,e);let t=Vt(n),r=Vt(e),i=re(t.seconds,r.seconds);return i!==0?i:re(t.nanos,r.nanos)}function $r(n){return Ph(n)}function Ph(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Vt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ln(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return U.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Ph(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Ph(t.fields[o])}`;return i+"}"}(n.mapValue):$()}function My(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Nh(n){return!!n&&"integerValue"in n}function nf(n){return!!n&&"arrayValue"in n}function Fy(n){return!!n&&"nullValue"in n}function xy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ca(n){return!!n&&"mapValue"in n}function gs(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Jn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=gs(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gs(n.arrayValue.values[t]);return e}return Object.assign({},n)}function hv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var He=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ca(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gs(t)}setAll(e){let t=Qe.emptyPath(),r={},i=[];e.forEach((o,u)=>{if(!t.isImmediateParentOf(u)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=u.popLast()}o?r[u.lastSegment()]=gs(o):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());ca(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ca(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Jn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(gs(this.value))}};function dv(n){let e=[];return Jn(n.fields,(t,r)=>{let i=new Qe([t]);if(ca(r)){let s=dv(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new tt(e)}var ot=class n{constructor(e,t,r,i,s,o,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new n(e,0,G.min(),G.min(),G.min(),He.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,G.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,G.min(),G.min(),He.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,G.min(),G.min(),He.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(G.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=He.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=He.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=G.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var jr=class{constructor(e,t){this.position=e,this.inclusive=t}};function Ly(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=U.comparator(U.fromName(o.referenceValue),t.key):r=Br(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Vy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!wt(n.position[t],e.position[t]))return!1;return!0}var zr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function gb(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var ya=class{},ye=class n extends ya{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Oh(e,t,r):t==="array-contains"?new xh(e,r):t==="in"?new Lh(e,r):t==="not-in"?new Vh(e,r):t==="array-contains-any"?new Uh(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Mh(e,r):new Fh(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Br(t,this.value)):t!==null&&Gn(this.value)===Gn(t)&&this.matchesComparison(Br(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},at=class n extends ya{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return fv(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function fv(n){return n.op==="and"}function pv(n){return mb(n)&&fv(n)}function mb(n){for(let e of n.filters)if(e instanceof at)return!1;return!0}function kh(n){if(n instanceof ye)return n.field.canonicalString()+n.op.toString()+$r(n.value);if(pv(n))return n.filters.map(e=>kh(e)).join(",");{let e=n.filters.map(t=>kh(t)).join(",");return`${n.op}(${e})`}}function gv(n,e){return n instanceof ye?function(r,i){return i instanceof ye&&r.op===i.op&&r.field.isEqual(i.field)&&wt(r.value,i.value)}(n,e):n instanceof at?function(r,i){return i instanceof at&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&gv(o,i.filters[u]),!0):!1}(n,e):void $()}function mv(n){return n instanceof ye?function(t){return`${t.field.canonicalString()} ${t.op} ${$r(t.value)}`}(n):n instanceof at?function(t){return t.op.toString()+" {"+t.getFilters().map(mv).join(" ,")+"}"}(n):"Filter"}var Oh=class extends ye{constructor(e,t,r){super(e,t,r),this.key=U.fromName(r.referenceValue)}matches(e){let t=U.comparator(e.key,this.key);return this.matchesComparison(t)}},Mh=class extends ye{constructor(e,t){super(e,"in",t),this.keys=yv("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Fh=class extends ye{constructor(e,t){super(e,"not-in",t),this.keys=yv("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function yv(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>U.fromName(r.referenceValue))}var xh=class extends ye{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return nf(t)&&Es(t.arrayValue,this.value)}},Lh=class extends ye{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Es(this.value.arrayValue,t)}},Vh=class extends ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Es(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Es(this.value.arrayValue,t)}},Uh=class extends ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!nf(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Es(this.value.arrayValue,r))}};var Bh=class{constructor(e,t=null,r=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.ue=null}};function Uy(n,e=null,t=[],r=[],i=null,s=null,o=null){return new Bh(n,e,t,r,i,s,o)}function rf(n){let e=q(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>kh(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ga(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>$r(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>$r(r)).join(",")),e.ue=t}return e.ue}function sf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!gb(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!gv(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Vy(n.startAt,e.startAt)&&Vy(n.endAt,e.endAt)}function $h(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Wn=class{constructor(e,t=null,r=[],i=[],s=null,o="F",u=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function yb(n,e,t,r,i,s,o,u){return new Wn(n,e,t,r,i,s,o,u)}function of(n){return new Wn(n)}function By(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function vv(n){return n.collectionGroup!==null}function ms(n){let e=q(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Me(Qe.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(u=u.add(h.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new zr(s,r))}),t.has(Qe.keyField().canonicalString())||e.ce.push(new zr(Qe.keyField(),r))}return e.ce}function vt(n){let e=q(n);return e.le||(e.le=vb(e,ms(n))),e.le}function vb(n,e){if(n.limitType==="F")return Uy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new zr(i.field,s)});let t=n.endAt?new jr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new jr(n.startAt.position,n.startAt.inclusive):null;return Uy(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function jh(n,e){let t=n.filters.concat([e]);return new Wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function zh(n,e,t){return new Wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Wa(n,e){return sf(vt(n),vt(e))&&n.limitType===e.limitType}function _v(n){return`${rf(vt(n))}|lt:${n.limitType}`}function kr(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>mv(i)).join(", ")}]`),Ga(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>$r(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>$r(i)).join(",")),`Target(${r})`}(vt(n))}; limitType=${n.limitType})`}function Ka(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):U.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of ms(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,u,l){let h=Ly(o,u,l);return o.inclusive?h<=0:h<0}(r.startAt,ms(r),i)||r.endAt&&!function(o,u,l){let h=Ly(o,u,l);return o.inclusive?h>=0:h>0}(r.endAt,ms(r),i))}(n,e)}function _b(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wv(n){return(e,t)=>{let r=!1;for(let i of ms(n)){let s=wb(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function wb(n,e,t){let r=n.field.isKeyField()?U.comparator(e.key,t.key):function(s,o,u){let l=o.data.field(s),h=u.data.field(s);return l!==null&&h!==null?Br(l,h):$()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}var hn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Jn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return lv(this.inner)}size(){return this.innerSize}};var Eb=new de(U.comparator);function Ut(){return Eb}var Ev=new de(U.comparator);function ps(...n){let e=Ev;for(let t of n)e=e.insert(t.key,t);return e}function Iv(n){let e=Ev;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Bn(){return ys()}function Tv(){return ys()}function ys(){return new hn(n=>n.toString(),(n,e)=>n.isEqual(e))}var Ib=new de(U.comparator),Tb=new Me(U.comparator);function X(...n){let e=Tb;for(let t of n)e=e.add(t);return e}var Ab=new Me(re);function Db(){return Ab}function Av(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_s(e)?"-0":e}}function Dv(n){return{integerValue:""+n}}function bb(n,e){return lb(e)?Dv(e):Av(n,e)}var qr=class{constructor(){this._=void 0}};function Sb(n,e,t){return n instanceof Gr?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ef(s)&&(s=tf(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Kn?Sv(n,e):n instanceof Hn?Cv(n,e):function(i,s){let o=bv(i,s),u=$y(o)+$y(i.Pe);return Nh(o)&&Nh(i.Pe)?Dv(u):Av(i.serializer,u)}(n,e)}function Cb(n,e,t){return n instanceof Kn?Sv(n,e):n instanceof Hn?Cv(n,e):t}function bv(n,e){return n instanceof Wr?function(r){return Nh(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Gr=class extends qr{},Kn=class extends qr{constructor(e){super(),this.elements=e}};function Sv(n,e){let t=Rv(e);for(let r of n.elements)t.some(i=>wt(i,r))||t.push(r);return{arrayValue:{values:t}}}var Hn=class extends qr{constructor(e){super(),this.elements=e}};function Cv(n,e){let t=Rv(e);for(let r of n.elements)t=t.filter(i=>!wt(i,r));return{arrayValue:{values:t}}}var Wr=class extends qr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function $y(n){return he(n.integerValue||n.doubleValue)}function Rv(n){return nf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Rb(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Kn&&i instanceof Kn||r instanceof Hn&&i instanceof Hn?Ur(r.elements,i.elements,wt):r instanceof Wr&&i instanceof Wr?wt(r.Pe,i.Pe):r instanceof Gr&&i instanceof Gr}(n.transform,e.transform)}var qh=class{constructor(e,t){this.version=e,this.transformResults=t}},un=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function la(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Kr=class{};function Pv(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new va(n.key,un.none()):new Qn(n.key,n.data,un.none());{let t=n.data,r=He.empty(),i=new Me(Qe.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Et(n.key,r,new tt(i.toArray()),un.none())}}function Pb(n,e,t){n instanceof Qn?function(i,s,o){let u=i.value.clone(),l=zy(i.fieldTransforms,s,o.transformResults);u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Et?function(i,s,o){if(!la(i.precondition,s))return void s.convertToUnknownDocument(o.version);let u=zy(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Nv(i)),l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function vs(n,e,t,r){return n instanceof Qn?function(s,o,u,l){if(!la(s.precondition,o))return u;let h=s.value.clone(),f=qy(s.fieldTransforms,l,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(n,e,t,r):n instanceof Et?function(s,o,u,l){if(!la(s.precondition,o))return u;let h=qy(s.fieldTransforms,l,o),f=o.data;return f.setAll(Nv(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(n,e,t,r):function(s,o,u){return la(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(n,e,t)}function Nb(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=bv(r.transform,i||null);s!=null&&(t===null&&(t=He.empty()),t.set(r.field,s))}return t||null}function jy(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ur(r,i,(s,o)=>Rb(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Qn=class extends Kr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Et=class extends Kr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Nv(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function zy(n,e,t){let r=new Map;ae(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,u=e.data.field(s.field);r.set(s.field,Cb(o,u,t[i]))}return r}function qy(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,Sb(s,o,e))}return r}var va=class extends Kr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Gh=class extends Kr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Wh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&Pb(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=vs(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=vs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Tv();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,u=this.applyToLocalView(o,s.mutatedFields);u=t.has(i.key)?null:u;let l=Pv(o,u);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(G.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),X())}isEqual(e){return this.batchId===e.batchId&&Ur(this.mutations,e.mutations,(t,r)=>jy(t,r))&&Ur(this.baseMutations,e.baseMutations,(t,r)=>jy(t,r))}},Kh=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ae(e.mutations.length===r.length);let i=function(){return Ib}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Hh=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Qh=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ge,Z;function kb(n){switch(n){default:return $();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function kv(n){if(n===void 0)return Lt("GRPC error has no .code"),R.UNKNOWN;switch(n){case ge.OK:return R.OK;case ge.CANCELLED:return R.CANCELLED;case ge.UNKNOWN:return R.UNKNOWN;case ge.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ge.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ge.INTERNAL:return R.INTERNAL;case ge.UNAVAILABLE:return R.UNAVAILABLE;case ge.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ge.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ge.NOT_FOUND:return R.NOT_FOUND;case ge.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ge.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ge.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ge.ABORTED:return R.ABORTED;case ge.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ge.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ge.DATA_LOSS:return R.DATA_LOSS;default:return $()}}(Z=ge||(ge={}))[Z.OK=0]="OK",Z[Z.CANCELLED=1]="CANCELLED",Z[Z.UNKNOWN=2]="UNKNOWN",Z[Z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Z[Z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Z[Z.NOT_FOUND=5]="NOT_FOUND",Z[Z.ALREADY_EXISTS=6]="ALREADY_EXISTS",Z[Z.PERMISSION_DENIED=7]="PERMISSION_DENIED",Z[Z.UNAUTHENTICATED=16]="UNAUTHENTICATED",Z[Z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Z[Z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Z[Z.ABORTED=10]="ABORTED",Z[Z.OUT_OF_RANGE=11]="OUT_OF_RANGE",Z[Z.UNIMPLEMENTED=12]="UNIMPLEMENTED",Z[Z.INTERNAL=13]="INTERNAL",Z[Z.UNAVAILABLE=14]="UNAVAILABLE",Z[Z.DATA_LOSS=15]="DATA_LOSS";var Gy=null;function Ob(){return new TextEncoder}var Mb=new an([4294967295,4294967295],0);function Wy(n){let e=Ob().encode(n),t=new ch;return t.update(e),new Uint8Array(t.digest())}function Ky(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new an([t,r],0),new an([i,s],0)]}var Yh=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new $n(`Invalid padding: ${t}`);if(r<0)throw new $n(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $n(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new $n(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=an.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(an.fromNumber(r)));return i.compare(Mb)===1&&(i=new an([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Wy(e),[r,i]=Ky(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(u=>o.insert(u)),o}insert(e){if(this.Ie===0)return;let t=Wy(e),[r,i]=Ky(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},$n=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var _a=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Is.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(G.min(),i,new de(re),Ut(),X())}},Is=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,X(),X(),X())}};var xr=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},wa=class{constructor(e,t){this.targetId=e,this.me=t}},Ea=class{constructor(e,t,r=Le.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ia=class{constructor(){this.fe=0,this.ge=Qy(),this.pe=Le.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=X(),t=X(),r=X();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$()}}),new Is(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=Qy()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ae(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Jh=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ut(),this.qe=Hy(),this.Qe=new de(re)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:$()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if($h(s))if(r===0){let o=new U(s.path);this.Ue(t,o,ot.newNoDocument(o,G.min()))}else ae(r===1);else{let o=this.Ye(t);if(o!==r){let u=this.Ze(e),l=u?this.Xe(u,e,o):1;if(l!==0){this.je(t);let h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,h)}Gy?.et(function(f,y,w,S,N){var O,C,M,j,Y,K;let ve={localCacheCount:f,existenceFilterCount:y.count,databaseId:w.database,projectId:w.projectId},ne=y.unchangedNames;return ne&&(ve.bloomFilter={applied:N===0,hashCount:(O=ne?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(j=(M=(C=ne?.bits)===null||C===void 0?void 0:C.bitmap)===null||M===void 0?void 0:M.length)!==null&&j!==void 0?j:0,padding:(K=(Y=ne?.bits)===null||Y===void 0?void 0:Y.padding)!==null&&K!==void 0?K:0,mightContain:I=>{var g;return(g=S?.mightContain(I))!==null&&g!==void 0&&g}}),ve}(o,e.me,this.Le.tt(),u,l))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,u;try{o=ln(r).toUint8Array()}catch(l){if(l instanceof ga)return Vr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new Yh(o,i,s)}catch(l){return Vr(l instanceof $n?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let u=this.Je(o);if(u){if(s.current&&$h(u.target)){let l=new U(u.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,ot.newNoDocument(l,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=X();this.qe.forEach((s,o)=>{let u=!0;o.forEachWhile(l=>{let h=this.Je(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new _a(e,t,this.Qe,this.ke,r);return this.ke=Ut(),this.qe=Hy(),this.Qe=new de(re),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ia,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Me(re),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||x("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ia),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Hy(){return new de(U.comparator)}function Qy(){return new de(U.comparator)}var Fb={asc:"ASCENDING",desc:"DESCENDING"},xb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lb={and:"AND",or:"OR"},Xh=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Zh(n,e){return n.useProto3Json||Ga(e)?e:{value:e}}function Ta(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ov(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Vb(n,e){return Ta(n,e.toTimestamp())}function _t(n){return ae(!!n),G.fromTimestamp(function(t){let r=Vt(t);return new Ce(r.seconds,r.nanos)}(n))}function af(n,e){return ed(n,e).canonicalString()}function ed(n,e){let t=function(i){return new ce(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Mv(n){let e=ce.fromString(n);return ae(Uv(e)),e}function td(n,e){return af(n.databaseId,e.path)}function mh(n,e){let t=Mv(e);if(t.get(1)!==n.databaseId.projectId)throw new F(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new U(xv(t))}function Fv(n,e){return af(n.databaseId,e)}function Ub(n){let e=Mv(n);return e.length===4?ce.emptyPath():xv(e)}function nd(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function xv(n){return ae(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Yy(n,e,t){return{name:td(n,e),fields:t.value.mapValue.fields}}function Bb(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,f){return h.useProto3Json?(ae(f===void 0||typeof f=="string"),Le.fromBase64String(f||"")):(ae(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Le.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(h){let f=h.code===void 0?R.UNKNOWN:kv(h.code);return new F(f,h.message||"")}(o);t=new Ea(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=mh(n,r.document.name),s=_t(r.document.updateTime),o=r.document.createTime?_t(r.document.createTime):G.min(),u=new He({mapValue:{fields:r.document.fields}}),l=ot.newFoundDocument(i,s,o,u),h=r.targetIds||[],f=r.removedTargetIds||[];t=new xr(h,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=mh(n,r.document),s=r.readTime?_t(r.readTime):G.min(),o=ot.newNoDocument(i,s),u=r.removedTargetIds||[];t=new xr([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=mh(n,r.document),s=r.removedTargetIds||[];t=new xr([],s,i,null)}else{if(!("filter"in e))return $();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new Qh(i,s),u=r.targetId;t=new wa(u,o)}}return t}function $b(n,e){let t;if(e instanceof Qn)t={update:Yy(n,e.key,e.value)};else if(e instanceof va)t={delete:td(n,e.key)};else if(e instanceof Et)t={update:Yy(n,e.key,e.data),updateMask:Yb(e.fieldMask)};else{if(!(e instanceof Gh))return $();t={verify:td(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let u=o.transform;if(u instanceof Gr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Kn)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Hn)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Wr)return{fieldPath:o.field.canonicalString(),increment:u.Pe};throw $()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Vb(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:$()}(n,e.precondition)),t}function jb(n,e){return n&&n.length>0?(ae(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?_t(i.updateTime):_t(s);return o.isEqual(G.min())&&(o=_t(s)),new qh(o,i.transformResults||[])}(t,e))):[]}function zb(n,e){return{documents:[Fv(n,e.path)]}}function qb(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Fv(n,i);let s=function(h){if(h.length!==0)return Vv(at.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(h){if(h.length!==0)return h.map(f=>function(w){return{field:Or(w.field),direction:Kb(w.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let u=Zh(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:t,parent:i}}function Gb(n){let e=Ub(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ae(r===1);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(y){let w=Lv(y);return w instanceof at&&pv(w)?w.getFilters():[w]}(t.where));let o=[];t.orderBy&&(o=function(y){return y.map(w=>function(N){return new zr(Mr(N.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(w))}(t.orderBy));let u=null;t.limit&&(u=function(y){let w;return w=typeof y=="object"?y.value:y,Ga(w)?null:w}(t.limit));let l=null;t.startAt&&(l=function(y){let w=!!y.before,S=y.values||[];return new jr(S,w)}(t.startAt));let h=null;return t.endAt&&(h=function(y){let w=!y.before,S=y.values||[];return new jr(S,w)}(t.endAt)),yb(e,i,o,s,u,"F",l,h)}function Wb(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Lv(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Mr(t.unaryFilter.field);return ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Mr(t.unaryFilter.field);return ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Mr(t.unaryFilter.field);return ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Mr(t.unaryFilter.field);return ye.create(o,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(n):n.fieldFilter!==void 0?function(t){return ye.create(Mr(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return at.create(t.compositeFilter.filters.map(r=>Lv(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $()}}(t.compositeFilter.op))}(n):$()}function Kb(n){return Fb[n]}function Hb(n){return xb[n]}function Qb(n){return Lb[n]}function Or(n){return{fieldPath:n.canonicalString()}}function Mr(n){return Qe.fromServerFormat(n.fieldPath)}function Vv(n){return n instanceof ye?function(t){if(t.op==="=="){if(xy(t.value))return{unaryFilter:{field:Or(t.field),op:"IS_NAN"}};if(Fy(t.value))return{unaryFilter:{field:Or(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(xy(t.value))return{unaryFilter:{field:Or(t.field),op:"IS_NOT_NAN"}};if(Fy(t.value))return{unaryFilter:{field:Or(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Or(t.field),op:Hb(t.op),value:t.value}}}(n):n instanceof at?function(t){let r=t.getFilters().map(i=>Vv(i));return r.length===1?r[0]:{compositeFilter:{op:Qb(t.op),filters:r}}}(n):$()}function Yb(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Uv(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ts=class n{constructor(e,t,r,i,s=G.min(),o=G.min(),u=Le.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var rd=class{constructor(e){this.ct=e}};function Jb(n){let e=Gb({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?zh(e,e.limit,"L"):e}var Aa=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(he(e.integerValue));else if("doubleValue"in e){let r=he(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),_s(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=Vt(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(ln(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?hv(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):$()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),U.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};Aa.bt=new Aa;var id=class{constructor(){this._n=new sd}addToCollectionParentIndex(e,t){return this._n.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(qn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(qn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},sd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Me(ce.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Me(ce.comparator)).toArray()}};var QN=new Uint8Array(0);var gt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};gt.DEFAULT_COLLECTION_PERCENTILE=10,gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gt.DEFAULT=new gt(41943040,gt.DEFAULT_COLLECTION_PERCENTILE,gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gt.DISABLED=new gt(-1,0,0);var As=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var od=class{constructor(){this.changes=new hn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ot.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ad=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var ud=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&vs(r.mutation,i,tt.empty(),Ce.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,X()).next(()=>r))}getLocalViewOfDocuments(e,t,r=X()){let i=Bn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=ps();return s.forEach((u,l)=>{o=o.insert(u,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Bn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,X()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{t.set(o,u)})})}computeViews(e,t,r,i){let s=Ut(),o=ys(),u=function(){return ys()}();return t.forEach((l,h)=>{let f=r.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof Et)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),vs(f.mutation,h,f.mutation.getFieldMask(),Ce.now())):o.set(h.key,tt.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((h,f)=>o.set(h,f)),t.forEach((h,f)=>{var y;return u.set(h,new ad(f,(y=o.get(h))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,t){let r=ys(),i=new de((o,u)=>o-u),s=X();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let u of o)u.keys().forEach(l=>{let h=t.get(l);if(h===null)return;let f=r.get(l)||tt.empty();f=u.applyToLocalView(h,f),r.set(l,f);let y=(i.get(u.batchId)||X()).add(l);i=i.insert(u.batchId,y)})}).next(()=>{let o=[],u=i.getReverseIterator();for(;u.hasNext();){let l=u.getNext(),h=l.key,f=l.value,y=Tv();f.forEach(w=>{if(!s.has(w)){let S=Pv(t.get(w),r.get(w));S!==null&&y.set(w,S),s=s.add(w)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,y))}return P.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return U.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):vv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(Bn()),u=-1,l=s;return o.next(h=>P.forEach(h,(f,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),s.get(f)?P.resolve():this.remoteDocumentCache.getEntry(e,f).next(w=>{l=l.insert(f,w)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,l,h,X())).next(f=>({batchId:u,changes:Iv(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new U(t)).next(r=>{let i=ps();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=ps();return this.indexManager.getCollectionParents(e,s).next(u=>P.forEach(u,l=>{let h=function(y,w){return new Wn(w,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(f=>{f.forEach((y,w)=>{o=o.insert(y,w)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,h)=>{let f=h.getKey();o.get(f)===null&&(o=o.insert(f,ot.newInvalidDocument(f)))});let u=ps();return o.forEach((l,h)=>{let f=s.get(l);f!==void 0&&vs(f.mutation,h,tt.empty(),Ce.now()),Ka(t,h)&&(u=u.insert(l,h))}),u})}};var cd=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return P.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:_t(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:Jb(i.bundledQuery),readTime:_t(i.readTime)}}(t)),P.resolve()}};var ld=class{constructor(){this.overlays=new de(U.comparator),this.hr=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Bn();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=Bn(),s=t.length+1,o=new U(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){let l=u.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new de((h,f)=>h-f),o=this.overlays.getIterator();for(;o.hasNext();){let h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let f=s.get(h.largestBatchId);f===null&&(f=Bn(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}let u=Bn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,f)=>u.set(h,f)),!(u.size()>=i)););return P.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Hh(t,r));let s=this.hr.get(t);s===void 0&&(s=X(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var Ds=class{constructor(){this.Pr=new Me(me.Ir),this.Tr=new Me(me.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new me(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new me(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new U(new ce([])),r=new me(t,e),i=new me(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new U(new ce([])),r=new me(t,e),i=new me(t,e+1),s=X();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new me(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},me=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return U.comparator(e.key,t.key)||re(e.pr,t.pr)}static Er(e,t){return re(e.pr,t.pr)||U.comparator(e.key,t.key)}};var hd=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Me(me.Ir)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Wh(s,t,r,i);this.mutationQueue.push(o);for(let u of i)this.wr=this.wr.add(new me(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return P.resolve(o)}lookupMutationBatch(e,t){return P.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new me(t,0),i=new me(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let u=this.Sr(o.pr);s.push(u)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Me(re);return t.forEach(i=>{let s=new me(i,0),o=new me(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],u=>{r=r.add(u.pr)})}),P.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;U.isDocumentKey(s)||(s=s.child(""));let o=new me(new U(s),0),u=new Me(re);return this.wr.forEachWhile(l=>{let h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(u=u.add(l.pr)),!0)},o),P.resolve(this.Dr(u))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ae(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return P.forEach(t.mutations,i=>{let s=new me(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new me(t,0),i=this.wr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var dd=class{constructor(e){this.vr=e,this.docs=function(){return new de(U.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():ot.newInvalidDocument(t))}getEntries(e,t){let r=Ut();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ot.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ut(),o=t.path,u=new U(o.child("")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){let{key:h,value:{document:f}}=l.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||ab(ob(f),r)<=0||(i.has(f.key)||Ka(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){$()}Fr(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new fd(this)}getSize(e){return P.resolve(this.size)}},fd=class extends od{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var pd=class{constructor(e){this.persistence=e,this.Mr=new hn(t=>rf(t),sf),this.lastRemoteSnapshotVersion=G.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Ds,this.targetCount=0,this.Lr=As.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),P.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new As(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.qn(t),P.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Nr.containsKey(t))}};var gd=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new cv(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new pd(this),this.indexManager=new id,this.remoteDocumentCache=function(i){return new dd(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new rd(t),this.$r=new cd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ld,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new hd(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){x("MemoryPersistence","Starting transaction:",e);let i=new md(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return P.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},md=class extends Ch{constructor(e){super(),this.currentSequenceNumber=e}},yd=class n{constructor(e){this.persistence=e,this.zr=new Ds,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw $()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),P.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Jr,r=>{let i=U.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,G.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return P.or([()=>P.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var vd=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=X(),i=X();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var _d=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var wd=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return mm()?8:cb(Ee())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new _d;return this.Ji(e,t,o).next(u=>{if(s.result=u,this.Ui)return this.Yi(e,t,o,u.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(fs()<=J.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",kr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),P.resolve()):(fs()<=J.DEBUG&&x("QueryEngine","Query:",kr(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(fs()<=J.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",kr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vt(t))):P.resolve())}ji(e,t){if(By(t))return P.resolve(null);let r=vt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=zh(t,null,"F"),r=vt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=X(...s);return this.zi.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,r).next(l=>{let h=this.Zi(t,u);return this.Xi(t,h,o,l.readTime)?this.ji(e,zh(t,null,"F")):this.es(e,h,t,l)}))})))}Hi(e,t,r,i){return By(t)||i.isEqual(G.min())?P.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?P.resolve(null):(fs()<=J.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),kr(t)),this.es(e,o,t,sb(i,-1)).next(u=>u))})}Zi(e,t){let r=new Me(wv(e));return t.forEach((i,s)=>{Ka(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return fs()<=J.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",kr(t)),this.zi.getDocumentsMatchingQuery(e,t,qn.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Ed=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new de(re),this.rs=new hn(s=>rf(s),sf),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ud(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function Xb(n,e,t,r){return new Ed(n,e,t,r)}function Bv(n,e){return m(this,null,function*(){let t=q(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],u=[],l=X();for(let h of i){o.push(h.batchId);for(let f of h.mutations)l=l.add(f.key)}for(let h of s){u.push(h.batchId);for(let f of h.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(r,l).next(h=>({us:h,removedBatchIds:o,addedBatchIds:u}))})})})}function Zb(n,e){let t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(u,l,h,f){let y=h.batch,w=y.keys(),S=P.resolve();return w.forEach(N=>{S=S.next(()=>f.getEntry(l,N)).next(O=>{let C=h.docVersions.get(N);ae(C!==null),O.version.compareTo(C)<0&&(y.applyToRemoteDocument(O,h),O.isValidDocument()&&(O.setReadTime(h.commitVersion),f.addEntry(O)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(l,y))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let l=X();for(let h=0;h<u.mutationResults.length;++h)u.mutationResults[h].transformResults.length>0&&(l=l.add(u.batch.mutations[h].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function $v(n){let e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function eS(n,e){let t=q(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let u=[];e.targetChanges.forEach((f,y)=>{let w=i.get(y);if(!w)return;u.push(t.Qr.removeMatchingKeys(s,f.removedDocuments,y).next(()=>t.Qr.addMatchingKeys(s,f.addedDocuments,y)));let S=w.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(y)!==null?S=S.withResumeToken(Le.EMPTY_BYTE_STRING,G.min()).withLastLimboFreeSnapshotVersion(G.min()):f.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(f.resumeToken,r)),i=i.insert(y,S),function(O,C,M){return O.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0}(w,S,f)&&u.push(t.Qr.updateTargetData(s,S))});let l=Ut(),h=X();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),u.push(tS(s,o,e.documentUpdates).next(f=>{l=f.cs,h=f.ls})),!r.isEqual(G.min())){let f=t.Qr.getLastRemoteSnapshotVersion(s).next(y=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(f)}return P.waitFor(u).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,h)).next(()=>l)}).then(s=>(t.ns=i,s))}function tS(n,e,t){let r=X(),i=X();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Ut();return t.forEach((u,l)=>{let h=s.get(u);l.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(u)),l.isNoDocument()&&l.version.isEqual(G.min())?(e.removeEntry(u,l.readTime),o=o.insert(u,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(u,l)):x("LocalStore","Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",l.version)}),{cs:o,ls:i}})}function nS(n,e){let t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function rS(n,e){let t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new Ts(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function Id(n,e,t){return m(this,null,function*(){let r=q(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ks(o))throw o;x("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function Jy(n,e,t){let r=q(n),i=G.min(),s=X();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,h,f){let y=q(l),w=y.rs.get(f);return w!==void 0?P.resolve(y.ns.get(w)):y.Qr.getTargetData(h,f)}(r,o,vt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,u.targetId).next(l=>{s=l})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:G.min(),t?s:X())).next(u=>(iS(r,_b(e),u),{documents:u,hs:s})))}function iS(n,e,t){let r=n.ss.get(e)||G.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}var Da=class{constructor(){this.activeTargetIds=Db()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Td=class{constructor(){this.no=new Da,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Da,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Ad=class{io(e){}shutdown(){}};var ba=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){x("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){x("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var ua=null;function yh(){return ua===null?ua=function(){return 268435456+Math.round(2147483648*Math.random())}():ua++,"0x"+ua.toString(16)}var sS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Dd=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var Oe="WebChannelConnection",bd=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let u=yh(),l=this.vo(t,r.toUriEncodedString());x("RestConnection",`Sending RPC '${t}' ${u}:`,l,i);let h={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(h,s,o),this.Mo(t,l,h,i).then(f=>(x("RestConnection",`Received RPC '${t}' ${u}: `,f),f),f=>{throw Vr("RestConnection",`RPC '${t}' ${u} failed with error: `,f,"url: ",l,"request:",i),f})}xo(t,r,i,s,o,u){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=sS[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=yh();return new Promise((o,u)=>{let l=new lh;l.setWithCredentials(!0),l.listenOnce(dh.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ds.NO_ERROR:let f=l.getResponseJson();x(Oe,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case ds.TIMEOUT:x(Oe,`RPC '${e}' ${s} timed out`),u(new F(R.DEADLINE_EXCEEDED,"Request time out"));break;case ds.HTTP_ERROR:let y=l.getStatus();if(x(Oe,`RPC '${e}' ${s} failed with status:`,y,"response text:",l.getResponseText()),y>0){let w=l.getResponseJson();Array.isArray(w)&&(w=w[0]);let S=w?.error;if(S&&S.status&&S.message){let N=function(C){let M=C.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(M)>=0?M:R.UNKNOWN}(S.status);u(new F(N,S.message))}else u(new F(R.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new F(R.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{x(Oe,`RPC '${e}' ${s} completed.`)}});let h=JSON.stringify(i);x(Oe,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,r,15)})}Oo(e,t,r){let i=yh(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=gh(),u=ph(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.xmlHttpFactory=new hh({})),this.Fo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let f=s.join("");x(Oe,`Creating RPC '${e}' stream ${i}: ${f}`,l);let y=o.createWebChannel(f,l),w=!1,S=!1,N=new Dd({lo:C=>{S?x(Oe,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(w||(x(Oe,`Opening RPC '${e}' stream ${i} transport.`),y.open(),w=!0),x(Oe,`RPC '${e}' stream ${i} sending:`,C),y.send(C))},ho:()=>y.close()}),O=(C,M,j)=>{C.listen(M,Y=>{try{j(Y)}catch(K){setTimeout(()=>{throw K},0)}})};return O(y,Nr.EventType.OPEN,()=>{S||(x(Oe,`RPC '${e}' stream ${i} transport opened.`),N.mo())}),O(y,Nr.EventType.CLOSE,()=>{S||(S=!0,x(Oe,`RPC '${e}' stream ${i} transport closed`),N.po())}),O(y,Nr.EventType.ERROR,C=>{S||(S=!0,Vr(Oe,`RPC '${e}' stream ${i} transport errored:`,C),N.po(new F(R.UNAVAILABLE,"The operation could not be completed")))}),O(y,Nr.EventType.MESSAGE,C=>{var M;if(!S){let j=C.data[0];ae(!!j);let Y=j,K=Y.error||((M=Y[0])===null||M===void 0?void 0:M.error);if(K){x(Oe,`RPC '${e}' stream ${i} received error:`,K);let ve=K.status,ne=function(_){let E=ge[_];if(E!==void 0)return kv(E)}(ve),I=K.message;ne===void 0&&(ne=R.INTERNAL,I="Unknown error status: "+ve+" with message "+K.message),S=!0,N.po(new F(ne,I)),y.close()}else x(Oe,`RPC '${e}' stream ${i} received:`,j),N.yo(j)}}),O(u,fh.STAT_EVENT,C=>{C.stat===oa.PROXY?x(Oe,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===oa.NOPROXY&&x(Oe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.fo()},0),N}};function vh(){return typeof document<"u"?document:null}function Ha(n){return new Xh(n,!0)}var Sa=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&x("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var Ca=class{constructor(e,t,r,i,s,o,u,l){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Sa(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return m(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return m(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return m(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Lt(t.toString()),Lt("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new F(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>m(this,null,function*(){this.state=0,this.start()}))}c_(e){return x("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(x("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Sd=class extends Ca{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=Bb(this.serializer,e),r=function(s){if(!("targetChange"in s))return G.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?G.min():o.readTime?_t(o.readTime):G.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=nd(this.serializer),t.addTarget=function(s,o){let u,l=o.target;if(u=$h(l)?{documents:zb(s,l)}:{query:qb(s,l)._t},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=Ov(s,o.resumeToken);let h=Zh(s,o.expectedCount);h!==null&&(u.expectedCount=h)}else if(o.snapshotVersion.compareTo(G.min())>0){u.readTime=Ta(s,o.snapshotVersion.toTimestamp());let h=Zh(s,o.expectedCount);h!==null&&(u.expectedCount=h)}return u}(this.serializer,e);let r=Wb(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=nd(this.serializer),t.removeTarget=e,this.i_(t)}},Cd=class extends Ca{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(ae(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=jb(e.writeResults,e.commitTime),r=_t(e.commitTime);return this.listener.A_(r,t)}return ae(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=nd(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>$b(this.serializer,r))};this.i_(t)}};var Rd=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new F(R.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,ed(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new F(R.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.xo(e,ed(t,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new F(R.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},Pd=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Lt(t),this.y_=!1):x("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var Nd=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>m(this,null,function*(){Xn(this)&&(x("RemoteStore","Restarting streams for network reachability change."),yield function(l){return m(this,null,function*(){let h=q(l);h.M_.add(4),yield Os(h),h.N_.set("Unknown"),h.M_.delete(4),yield Qa(h)})}(this))}))}),this.N_=new Pd(r,i)}};function Qa(n){return m(this,null,function*(){if(Xn(n))for(let e of n.x_)yield e(!0)})}function Os(n){return m(this,null,function*(){for(let e of n.x_)yield e(!1)})}function jv(n,e){let t=q(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),hf(t)?lf(t):Xr(t).Xo()&&cf(t,e))}function uf(n,e){let t=q(n),r=Xr(t);t.F_.delete(e),r.Xo()&&zv(t,e),t.F_.size===0&&(r.Xo()?r.n_():Xn(t)&&t.N_.set("Unknown"))}function cf(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(G.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Xr(n).P_(e)}function zv(n,e){n.L_.xe(e),Xr(n).I_(e)}function lf(n){n.L_=new Jh({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Xr(n).start(),n.N_.w_()}function hf(n){return Xn(n)&&!Xr(n).Zo()&&n.F_.size>0}function Xn(n){return q(n).M_.size===0}function qv(n){n.L_=void 0}function oS(n){return m(this,null,function*(){n.N_.set("Online")})}function aS(n){return m(this,null,function*(){n.F_.forEach((e,t)=>{cf(n,e)})})}function uS(n,e){return m(this,null,function*(){qv(n),hf(n)?(n.N_.D_(e),lf(n)):n.N_.set("Unknown")})}function cS(n,e,t){return m(this,null,function*(){if(n.N_.set("Online"),e instanceof Ea&&e.state===2&&e.cause)try{yield function(i,s){return m(this,null,function*(){let o=s.cause;for(let u of s.targetIds)i.F_.has(u)&&(yield i.remoteSyncer.rejectListen(u,o),i.F_.delete(u),i.L_.removeTarget(u))})}(n,e)}catch(r){x("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Ra(n,r)}else if(e instanceof xr?n.L_.Ke(e):e instanceof wa?n.L_.He(e):n.L_.We(e),!t.isEqual(G.min()))try{let r=yield $v(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let u=s.L_.rt(o);return u.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){let f=s.F_.get(h);f&&s.F_.set(h,f.withResumeToken(l.resumeToken,o))}}),u.targetMismatches.forEach((l,h)=>{let f=s.F_.get(l);if(!f)return;s.F_.set(l,f.withResumeToken(Le.EMPTY_BYTE_STRING,f.snapshotVersion)),zv(s,l);let y=new Ts(f.target,l,h,f.sequenceNumber);cf(s,y)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){x("RemoteStore","Failed to raise snapshot:",r),yield Ra(n,r)}})}function Ra(n,e,t){return m(this,null,function*(){if(!ks(e))throw e;n.M_.add(1),yield Os(n),n.N_.set("Offline"),t||(t=()=>$v(n.localStore)),n.asyncQueue.enqueueRetryable(()=>m(this,null,function*(){x("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield Qa(n)}))})}function Gv(n,e){return e().catch(t=>Ra(n,t,e))}function Ya(n){return m(this,null,function*(){let e=q(n),t=dn(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;lS(e);)try{let i=yield nS(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,hS(e,i)}catch(i){yield Ra(e,i)}Wv(e)&&Kv(e)})}function lS(n){return Xn(n)&&n.v_.length<10}function hS(n,e){n.v_.push(e);let t=dn(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function Wv(n){return Xn(n)&&!dn(n).Zo()&&n.v_.length>0}function Kv(n){dn(n).start()}function dS(n){return m(this,null,function*(){dn(n).V_()})}function fS(n){return m(this,null,function*(){let e=dn(n);for(let t of n.v_)e.d_(t.mutations)})}function pS(n,e,t){return m(this,null,function*(){let r=n.v_.shift(),i=Kh.from(r,e,t);yield Gv(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Ya(n)})}function gS(n,e){return m(this,null,function*(){e&&dn(n).E_&&(yield function(r,i){return m(this,null,function*(){if(function(o){return kb(o)&&o!==R.ABORTED}(i.code)){let s=r.v_.shift();dn(r).t_(),yield Gv(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Ya(r)}})}(n,e)),Wv(n)&&Kv(n)})}function Xy(n,e){return m(this,null,function*(){let t=q(n);t.asyncQueue.verifyOperationInProgress(),x("RemoteStore","RemoteStore received new credentials");let r=Xn(t);t.M_.add(3),yield Os(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield Qa(t)})}function mS(n,e){return m(this,null,function*(){let t=q(n);e?(t.M_.delete(2),yield Qa(t)):e||(t.M_.add(2),yield Os(t),t.N_.set("Unknown"))})}function Xr(n){return n.B_||(n.B_=function(t,r,i){let s=q(t);return s.f_(),new Sd(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:oS.bind(null,n),To:aS.bind(null,n),Ao:uS.bind(null,n),h_:cS.bind(null,n)}),n.x_.push(e=>m(this,null,function*(){e?(n.B_.t_(),hf(n)?lf(n):n.N_.set("Unknown")):(yield n.B_.stop(),qv(n))}))),n.B_}function dn(n){return n.k_||(n.k_=function(t,r,i){let s=q(t);return s.f_(),new Cd(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:dS.bind(null,n),Ao:gS.bind(null,n),R_:fS.bind(null,n),A_:pS.bind(null,n)}),n.x_.push(e=>m(this,null,function*(){e?(n.k_.t_(),yield Ya(n)):(yield n.k_.stop(),n.v_.length>0&&(x("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var kd=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new mt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,u=new n(e,t,o,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function df(n,e){if(Lt("AsyncQueue",`${e}: ${n}`),ks(n))return new F(R.UNAVAILABLE,`${e}: ${n}`);throw n}var Pa=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||U.comparator(t.key,r.key):(t,r)=>U.comparator(t.key,r.key),this.keyedMap=ps(),this.sortedSet=new de(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Na=class{constructor(){this.q_=new de(U.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):$():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},Hr=class n{constructor(e,t,r,i,s,o,u,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(u=>{o.push({type:0,doc:u})}),new n(e,t,Pa.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Od=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},Md=class{constructor(){this.queries=new hn(e=>_v(e),Wa),this.onlineState="Unknown",this.z_=new Set}};function Hv(n,e){return m(this,null,function*(){let t=q(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new Od,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let u=df(o,`Initialization of query '${kr(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&ff(t)})}function Qv(n,e){return m(this,null,function*(){let t=q(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function yS(n,e){let t=q(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let u of o.U_)u.H_(i)&&(r=!0);o.K_=i}}r&&ff(t)}function vS(n,e,t){let r=q(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function ff(n){n.z_.forEach(e=>{e.next()})}var Fd,Zy;(Zy=Fd||(Fd={})).J_="default",Zy.Cache="cache";var ka=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Hr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Hr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Fd.Cache}};var Oa=class{constructor(e){this.key=e}},Ma=class{constructor(e){this.key=e}},xd=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=X(),this.mutatedKeys=X(),this.Ia=wv(e),this.Ta=new Pa(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new Na,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,y)=>{let w=i.get(f),S=Ka(this.query,y)?y:null,N=!!w&&this.mutatedKeys.has(w.key),O=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),C=!1;w&&S?w.data.isEqual(S.data)?N!==O&&(r.track({type:3,doc:S}),C=!0):this.Ra(w,S)||(r.track({type:2,doc:S}),C=!0,(l&&this.Ia(S,l)>0||h&&this.Ia(S,h)<0)&&(u=!0)):!w&&S?(r.track({type:0,doc:S}),C=!0):w&&!S&&(r.track({type:1,doc:w}),C=!0,(l||h)&&(u=!0)),C&&(S?(o=o.add(S),s=O?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{Ta:o,Aa:r,Xi:u,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((f,y)=>function(S,N){let O=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return O(S)-O(N)}(f.type,y.type)||this.Ia(f.doc,y.doc)),this.Va(r),i=i!=null&&i;let u=t&&!i?this.ma():[],l=this.Pa.size===0&&this.current&&!i?1:0,h=l!==this.ha;return this.ha=l,o.length!==0||h?{snapshot:new Hr(this.query,e.Ta,s,o,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:u}:{fa:u}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new Na,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=X(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new Ma(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new Oa(r))}),t}pa(e){this.la=e.hs,this.Pa=X();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Hr.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},Ld=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Vd=class{constructor(e){this.key=e,this.wa=!1}},Ud=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new hn(u=>_v(u),Wa),this.Da=new Map,this.Ca=new Set,this.va=new de(U.comparator),this.Fa=new Map,this.Ma=new Ds,this.xa={},this.Oa=new Map,this.Na=As.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function _S(n,e,t=!0){return m(this,null,function*(){let r=t_(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield Yv(r,e,t,!0),i})}function wS(n,e){return m(this,null,function*(){let t=t_(n);yield Yv(t,e,!0,!1)})}function Yv(n,e,t,r){return m(this,null,function*(){let i=yield rS(n.localStore,vt(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",u;return r&&(u=yield ES(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&jv(n.remoteStore,i),u})}function ES(n,e,t,r,i){return m(this,null,function*(){n.Ba=(y,w,S)=>function(O,C,M,j){return m(this,null,function*(){let Y=C.view.da(M);Y.Xi&&(Y=yield Jy(O.localStore,C.query,!1).then(({documents:I})=>C.view.da(I,Y)));let K=j&&j.targetChanges.get(C.targetId),ve=j&&j.targetMismatches.get(C.targetId)!=null,ne=C.view.applyChanges(Y,O.isPrimaryClient,K,ve);return tv(O,C.targetId,ne.fa),ne.snapshot})}(n,y,w,S);let s=yield Jy(n.localStore,e,!0),o=new xd(e,s.hs),u=o.da(s.documents),l=Is.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=o.applyChanges(u,n.isPrimaryClient,l);tv(n,t,h.fa);let f=new Ld(e,t,o);return n.ba.set(e,f),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),h.snapshot})}function IS(n,e,t){return m(this,null,function*(){let r=q(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!Wa(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Id(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&uf(r.remoteStore,i.targetId),Bd(r,i.targetId)}).catch(Ns))):(Bd(r,i.targetId),yield Id(r.localStore,i.targetId,!0))})}function TS(n,e){return m(this,null,function*(){let t=q(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),uf(t.remoteStore,r.targetId))})}function AS(n,e,t){return m(this,null,function*(){let r=NS(n);try{let i=yield function(o,u){let l=q(o),h=Ce.now(),f=u.reduce((S,N)=>S.add(N.key),X()),y,w;return l.persistence.runTransaction("Locally write mutations","readwrite",S=>{let N=Ut(),O=X();return l.os.getEntries(S,f).next(C=>{N=C,N.forEach((M,j)=>{j.isValidDocument()||(O=O.add(M))})}).next(()=>l.localDocuments.getOverlayedDocuments(S,N)).next(C=>{y=C;let M=[];for(let j of u){let Y=Nb(j,y.get(j.key).overlayedDocument);Y!=null&&M.push(new Et(j.key,Y,dv(Y.value.mapValue),un.exists(!0)))}return l.mutationQueue.addMutationBatch(S,h,M,u)}).next(C=>{w=C;let M=C.applyToLocalDocumentSet(y,O);return l.documentOverlayCache.saveOverlays(S,C.batchId,M)})}).then(()=>({batchId:w.batchId,changes:Iv(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,l){let h=o.xa[o.currentUser.toKey()];h||(h=new de(re)),h=h.insert(u,l),o.xa[o.currentUser.toKey()]=h}(r,i.batchId,t),yield Ms(r,i.changes),yield Ya(r.remoteStore)}catch(i){let s=df(i,"Failed to persist write");t.reject(s)}})}function Jv(n,e){return m(this,null,function*(){let t=q(n);try{let r=yield eS(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(ae(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?ae(o.wa):i.removedDocuments.size>0&&(ae(o.wa),o.wa=!1))}),yield Ms(t,r,e)}catch(r){yield Ns(r)}})}function ev(n,e,t){let r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let u=o.view.j_(e);u.snapshot&&i.push(u.snapshot)}),function(o,u){let l=q(o);l.onlineState=u;let h=!1;l.queries.forEach((f,y)=>{for(let w of y.U_)w.j_(u)&&(h=!0)}),h&&ff(l)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function DS(n,e,t){return m(this,null,function*(){let r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new de(U.comparator);o=o.insert(s,ot.newNoDocument(s,G.min()));let u=X().add(s),l=new _a(G.min(),new Map,new de(re),o,u);yield Jv(r,l),r.va=r.va.remove(s),r.Fa.delete(e),pf(r)}else yield Id(r.localStore,e,!1).then(()=>Bd(r,e,t)).catch(Ns)})}function bS(n,e){return m(this,null,function*(){let t=q(n),r=e.batch.batchId;try{let i=yield Zb(t.localStore,e);Zv(t,r,null),Xv(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ms(t,i)}catch(i){yield Ns(i)}})}function SS(n,e,t){return m(this,null,function*(){let r=q(n);try{let i=yield function(o,u){let l=q(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return l.mutationQueue.lookupMutationBatch(h,u).next(y=>(ae(y!==null),f=y.keys(),l.mutationQueue.removeMutationBatch(h,y))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,f,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>l.localDocuments.getDocuments(h,f))})}(r.localStore,e);Zv(r,e,t),Xv(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ms(r,i)}catch(i){yield Ns(i)}})}function Xv(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function Zv(n,e,t){let r=q(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Bd(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||e_(n,r)})}function e_(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(uf(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),pf(n))}function tv(n,e,t){for(let r of t)r instanceof Oa?(n.Ma.addReference(r.key,e),CS(n,r)):r instanceof Ma?(x("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||e_(n,r.key)):$()}function CS(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(x("SyncEngine","New document in limbo: "+t),n.Ca.add(r),pf(n))}function pf(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new U(ce.fromString(e)),r=n.Na.next();n.Fa.set(r,new Vd(t)),n.va=n.va.insert(t,r),jv(n.remoteStore,new Ts(vt(of(t.path)),r,"TargetPurposeLimboResolution",cv.oe))}}function Ms(n,e,t){return m(this,null,function*(){let r=q(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((u,l)=>{o.push(r.Ba(l,e,t).then(h=>{if((h||t)&&r.isPrimaryClient){let f=h&&!h.fromCache;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(h){i.push(h);let f=vd.Ki(l.targetId,h);s.push(f)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(l,h){return m(this,null,function*(){let f=q(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>P.forEach(h,w=>P.forEach(w.qi,S=>f.persistence.referenceDelegate.addReference(y,w.targetId,S)).next(()=>P.forEach(w.Qi,S=>f.persistence.referenceDelegate.removeReference(y,w.targetId,S)))))}catch(y){if(!ks(y))throw y;x("LocalStore","Failed to update sequence numbers: "+y)}for(let y of h){let w=y.targetId;if(!y.fromCache){let S=f.ns.get(w),N=S.snapshotVersion,O=S.withLastLimboFreeSnapshotVersion(N);f.ns=f.ns.insert(w,O)}}})}(r.localStore,s))})}function RS(n,e){return m(this,null,function*(){let t=q(n);if(!t.currentUser.isEqual(e)){x("SyncEngine","User change. New user:",e.toKey());let r=yield Bv(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(u=>{u.forEach(l=>{l.reject(new F(R.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ms(t,r.us)}})}function PS(n,e){let t=q(n),r=t.Fa.get(e);if(r&&r.wa)return X().add(r.key);{let i=X(),s=t.Da.get(e);if(!s)return i;for(let o of s){let u=t.ba.get(o);i=i.unionWith(u.view.Ea)}return i}}function t_(n){let e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=PS.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=DS.bind(null,e),e.Sa.h_=yS.bind(null,e.eventManager),e.Sa.ka=vS.bind(null,e.eventManager),e}function NS(n){let e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bS.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SS.bind(null,e),e}var Fa=class{constructor(){this.synchronizeTabs=!1}initialize(e){return m(this,null,function*(){this.serializer=Ha(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Xb(this.persistence,new wd,e.initialUser,this.serializer)}createPersistence(e){return new gd(yd.Hr,this.serializer)}createSharedClientState(e){return new Td}terminate(){return m(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var $d=class{initialize(e,t){return m(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ev(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=RS.bind(null,this.syncEngine),yield mS(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Md}()}createDatastore(e){let t=Ha(e.databaseInfo.databaseId),r=function(s){return new bd(s)}(e.databaseInfo);return function(s,o,u,l){return new Rd(s,o,u,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,u){return new Nd(r,i,s,o,u)}(this.localStore,this.datastore,e.asyncQueue,t=>ev(this.syncEngine,t,0),function(){return ba.D()?new ba:new Ad}())}createSyncEngine(e,t){return function(i,s,o,u,l,h,f){let y=new Ud(i,s,o,u,l,h);return f&&(y.La=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return m(this,null,function*(){var e;yield function(r){return m(this,null,function*(){let i=q(r);x("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Os(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};var xa=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Lt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var jd=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=De.UNAUTHENTICATED,this.clientId=da.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>m(this,null,function*(){x("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(x("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new F(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new mt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>m(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=df(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function _h(n,e){return m(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),x("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>m(this,null,function*(){r.isEqual(i)||(yield Bv(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function nv(n,e){return m(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield OS(n);x("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Xy(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Xy(e.remoteStore,i)),n._onlineComponents=e})}function kS(n){return n.name==="FirebaseError"?n.code===R.FAILED_PRECONDITION||n.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function OS(n){return m(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){x("FirestoreClient","Using user provided OfflineComponentProvider");try{yield _h(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!kS(t))throw t;Vr("Error using user provided cache. Falling back to memory cache: "+t),yield _h(n,new Fa)}}else x("FirestoreClient","Using default OfflineComponentProvider"),yield _h(n,new Fa);return n._offlineComponents})}function n_(n){return m(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(x("FirestoreClient","Using user provided OnlineComponentProvider"),yield nv(n,n._uninitializedComponentsProvider._online)):(x("FirestoreClient","Using default OnlineComponentProvider"),yield nv(n,new $d))),n._onlineComponents})}function MS(n){return n_(n).then(e=>e.syncEngine)}function zd(n){return m(this,null,function*(){let e=yield n_(n),t=e.eventManager;return t.onListen=_S.bind(null,e.syncEngine),t.onUnlisten=IS.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wS.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=TS.bind(null,e.syncEngine),t})}function FS(n,e,t={}){let r=new mt;return n.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return function(s,o,u,l,h){let f=new xa({next:w=>{o.enqueueAndForget(()=>Qv(s,y)),w.fromCache&&l.source==="server"?h.reject(new F(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(w)},error:w=>h.reject(w)}),y=new ka(u,f,{includeMetadataChanges:!0,ra:!0});return Hv(s,y)}(yield zd(n),n.asyncQueue,e,t,r)})),r.promise}function r_(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var rv=new Map;function i_(n,e,t){if(!t)throw new F(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function xS(n,e,t,r){if(e===!0&&r===!0)throw new F(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function iv(n){if(!U.isDocumentKey(n))throw new F(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function sv(n){if(U.isDocumentKey(n))throw new F(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ja(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$()}function xt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Ja(n);throw new F(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var La=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new F(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new F(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=r_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new F(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new F(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new F(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Qr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new La({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new F(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new F(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new La(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new wh;switch(r.type){case"firstParty":return new Ah(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=rv.get(t);r&&(x("ComponentProvider","Removing Datastore"),rv.delete(t),r.terminate())}(this),Promise.resolve()}};function s_(n,e,t,r={}){var i;let s=(n=xt(n,Qr))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Vr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let u,l;if(typeof r.mockUserToken=="string")u=r.mockUserToken,l=De.MOCK_USER;else{u=hm(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new F(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new De(h)}n._authCredentials=new Eh(new ha(u,l))}}var Yn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},je=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},cn=class n extends Yn{constructor(e,t,r){super(e,t,of(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new je(this.firestore,null,new U(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function o_(n,e,...t){if(n=pe(n),i_("collection","path",e),n instanceof Qr){let r=ce.fromString(e,...t);return sv(r),new cn(n,null,r)}{if(!(n instanceof je||n instanceof cn))throw new F(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return sv(r),new cn(n.firestore,null,r)}}function gf(n,e,...t){if(n=pe(n),arguments.length===1&&(e=da.newId()),i_("doc","path",e),n instanceof Qr){let r=ce.fromString(e,...t);return iv(r),new je(n,null,new U(r))}{if(!(n instanceof je||n instanceof cn))throw new F(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return iv(r),new je(n.firestore,n instanceof cn?n.converter:null,new U(r))}}var qd=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Sa(this,"async_queue_retry"),this.hu=()=>{let t=vh();t&&x("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=vh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=vh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new mt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return m(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!ks(e))throw e;x("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u}(r);throw Lt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=kd.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&$()}verifyOperationInProgress(){}du(){return m(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function ov(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var fn=class extends Qr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new qd}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||u_(this),this._firestoreClient.terminate()}};function a_(n,e){let t=typeof n=="object"?n:Ar(),r=typeof n=="string"?n:e||"(default)",i=ns(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=lm("firestore");s&&s_(i,...s)}return i}function mf(n){return n._firestoreClient||u_(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function u_(n){var e,t,r;let i=n._freezeSettings(),s=function(u,l,h,f){return new Rh(u,l,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,r_(f.experimentalLongPollingOptions),f.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new jd(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var bs=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Le.fromBase64String(e))}catch(t){throw new F(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Le.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Yr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ss=class{constructor(e){this._methodName=e}};var Cs=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return re(this._lat,e._lat)||re(this._long,e._long)}};var LS=/^__.*__$/,Gd=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Et(e,this.data,this.fieldMask,t,this.fieldTransforms):new Qn(e,this.data,t,this.fieldTransforms)}},Va=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Et(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function c_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}var Wd=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Ba(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(c_(this.fu)&&LS.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},Kd=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ha(e)}Fu(e,t,r,i=!1){return new Wd({fu:e,methodName:t,vu:r,path:Qe.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function yf(n){let e=n._freezeSettings(),t=Ha(n._databaseId);return new Kd(n._databaseId,!!e.ignoreUndefinedProperties,t)}function VS(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);vf("Data must be an object, but it was:",o,r);let u=l_(r,o),l,h;if(s.merge)l=new tt(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){let f=[];for(let y of s.mergeFields){let w=Hd(e,y,t);if(!o.contains(w))throw new F(R.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);d_(f,w)||f.push(w)}l=new tt(f),h=o.fieldTransforms.filter(y=>l.covers(y.field))}else l=null,h=o.fieldTransforms;return new Gd(new He(u),l,h)}var Ua=class n extends Ss{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function US(n,e,t,r){let i=n.Fu(1,e,t);vf("Data must be an object, but it was:",i,r);let s=[],o=He.empty();Jn(r,(l,h)=>{let f=_f(e,l,t);h=pe(h);let y=i.Su(f);if(h instanceof Ua)s.push(f);else{let w=Fs(h,y);w!=null&&(s.push(f),o.set(f,w))}});let u=new tt(s);return new Va(o,u,i.fieldTransforms)}function BS(n,e,t,r,i,s){let o=n.Fu(1,e,t),u=[Hd(e,r,t)],l=[i];if(s.length%2!=0)throw new F(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<s.length;w+=2)u.push(Hd(e,s[w])),l.push(s[w+1]);let h=[],f=He.empty();for(let w=u.length-1;w>=0;--w)if(!d_(h,u[w])){let S=u[w],N=l[w];N=pe(N);let O=o.Su(S);if(N instanceof Ua)h.push(S);else{let C=Fs(N,O);C!=null&&(h.push(S),f.set(S,C))}}let y=new tt(h);return new Va(f,y,o.fieldTransforms)}function $S(n,e,t,r=!1){return Fs(t,n.Fu(r?4:3,e))}function Fs(n,e){if(h_(n=pe(n)))return vf("Unsupported field value:",e,n),l_(n,e);if(n instanceof Ss)return function(r,i){if(!c_(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let u of r){let l=Fs(u,i.bu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=pe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return bb(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ce.fromDate(r);return{timestampValue:Ta(i.serializer,s)}}if(r instanceof Ce){let s=new Ce(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ta(i.serializer,s)}}if(r instanceof Cs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof bs)return{bytesValue:Ov(i.serializer,r._byteString)};if(r instanceof je){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:af(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${Ja(r)}`)}(n,e)}function l_(n,e){let t={};return lv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jn(n,(r,i)=>{let s=Fs(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function h_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ce||n instanceof Cs||n instanceof bs||n instanceof je||n instanceof Ss)}function vf(n,e,t){if(!h_(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Ja(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function Hd(n,e,t){if((e=pe(e))instanceof Yr)return e._internalPath;if(typeof e=="string")return _f(n,e);throw Ba("Field path arguments must be of type string or ",n,!1,void 0,t)}var jS=new RegExp("[~\\*/\\[\\]]");function _f(n,e,t){if(e.search(jS)>=0)throw Ba(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Yr(...e.split("."))._internalPath}catch{throw Ba(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ba(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new F(R.INVALID_ARGUMENT,u+n+l)}function d_(n,e){return n.some(t=>t.isEqual(e))}var $a=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Qd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(wf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Qd=class extends $a{data(){return super.data()}};function wf(n,e){return typeof e=="string"?_f(n,e):e instanceof Yr?e._internalPath:e._delegate._internalPath}function f_(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Rs=class{},Yd=class extends Rs{};function p_(n,e,...t){let r=[];e instanceof Rs&&r.push(e),r=r.concat(t),function(s){let o=s.filter(l=>l instanceof Jd).length,u=s.filter(l=>l instanceof ja).length;if(o>1||o>0&&u>0)throw new F(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var ja=class n extends Yd{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return m_(e._query,t),new Yn(e.firestore,e.converter,jh(e._query,t))}_parse(e){let t=yf(e.firestore);return function(s,o,u,l,h,f,y){let w;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new F(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){uv(y,f);let S=[];for(let N of y)S.push(av(l,s,N));w={arrayValue:{values:S}}}else w=av(l,s,y)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||uv(y,f),w=$S(u,o,y,f==="in"||f==="not-in");return ye.create(h,f,w)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function g_(n,e,t){let r=e,i=wf("where",n);return ja._create(i,r,t)}var Jd=class n extends Rs{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:at.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,u=s.getFlattenedFilters();for(let l of u)m_(o,l),o=jh(o,l)}(e._query,t),new Yn(e.firestore,e.converter,jh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function av(n,e,t){if(typeof(t=pe(t))=="string"){if(t==="")throw new F(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vv(e)&&t.indexOf("/")!==-1)throw new F(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ce.fromString(t));if(!U.isDocumentKey(r))throw new F(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return My(n,new U(r))}if(t instanceof je)return My(n,t._key);throw new F(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ja(t)}.`)}function uv(n,e){if(!Array.isArray(n)||n.length===0)throw new F(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function m_(n,e){let t=function(i,s){for(let o of i)for(let u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new F(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new F(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Xd=class{convertValue(e,t="none"){switch(Gn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return he(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ln(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw $()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Jn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Cs(he(e.latitude),he(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=tf(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ws(e));default:return null}}convertTimestamp(e){let t=Vt(e);return new Ce(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ce.fromString(e);ae(Uv(r));let i=new ma(r.get(1),r.get(3)),s=new U(r.popFirst(5));return i.isEqual(t)||Lt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function zS(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var jn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},za=class extends $a{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Lr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(wf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Lr=class extends za{data(e={}){return super.data(e)}},qa=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new jn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Lr(this._firestore,this._userDataWriter,r.key,r,new jn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{let l=new Lr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new jn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let l=new Lr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new jn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),h=-1,f=-1;return u.type!==0&&(h=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),f=o.indexOf(u.doc.key)),{type:qS(u.type),doc:l,oldIndex:h,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function qS(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}var Ps=class extends Xd{constructor(e){super(),this.firestore=e}convertBytes(e){return new bs(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,t)}};function y_(n){n=xt(n,Yn);let e=xt(n.firestore,fn),t=mf(e),r=new Ps(e);return f_(n._query),FS(t,n._query).then(i=>new qa(e,r,n,i))}function v_(n,e,t,...r){n=xt(n,je);let i=xt(n.firestore,fn),s=yf(i),o;return o=typeof(e=pe(e))=="string"||e instanceof Yr?BS(s,"updateDoc",n._key,e,t,r):US(s,"updateDoc",n._key,e),w_(i,[o.toMutation(n._key,un.exists(!0))])}function __(n,e){let t=xt(n.firestore,fn),r=gf(n),i=zS(n.converter,e);return w_(t,[VS(yf(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,un.exists(!1))]).then(()=>r)}function Ef(n,...e){var t,r,i;n=pe(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||ov(e[o])||(s=e[o],o++);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ov(e[o])){let y=e[o];e[o]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[o+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[o+2]=(i=y.complete)===null||i===void 0?void 0:i.bind(y)}let l,h,f;if(n instanceof je)h=xt(n.firestore,fn),f=of(n._key.path),l={next:y=>{e[o]&&e[o](GS(h,n,y))},error:e[o+1],complete:e[o+2]};else{let y=xt(n,Yn);h=xt(y.firestore,fn),f=y._query;let w=new Ps(h);l={next:S=>{e[o]&&e[o](new qa(h,w,y,S))},error:e[o+1],complete:e[o+2]},f_(n._query)}return function(w,S,N,O){let C=new xa(O),M=new ka(S,C,N);return w.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return Hv(yield zd(w),M)})),()=>{C.$a(),w.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return Qv(yield zd(w),M)}))}}(mf(h),f,u,l)}function w_(n,e){return function(r,i){let s=new mt;return r.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return AS(yield MS(r),i,s)})),s.promise}(mf(n),e)}function GS(n,e,t){let r=t.docs.get(e._key),i=new Ps(n);return new za(n,i,e._key,r,new jn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Jr=i})(rn),nn(new et("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),u=new fn(new Ih(r.getProvider("auth-internal")),new bh(r.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new F(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ma(h.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Ie(Ny,"4.6.3",e),Ie(Ny,"4.6.3","esm2017")})();var Xa=function(){return Xa=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Xa.apply(this,arguments)};var HS={includeMetadataChanges:!1};function E_(n,e){return e===void 0&&(e=HS),new _n(function(t){var r=Ef(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function I_(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Xa(Xa({},r),(t={},t[e.idField]=n.id,t))}function T_(n){return E_(n,{includeMetadataChanges:!0}).pipe(ee(function(e){return e.docs}))}function A_(n,e){return e===void 0&&(e={}),T_(n).pipe(ee(function(t){return t.map(function(r){return I_(r,e)})}))}var Bt=class{constructor(e){return e}},D_="firestore",If=class{constructor(){return rs(D_)}};var Tf=new se("angularfire2.firestore-instances");function QS(n,e){let t=Lo(D_,n,e);return t&&new Bt(t)}function YS(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Bt(r)}}var JS={provide:If,deps:[[new Ue,Tf]]},XS={provide:Bt,useFactory:QS,deps:[[new Ue,Tf],Pt]},ZS=(()=>{class n{constructor(){Ie("angularfire",On.full,"fst")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=it({type:n});static \u0275inj=rt({providers:[XS,JS]})}return n})();function DO(n,...e){return{ngModule:ZS,providers:[{provide:Tf,useFactory:YS(n),multi:!0,deps:[we,St,Sr,Mn,[new Ue,hs],[new Ue,br],...e]}]}}var Af=Ae(A_,!0);var Za=Ae(__,!0);var ze=Ae(o_,!0);var Df=Ae(gf,!0);var pn=Ae(y_,!0);var bO=Ae(a_,!0);var Zr=Ae(p_,!0);var eu=Ae(v_,!0);var Zn=Ae(g_,!0);var b_=(()=>{let e=class e{constructor(){this.firestore=L(Bt)}agregarFirestorePaciente(r,i){return m(this,null,function*(){yield Za(ze(this.firestore,"pacientes"),{nombre:r.get("nombre")?.value,apellido:r.get("apellido")?.value,edad:r.get("edad")?.value,dni:r.get("dni")?.value,obrasocial:r.get("obrasocial")?.value,email:r.get("email")?.value,password:r.get("password")?.value,imagenes:i,tipo:"paciente",fecha:new Date})})}agregarFirestoreProfesional(r,i){return m(this,null,function*(){let s=r.get("dni")?.value,o=yield this.obtenerFirestore("profesional"),u=!1;o.forEach(l=>{l.data().dni==s&&(u=!0,eu(l.ref,{imagenes:i}))}),u||Za(ze(this.firestore,"profesional"),{nombre:r.get("nombre")?.value,apellido:r.get("apellido")?.value,edad:r.get("edad")?.value,dni:r.get("dni")?.value,especialidad:r.get("especialidad")?.value,email:r.get("email")?.value,password:r.get("password")?.value,imagenes:i,tipo:"profesional",autorizado:!1,fecha:new Date})})}agregarFirestoreAdministrador(r,i){return m(this,null,function*(){Za(ze(this.firestore,"administradores"),{nombre:r.get("nombre")?.value,apellido:r.get("apellido")?.value,edad:r.get("edad")?.value,dni:r.get("dni")?.value,email:r.get("email")?.value,password:r.get("password")?.value,imagenes:i,tipo:"administrador",fecha:new Date})})}obtenerFirestoreUsuario(r){return m(this,null,function*(){let i=Zr(ze(this.firestore,"profesional"),Zn("email","==",r)),s=Zr(ze(this.firestore,"profesional"),Zn("email","==",r),Zn("autorizado","==",!0)),o=yield pn(i);if(o.empty){if(!((yield this.obtenerFirestoreUsuarioPaciente(r)).length>0))return this.obtenerFirestoreUsuarioAdmin(r)}else return o.docs.map(u=>u.data());return o.docs.map(u=>u.data())})}obtenerFirestoreUsuarioPaciente(r){return m(this,null,function*(){let i=Zr(ze(this.firestore,"pacientes"),Zn("email","==",r)),s=yield pn(i);return s.empty?[]:s.docs.map(o=>o.data())})}obtenerFirestoreUsuarioAdmin(r){return m(this,null,function*(){let i=Zr(ze(this.firestore,"administradores"),Zn("email","==",r)),s=yield pn(i);return s.empty?[]:s.docs.map(o=>o.data())})}obtenerFirestore(r){return pn(ze(this.firestore,r))}obtenerFirestoreEspecialidades(r){return m(this,null,function*(){let i=Zr(ze(this.firestore,"especialidades"),Zn("especialidad","==",r));return(yield pn(i)).empty==!1})}autorizarProfesional(r){r.autorizado==!1?eu(Df(this.firestore,"profesional",r.id),{autorizado:!0}):eu(Df(this.firestore,"profesional",r.id),{autorizado:!1})}obtenerFirestoreTodosProfesional(){return Af(ze(this.firestore,"profesional"),{idField:"id"})}obtenerFirestoreTodosPacientes(){return Af(ze(this.firestore,"pacientes"),{idField:"id"})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var LO=(()=>{let e=class e{constructor(r){this.firestoreS=r,this.auth=L(Un),this.firestore=L(Bt)}logueado(){return this.auth.currentUser}crearUsuario(r,i,s,o){return m(this,null,function*(){return yield ah(this.auth,r,i).then(u=>{Cy(u.user),uh(u.user,{photoURL:s,displayName:o})})})}crearUsuarioAdmin(r,i,s,o){return m(this,null,function*(){return yield ah(this.auth,r,i).then(u=>m(this,null,function*(){uh(u.user,{photoURL:s,displayName:o})}))})}getUser(){return this.auth.currentUser}esAdmin(){return new Promise((r,i)=>{pn(ze(this.firestore,"users")).then(s=>{s.forEach(o=>{o.data().email==this.auth.currentUser?.email&&o.data().admin=="true"&&r(!0)})}).catch(s=>{console.error("Error fetching user data:",s),i(!1)})})}logueo(r,i){return m(this,null,function*(){let s=[];if(s=yield this.firestoreS.obtenerFirestoreUsuario(r),s[0].tipo=="profesional"&&s.length>0){let o=yield ia(this.auth,r,i),u=this.verificarEmailValidadoProfesional(o);return{autorizado:s[0].autorizado,tipo:s[0].tipo,validado:u}}else if(s[0].tipo=="paciente"&&s.length>0){let o=yield ia(this.auth,r,i);return this.verificarEmailValidado(o)}else{yield ia(this.auth,r,i);let o;return yield this.firestoreS.obtenerFirestoreUsuarioAdmin(r).then(u=>{u.forEach(l=>{o=l.tipo})}),{tipo:o}}})}verificarEmailValidadoProfesional(r){return r.user.emailVerified}verificarEmailValidado(r){return{validado:r.user.emailVerified,tipo:"paciente"}}signOut(){return this.auth.signOut()}};e.\u0275fac=function(i){return new(i||e)(Q(b_))},e.\u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();export{lr as a,CC as b,RC as c,PC as d,pw as e,zC as f,vR as g,PE as h,Qc as i,QR as j,YR as k,lm as l,hm as m,Ke as n,pe as o,et as p,nn as q,ns as r,rn as s,Ar as t,Ie as u,On as v,Lo as w,rs as x,br as y,Sr as z,Ae as A,Pt as B,Mn as C,LP as D,VP as E,Un as F,hs as G,NN as H,kN as I,Bt as J,DO as K,Af as L,Za as M,ze as N,bO as O,b_ as P,LO as Q};
