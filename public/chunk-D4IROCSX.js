import{a as he}from"./chunk-NIWE6QPI.js";import"./chunk-FK6H3RFT.js";import{a as pe}from"./chunk-J4ZRLQMQ.js";import{a as me}from"./chunk-E4UZH4GH.js";import{a as ge}from"./chunk-7VGHOT3T.js";import{a as K,c as Q,d as X,e as Y,f as I,g as Z,h as ee,j as te,k as ie,l as re,m as ne,n as ae,o as oe,p as le,q as se}from"./chunk-IDY3ZXSF.js";import{a as de}from"./chunk-4HPDBOIX.js";import{a as ce}from"./chunk-RBADOQRF.js";import{P as q,u as U}from"./chunk-IXUCQNA3.js";import{d as G,e as W,g as $,j as z,q as J}from"./chunk-YW5BT2SR.js";import{$ as j,Ab as V,Bb as H,Db as R,Ha as s,Hb as E,Ia as _,Ib as A,Jb as N,Wa as v,Ya as f,cb as e,da as D,db as t,eb as T,ga as L,ib as C,lb as w,mb as x,na as S,oa as b,vb as a,wb as g,xb as u,zb as P}from"./chunk-LTJRTMYM.js";import{a as B,b as k,e as xe,g as O}from"./chunk-5G567QLT.js";var y=xe(ge());var ue=(()=>{let d=class d{transform(n,r){if(!n||!r)return n;let o=[],m=r.toLowerCase();return n.forEach(h=>{(h.historial.altura.toString().toLowerCase().includes(m)||h.historial.peso.toString().toLowerCase().includes(m)||h.historial.presion.toString().toLowerCase().includes(m)||h.historial.temperatura.toString().toLowerCase().includes(m)||h.especialidad.toString().toLowerCase().includes(m))&&o.push(h)}),o.length===0?n:o}};d.\u0275fac=function(r){return new(r||d)},d.\u0275pipe=L({name:"buscarMiPefil",type:d,pure:!0,standalone:!0});let l=d;return l})();function Se(l,d){if(l&1&&(e(0,"option",17),a(1),t()),l&2){let i=d.$implicit;f("ngValue",i),s(),u(" ",i," ")}}function be(l,d){if(l&1&&(e(0,"option",17),a(1),t()),l&2){let i=d.$implicit;f("ngValue",i),s(),u(" ",i," ")}}function ve(l,d){if(l&1){let i=C();e(0,"div",4)(1,"h2",5),a(2),E(3,"titlecase"),t(),e(4,"div",6)(5,"form",7),w("ngSubmit",function(){S(i);let r=x();return b(r.submitForm())}),e(6,"div",8)(7,"h3"),a(8,"Elige dia y hora para todo el mes"),t(),e(9,"label",9),a(10,"Dia"),t(),e(11,"select",10),v(12,Se,2,2,"option",11),t(),e(13,"label",12),a(14,"Horario"),t(),T(15,"input",13),e(16,"label",14),a(17,"Especialidades"),t(),e(18,"select",15),v(19,be,2,2,"option",11),t(),e(20,"button",16),w("click",function(){S(i);let r=x();return b(r.agregarFecha())}),a(21," Agregar horario "),t()()()()()}if(l&2){let i=x();s(2),u(" Bienvenido/a ",A(3,4,i.nombre),"! "),s(3),f("formGroup",i.formRegistro),s(7),f("ngForOf",i.dias),s(7),f("ngForOf",i.especialidades)}}function Ce(l,d){if(l&1&&(e(0,"tbody")(1,"tr")(2,"th",23),a(3),t(),e(4,"td"),a(5),t(),e(6,"td"),a(7),t(),e(8,"td"),a(9),t(),e(10,"td"),a(11),t(),e(12,"td"),a(13),t(),e(14,"td"),a(15),t()()()),l&2){let i=d.$implicit,n=d.index;s(3),g(n+1),s(2),g(i.paciente),s(2),u("",i.historial.altura," cms"),s(2),u("",i.historial.peso," kgs"),s(2),u("",i.historial.presion," mmHg"),s(2),u("",i.historial.temperatura," \xB0C"),s(2),g(i.historial.caries.caries)}}function Ee(l,d){if(l&1){let i=C();e(0,"table",18)(1,"thead")(2,"tr")(3,"th",19)(4,"div",20)(5,"input",21),H("ngModelChange",function(r){S(i);let o=x();return V(o.searchAll,r)||(o.searchAll=r),b(r)}),t()()(),e(6,"th",19),a(7,"Paciente"),t(),e(8,"th",19),a(9,"Altura"),t(),e(10,"th",19),a(11,"Peso"),t(),e(12,"th",19),a(13,"Presion"),t(),e(14,"th",19),a(15,"Temperatura"),t(),e(16,"th",19),a(17,"Caries"),t()()(),v(18,Ce,16,7,"tbody",22),E(19,"buscarMiPefil"),t()}if(l&2){let i=x();s(5),P("ngModel",i.searchAll),s(13),f("ngForOf",N(19,2,i.arrHistorial,i.searchAll))}}function ye(l,d){if(l&1&&(e(0,"div",4)(1,"h2",5),a(2),E(3,"titlecase"),t()()),l&2){let i=x();s(2),u(" Bienvenido/a ",A(3,1,i.nombre),"! ")}}function we(l,d){if(l&1){let i=C();e(0,"tbody")(1,"tr")(2,"th",23),a(3),t(),e(4,"td"),a(5),t(),e(6,"td"),a(7),t(),e(8,"td"),a(9),t(),e(10,"td"),a(11),t(),e(12,"td"),a(13),t(),e(14,"td"),a(15),t(),e(16,"td"),a(17),t(),e(18,"td")(19,"button",24),w("click",function(){let r=S(i).$implicit,o=x(2);return b(o.descargarHistorial(r))}),a(20," Descargar "),t()()()()}if(l&2){let i=d.$implicit,n=d.index;s(3),g(n+1),s(2),g(i.medico),s(2),g(i.especialidad),s(2),u("",i.historial.altura," cms"),s(2),u("",i.historial.peso," kgs"),s(2),u("",i.historial.presion," mmHg"),s(2),u("",i.historial.temperatura," \xB0C"),s(2),g(i.historial.caries.caries)}}function Ie(l,d){if(l&1){let i=C();e(0,"table",18)(1,"thead")(2,"tr")(3,"th",19)(4,"div",20)(5,"input",21),H("ngModelChange",function(r){S(i);let o=x();return V(o.searchAll,r)||(o.searchAll=r),b(r)}),t()()(),e(6,"th",19),a(7,"Medico"),t(),e(8,"th",19),a(9,"Especialidad"),t(),e(10,"th",19),a(11,"Altura"),t(),e(12,"th",19),a(13,"Peso"),t(),e(14,"th",19),a(15,"Presion"),t(),e(16,"th",19),a(17,"Temperatura"),t(),e(18,"th",19),a(19,"Caries"),t(),e(20,"th",19),a(21,"Historial"),t()()(),v(22,we,21,8,"tbody",22),E(23,"buscarMiPefil"),t()}if(l&2){let i=x();s(5),P("ngModel",i.searchAll),s(17),f("ngForOf",N(23,2,i.arrHistorial,i.searchAll))}}var We=(()=>{let d=class d{constructor(n,r,o,m,h,M){this.route=n,this.firestoreS=r,this.formBuilder=o,this.especilistaS=m,this.authS=h,this.pacienteS=M,this.auth=j(U),this.dias=["Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],this.arrHistorial=[],this.searchAll="",this.arrTurnosMedico=[],this.tipo="",this.email="",this.nombre="",this.tieneData=!0,this.especialidades=[],this.formRegistro=new Y({dias:new I(""),horario:new I(""),especialidades:new I("")})}ngOnDestroy(){}ngOnInit(){this.authS.user$.subscribe(n=>{this.tipo=n.tipo,this.email=n.email,this.nombre=n.nombre}),this.route.params.subscribe(n=>{console.log(n.usuarios),this.tipo==="profesional"?this.firestoreS.obtenerFirestoreUsuario(n.usuarios).then(r=>{this.user=r[0],this.perfil=this.user.tipo,this.especialidades=this.user.especialidad}).then(()=>{this.user.tipo==="profesional"&&this.especilistaS.obtenerEspecialista(this.user.email).subscribe(r=>{this.id=r[0].id,this.especilistaS.obtenerHistorialClinico(r[0].id).subscribe(o=>{this.arrHistorial=[],o.forEach(m=>{this.arrHistorial.push(m)})})})}):this.tipo==="paciente"&&this.pacienteS.obtenerHistorialClinico(this.email).subscribe(r=>{this.arrHistorial=[],r.forEach(o=>{this.especilistaS.obtenerTurnoPorId(o.idTurno).then(m=>{this.arrHistorial.push(k(B({},o),{especialidad:m.data()?.especialidad,medico:m.data()?.medico}))})})})})}agregarFecha(){let n=this.formRegistro.get("dias")?.value,r=this.formRegistro.get("horario")?.value,o=this.formRegistro.get("especialidades")?.value,m=Number(r.split(":")[0]);if(r!=null&&m>8&&m<18){if(n==="Sabado"&&m>14){y.default.fire("Horario incorrecto","El horario debe ser entre las 8 y las 13","error");return}n&&r&&o&&(this.firestoreS.actualizarHorasEspecialista(n,r.split(":")[0],r.split(":")[1],o,this.id).then(()=>{y.default.fire({icon:"success",title:"Se agrego el horario mensual correctamente",showConfirmButton:!1,timer:1500})}),this.formRegistro.reset())}else{y.default.fire("Horario incorrecto","Fijarse los datos ingresados como el horario y el dia seleccionado","error");return}}descargarHistorial(n){let r="",o="",m="";this.especilistaS.obtenerMedicoPorId(n.medico).then(h=>{r=h.data()?.nombre+" "+h.data()?.apellido,o=h.data()?.email,m=h.data()?.especialidad;let M=n.historial.caries.caries?n.historial.caries.caries:"no tiene";this.especilistaS.obtenerTurnoPorId(n.idTurno).then(fe=>{let F=fe.data(),p=new he,c=10;p.addImage("/assets/logo.png","PNG",10,c,20,20),c+=30,p.text("Fecha de emision: "+new Date().toLocaleTimeString(),10,c),c+=10,p.text("Historial Clinico de "+n.paciente,10,c),p.setFont("bold"),p.setFont("normal"),c+=10,p.text("idTurno: "+n.idTurno,10,c),c+=10,p.text("Especialista: "+r,10,c),c+=10,p.text("Especialista email: "+o,10,c),c+=10,p.text("Especialidad: "+F?.especialidad,10,c),c+=10,p.text("Comentario: "+F?.comentario,10,c),c+=10,p.text("Diagnostico: "+F?.diagnostico,10,c),c+=10,p.text("Paciente: "+n.paciente,10,c),c+=10,p.text("Altura: "+n.historial.altura+" cms",10,c),c+=10,p.text("Peso: "+n.historial.peso+" kgs",10,c),c+=10,p.text("Presion: "+n.historial.presion+" mmHg",10,c),c+=10,p.text("Temperatura: "+n.historial.temperatura+" \xB0C",10,c),c+=10,p.text("Caries: "+M,10,c),p.save(`historial_${new Date().toLocaleTimeString()}.pdf`)})}),y.default.fire({icon:"success",title:"Se descargo el historial correctamente",showConfirmButton:!1,timer:1500})}submitForm(){return O(this,null,function*(){console.log(this.arrTurnosMedico)})}};d.\u0275fac=function(r){return new(r||d)(_(J),_(q),_(oe),_(pe),_(ce),_(me))},d.\u0275cmp=D({type:d,selectors:[["app-miperfil"]],standalone:!0,features:[R],decls:7,vars:4,consts:[[1,"full-background"],[1,"container-fluid","d-flex","justify-content-start","align-items-start"],["style","width: 30rem","class","card p-4 shadow mt-3",4,"ngIf"],["class","table mt-3 ms-3","style","width: 770px",4,"ngIf"],[1,"card","p-4","shadow","mt-3",2,"width","30rem"],[1,"text-center","mb-4","mt-1"],[1,"d-flex","flex-column","justify-content-center","align-items-center"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","dia"],["name","dias","id","dias","formControlName","dias",1,"form-select"],[3,"ngValue",4,"ngFor","ngForOf"],["for","fecha"],["type","time","id","horario","min","08:00","max","18:00","formControlName","horario",1,"form-control"],["for","horario",1,"form-label"],["id","especialidades","formControlName","especialidades",1,"form-select"],["type","button",1,"btn","btn-primary","mt-2",3,"click"],[3,"ngValue"],[1,"table","mt-3","ms-3",2,"width","770px"],["scope","col"],[1,"mt-1","mb-1"],["type","text","placeholder","Buscar",1,"form-control",3,"ngModelChange","ngModel"],[4,"ngFor","ngForOf"],["scope","row"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(r,o){r&1&&(e(0,"div",0),T(1,"app-navbar"),e(2,"div",1),v(3,ve,22,6,"div",2)(4,Ee,20,5,"table",3)(5,ye,4,3,"div",2)(6,Ie,24,5,"table",3),t()()),r&2&&(s(3),f("ngIf",o.perfil==="profesional"),s(),f("ngIf",o.perfil==="profesional"),s(),f("ngIf",o.tipo==="paciente"),s(),f("ngIf",o.tipo==="paciente"))},dependencies:[z,G,W,$,se,ee,ne,ae,K,re,Q,X,te,ie,de,le,Z,ue],styles:["[_nghost-%COMP%]{display:block;background-image:url(/assets/pattern.jpg)}.full-background[_ngcontent-%COMP%]{width:100vw;height:100vh}"]});let l=d;return l})();export{We as MiperfilComponent};
