import{F as f,I as d,K as m,L as s,M as p,N as g,R as E,S as v,U}from"./chunk-ORWQQMWF.js";import{Y as c,ba as l,ca as h,f as u}from"./chunk-WIFXGSG2.js";var A=(()=>{let a=class a{constructor(t){this.firestoreS=t,this.auth=h(f),this.firestore=h(g)}logueado(){return this.auth.currentUser}crearUsuario(t,e,r,i){return u(this,null,function*(){return yield d(this.auth,t,e).then(o=>{m(o.user),p(o.user,{photoURL:r,displayName:i})})})}getUser(){return this.auth.currentUser}esAdmin(){return new Promise((t,e)=>{v(E(this.firestore,"users")).then(r=>{r.forEach(i=>{i.data().email==this.auth.currentUser?.email&&i.data().admin=="true"&&t(!0)})}).catch(r=>{console.error("Error fetching user data:",r),e(!1)})})}logueo(t,e){return u(this,null,function*(){let r=[];if(r=yield this.firestoreS.obtenerFirestoreUsuario(t),r[0].tipo=="profesional"&&r.length>0){let i=yield s(this.auth,t,e),o=this.verificarEmailValidadoProfesional(i);return{autorizado:r[0].autorizado,tipo:r[0].tipo,validado:o}}else if(r[0].tipo=="paciente"&&r.length>0){let i=yield s(this.auth,t,e);return this.verificarEmailValidado(i)}else{yield s(this.auth,t,e);let i;return yield this.firestoreS.obtenerFirestoreUsuarioAdmin(t).then(o=>{o.forEach(w=>{i=w.tipo})}),{tipo:i}}})}verificarEmailValidadoProfesional(t){return t.user.emailVerified}verificarEmailValidado(t){return{validado:t.user.emailVerified,tipo:"paciente"}}signOut(){return this.auth.signOut()}};a.\u0275fac=function(e){return new(e||a)(l(U))},a.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"});let n=a;return n})();export{A as a};
